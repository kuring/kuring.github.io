<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="\nä¸€ä¸ªæ­£å¸¸çš„tcp serveråœ¨å¤„ç†è¯·æ±‚æ—¶ä¼šç»è¿‡å¦‚ä¸‹çš„ç³»ç»Ÿè°ƒç”¨ï¼šsocket() bind() listen() accept() read() write() close()ã€‚ä¸€ä¸ªè¯·æ±‚åœ¨è¢«åº”ç”¨ç¨‹åºè¯»å–ä¹‹å‰ï¼Œå¯èƒ½å¤„äºSYN_RCVDå’ŒESTABLISHEDä¸¤ç§çŠ¶æ€ã€‚\n"><title>Linux TCP backlog</title><link rel=canonical href=https://kuring.me/post/linux-backlog/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="Linux TCP backlog"><meta property='og:description' content="\nä¸€ä¸ªæ­£å¸¸çš„tcp serveråœ¨å¤„ç†è¯·æ±‚æ—¶ä¼šç»è¿‡å¦‚ä¸‹çš„ç³»ç»Ÿè°ƒç”¨ï¼šsocket() bind() listen() accept() read() write() close()ã€‚ä¸€ä¸ªè¯·æ±‚åœ¨è¢«åº”ç”¨ç¨‹åºè¯»å–ä¹‹å‰ï¼Œå¯èƒ½å¤„äºSYN_RCVDå’ŒESTABLISHEDä¸¤ç§çŠ¶æ€ã€‚\n"><meta property='og:url' content='https://kuring.me/post/linux-backlog/'><meta property='og:site_name' content='404é¢‘é“'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2018-12-01T21:24:07+00:00'><meta property='article:modified_time' content='2018-12-01T21:24:07+00:00'><meta name=twitter:title content="Linux TCP backlog"><meta name=twitter:description content="\nä¸€ä¸ªæ­£å¸¸çš„tcp serveråœ¨å¤„ç†è¯·æ±‚æ—¶ä¼šç»è¿‡å¦‚ä¸‹çš„ç³»ç»Ÿè°ƒç”¨ï¼šsocket() bind() listen() accept() read() write() close()ã€‚ä¸€ä¸ªè¯·æ±‚åœ¨è¢«åº”ç”¨ç¨‹åºè¯»å–ä¹‹å‰ï¼Œå¯èƒ½å¤„äºSYN_RCVDå’ŒESTABLISHEDä¸¤ç§çŠ¶æ€ã€‚\n"><link rel="shortcut icon" href=/images/avatar.jpeg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_16fb6c03614f4da2.jpeg width=300 height=280 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ“¡</span></figure><div class=site-meta><h1 class=site-name><a href=/>404é¢‘é“</a></h1><h2 class=site-description>å­¦ä¹ ç¬”è®°</h2></div></header><ol class=menu-social><li><a href=https://github.com/kuring target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äºæˆ‘</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/post/linux-backlog/>Linux TCP backlog</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2018-12-01T21:24:07Z>2018-12-01</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 3 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p><img src=https://kuring.oss-cn-beijing.aliyuncs.com/common/tcp_connect.webp loading=lazy></p><p>ä¸€ä¸ªæ­£å¸¸çš„tcp serveråœ¨å¤„ç†è¯·æ±‚æ—¶ä¼šç»è¿‡å¦‚ä¸‹çš„ç³»ç»Ÿè°ƒç”¨ï¼šsocket() bind() listen() accept() read() write() close()ã€‚ä¸€ä¸ªè¯·æ±‚åœ¨è¢«åº”ç”¨ç¨‹åºè¯»å–ä¹‹å‰ï¼Œå¯èƒ½å¤„äºSYN_RCVDå’ŒESTABLISHEDä¸¤ç§çŠ¶æ€ã€‚</p><p>ç¬¬ä¸€ä¸ªé˜Ÿåˆ—ï¼šSYN_RCVDçŠ¶æ€æ˜¯serverç«¯æ¥æ”¶åˆ°äº†clientç«¯çš„SYNåŒ…ï¼Œserverç«¯ä¼šå°†è¯¥è¿æ¥æ”¾åˆ°åŠè¿æ¥é˜Ÿåˆ—ä¸­ï¼Œå¹¶å‘å®¢æˆ·ç«¯å‘é€SYN+ACKåŒ…ï¼Œæ­¤æ—¶è¿æ¥å¤„äºåŠè¿æ¥çŠ¶æ€ã€‚é€šå¸¸è¯¥é˜Ÿåˆ—è¢«ç§°ä¸ºåŠè¿æ¥é˜Ÿåˆ—ã€‚</p><p>ç¬¬äºŒä¸ªé˜Ÿåˆ—ï¼šESTABLISHEDçŠ¶æ€ä¸ºå·²ç»å®Œæˆäº†ä¸‰æ¬¡æ¡æ‰‹ï¼Œä½†æ˜¯serverç«¯çš„åº”ç”¨ç¨‹åºè¿˜æœªè°ƒç”¨acceptç³»ç»Ÿè°ƒç”¨çš„æƒ…å†µã€‚é€šå¸¸è¯¥é˜Ÿåˆ—è¢«ç§°ä¸ºå…¨è¿æ¥é˜Ÿåˆ—ã€‚</p><p>è¿™ä¸¤ç§æƒ…å†µä¸‹éƒ½éœ€è¦æ“ä½œç³»ç»Ÿæä¾›ç›¸åº”é˜Ÿåˆ—æ¥ä¿å­˜è¿æ¥çŠ¶æ€ã€‚</p><p>backlogç”¨æ¥è®¾ç½®è¿™ä¸¤ä¸ªé˜Ÿåˆ—çš„æœ€å¤§å€¼ï¼Œä½†åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸­æœ‰ä¸åŒçš„å«ä¹‰ï¼Œä¸‹é¢çš„è¯´æ˜ä»¥linuxæ“ä½œç³»ç»Ÿä¸ºå‡†ã€‚</p><p>å…¶ä¸­ç¬¬ä¸€ä¸ªç»´æŠ¤SYN_RCVDçŠ¶æ€çš„é˜Ÿåˆ—ä½¿ç”¨å†…æ ¸å‚æ•°<code>net.ipv4.tcp_max_syn_backlog</code>æ¥æ§åˆ¶ï¼Œå¦‚æœé˜Ÿåˆ—è¶…è¿‡è¿™ä¸€é˜ˆå€¼ï¼Œè¿æ¥ä¼šè¢«æ‹’ç»ã€‚è¯¥å€¼é»˜è®¤ä¸º1000.</p><p>ç¬¬äºŒä¸ªç»´æŠ¤ESTABLISHEDçŠ¶æ€çš„é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—çš„é•¿åº¦ç”±åº”ç”¨ç¨‹åºè°ƒç”¨listenç³»ç»Ÿè°ƒç”¨æ—¶æŒ‡å®šã€‚</p><h1 id=å†…æ ¸å‚æ•°>å†…æ ¸å‚æ•°</h1><ol><li>net.ipv4.tcp_max_syn_backlog</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>tcp_max_syn_backlog (integer; default: see below; since Linux 2.2)
</span></span><span class=line><span class=cl>              The  maximum number of queued connection requests which have still not received an acknowledgement from the connecting client.  If this number is exceeded, the kernel will begin dropping requests.  The default value of 256 is increased to 1024 when the memory present in the system is adequate or greater (&gt;= 128Mb), and  reduced  to 128  for  those systems with very low memory (&lt;= 32Mb).  It is recommended that if this needs to be increased above 1024, TCP_SYNQ_HSIZE in include/net/tcp.h be modified to keep TCP_SYNQ_HSIZE*16&lt;=tcp_max_syn_backlog, and the kernel be recompiled.
</span></span></code></pre></td></tr></table></div></div><p>ç”¨æ¥è®¾ç½® syn é˜Ÿåˆ—çš„å¤§å°ï¼Œé€šå¸¸ä¹Ÿä¼šç§°ä¸ºåŠè¿æ¥é˜Ÿåˆ—ã€‚è¯¥å‚æ•°çš„é»˜è®¤å€¼ä¸€èˆ¬ä¸º 1024ã€‚å¦‚æœ syn é˜Ÿåˆ—æ»¡ï¼Œæ­¤æ—¶ syn æŠ¥æ–‡ä¼šè¢«ä¸¢å¼ƒï¼Œæ— æ³•å›å¤ syn + ack æŠ¥æ–‡ã€‚å¯ä»¥é€šè¿‡ <code>netstat -s</code> å‘½ä»¤çœ‹åˆ° &ldquo;XX SYNs to LISTEN sockets dropped&rdquo;. çš„æŠ¥é”™ä¿¡æ¯ã€‚</p><ol start=2><li>net.ipv4.tcp_syncookies</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>tcp_syncookies</span> <span class=p>(</span><span class=n>Boolean</span><span class=p>;</span> <span class=n>since</span> <span class=n>Linux</span> <span class=mf>2.2</span><span class=p>)</span> <span class=n>Enable</span> <span class=n>TCP</span> <span class=n>syncookies</span><span class=o>.</span> <span class=n>The</span> <span class=n>kernel</span> <span class=n>must</span> <span class=n>be</span> <span class=n>compiled</span> <span class=n>with</span> <span class=n>CONFIG_SYN_COOKIES</span><span class=o>.</span>  <span class=n>Send</span> <span class=n>out</span> <span class=n>syncookies</span> <span class=n>when</span> <span class=n>the</span> <span class=n>syn</span> <span class=n>backlog</span> <span class=n>queue</span> <span class=n>of</span> <span class=n>a</span> <span class=n>socket</span> <span class=n>overflows</span><span class=o>.</span>  <span class=n>The</span> <span class=n>syncookies</span> <span class=n>feature</span> <span class=n>attempts</span> <span class=n>to</span> <span class=n>protect</span> <span class=n>a</span> <span class=n>socket</span> <span class=n>from</span> <span class=n>a</span> <span class=n>SYN</span> <span class=n>flood</span> <span class=n>attack</span><span class=o>.</span>  <span class=n>This</span> <span class=n>should</span> <span class=n>be</span> <span class=n>used</span> <span class=n>as</span> <span class=n>a</span> <span class=n>last</span> <span class=n>resort</span><span class=p>,</span> <span class=k>if</span> <span class=n>at</span> <span class=n>all</span><span class=o>.</span>  <span class=n>This</span> <span class=n>is</span> <span class=n>a</span> <span class=n>violation</span> <span class=n>of</span> <span class=n>the</span>  <span class=n>TCP</span>  <span class=n>protocol</span><span class=p>,</span>  <span class=ow>and</span>  <span class=n>con</span><span class=err>â€</span> <span class=n>flicts</span>  <span class=n>with</span> <span class=n>other</span> <span class=n>areas</span> <span class=n>of</span> <span class=n>TCP</span> <span class=n>such</span> <span class=n>as</span> <span class=n>TCP</span> <span class=n>extensions</span><span class=o>.</span>  <span class=n>It</span> <span class=n>can</span> <span class=n>cause</span> <span class=n>problems</span> <span class=k>for</span> <span class=n>clients</span> <span class=ow>and</span> <span class=n>relays</span><span class=o>.</span>  <span class=n>It</span> <span class=n>is</span> <span class=ow>not</span> <span class=n>recommended</span> <span class=n>as</span> <span class=n>a</span> <span class=n>tuning</span> <span class=n>mechanism</span> <span class=k>for</span> <span class=n>heavily</span> <span class=n>loaded</span> <span class=n>servers</span> <span class=n>to</span> <span class=n>help</span> <span class=n>with</span> <span class=n>overloaded</span> <span class=ow>or</span> <span class=n>misconfigured</span> <span class=n>conditions</span><span class=o>.</span>  <span class=n>For</span> <span class=n>recommended</span> <span class=n>alternatives</span> <span class=n>see</span> <span class=n>tcp_max_syn_backlog</span><span class=p>,</span> <span class=n>tcp_synack_retries</span><span class=p>,</span> <span class=ow>and</span> <span class=n>tcp_abort_on_overflow</span><span class=o>.</span>
</span></span></code></pre></td></tr></table></div></div><p>å› ä¸º syn é˜Ÿåˆ—çš„å­˜åœ¨ï¼Œå½“å®¢æˆ·ç«¯ä¸€ç›´åœ¨å‘é€ syn åŒ…ï¼Œä½†æ˜¯ä¸å› ack æŠ¥æ–‡æ—¶ï¼Œä¸€æ—¦æœåŠ¡ç«¯çš„é˜Ÿåˆ—è¶…è¿‡ <code>net.ipv4.tcp_max_syn_backlog</code> è®¾ç½®çš„å¤§å°å°±ä¼šå­˜åœ¨é˜Ÿåˆ—æº¢å‡ºçš„é—®é¢˜ï¼Œä»è€Œå¯¼è‡´æœåŠ¡ç«¯æ— æ³•å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œè¿™å°±æ˜¯ syn flood æ”»å‡»ã€‚</p><p>ä¸ºäº†é˜²æ­¢ syn flood æ”»å‡»ï¼Œå¼•å…¥äº† syn cookies æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å¹¶é tcp åè®®çš„ä¸€éƒ¨åˆ†ã€‚åŸç†å‚è§ï¼š<a class=link href=https://segmentfault.com/a/1190000019292140 target=_blank rel=noopener>æ·±å…¥æµ…å‡ºTCPä¸­çš„SYN-Cookies</a></p><p>ä¸€æ—¦å¼€å¯äº† syn cookies æœºåˆ¶åï¼Œå³ä½¿ syn é˜Ÿåˆ—æ»¡ï¼Œä»å¯ä»¥å¯¹æ–°å»ºçš„è¿æ¥å›å¤ syn + ack æŠ¥æ–‡ï¼Œä½†æ˜¯ä¸éœ€è¦è¿›å…¥é˜Ÿåˆ—ã€‚</p><p>å› ä¸º syn cookies å­˜åœ¨éƒ¨åˆ†ç¼ºé™·ï¼Œåªæœ‰å½“ syn é˜Ÿåˆ—æ»¡æ—¶è¯¥ç‰¹æ€§æ‰ä¼šç”Ÿæ•ˆã€‚</p><ol start=3><li>net.ipv4.tcp_abort_on_overflow</li></ol><p>åœ¨ä¸‰æ¬¡æ¡æ‰‹å®Œæˆåï¼Œè¯¥è¿æ¥ä¼šè¿›å…¥åˆ° ESTABLISHED çŠ¶æ€ï¼Œå¹¶å°†è¯¥è¿æ¥æ”¾å…¥åˆ°ç”¨æˆ·ç¨‹åºé˜Ÿåˆ—ä¸­ã€‚è‹¥è¯¥é˜Ÿåˆ—å·²æ»¡ï¼Œé»˜è®¤ä¼šå°†è¯¥è¿æ¥é‡æ–°è®¾ç½®ä¸º SYN_ACK çŠ¶æ€ï¼Œç›¸å½“äºæ˜¯æœåŠ¡ç«¯æ²¡æœ‰æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ syn + ack æŠ¥æ–‡ï¼Œåç»­å¯ä»¥åˆ©ç”¨å®¢æˆ·ç«¯çš„é‡ä¼ æœºåˆ¶é‡æ–°æ¥æ”¶æŠ¥æ–‡ã€‚</p><p>ä¸€æ—¦å¼€å¯äº† <code>net.ipv4.tcp_abort_on_overflow</code> é€‰é¡¹åï¼Œä¼šç›´æ¥å‘é€ RST æŠ¥æ–‡ç»™åˆ°å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¼šç»ˆæ­¢è¯¥è¿æ¥ï¼Œå¹¶æŠ¥é”™ <code>104 Connection reset by peer</code>ã€‚</p><ol start=4><li>net.core.somaxconn</li></ol><p>å…¨è¿æ¥é˜Ÿåˆ—çš„æœ€å¤§å€¼ï¼Œè¯¥é…ç½®ä¸ºå…¨å±€é»˜è®¤é…ç½®ã€‚å•ä¸ª socket çš„å…¨è¿æ¥é˜Ÿåˆ—çš„é•¿åº¦é€‰æ‹©ä¸º Min(backlog, somaxconn)ã€‚</p><h1 id=å†…æ ¸æºç >å†…æ ¸æºç </h1><p>åœ¨æ•´ä¸ªå†…æ ¸æ¨¡å—ä¸­ä¸»è¦æ¶‰åŠåˆ° listen() å’Œ accept() ç³»ç»Ÿè°ƒç”¨ï¼Œlisten() ç³»ç»Ÿè°ƒç”¨çš„ä½œç”¨æ˜¯ç”³è¯·å’Œåˆå§‹åŒ–åŠè¿æ¥é˜Ÿåˆ—å’Œå…¨è¿æ¥é˜Ÿåˆ—ã€‚é˜Ÿåˆ—ä½äºå†…æ ¸ä»£ç çš„ include/net/inet_connection_sock.h ä¸­çš„å¦‚ä¸‹ä½ç½®:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>struct</span> <span class=n>inet_connection_sock</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=cm>/* inet_sock has to be the first member! */</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>inet_sock</span>	  <span class=n>icsk_inet</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>request_sock_queue</span> <span class=n>icsk_accept_queue</span><span class=p>;</span> <span class=c1>// é˜Ÿåˆ—
</span></span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>inet_bind_bucket</span>	  <span class=o>*</span><span class=n>icsk_bind_hash</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=å¦‚ä½•å‚çœ‹>å¦‚ä½•å‚çœ‹</h1><p>æŸ¥çœ‹ tcp çŠ¶æ€ä¸º SYN_RECV çš„é“¾æ¥å³ä¸ºåŠè¿æ¥çŠ¶æ€çš„è¯·æ±‚ï¼š<code>netstat -napt | grep SYN_RECV</code>ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ <code>netstat -s | grep 'SYNs to LISTEN'</code> æŸ¥çœ‹ã€‚</p><p>å…¨è¿æ¥é˜Ÿåˆ—å¯ä»¥ä½¿ç”¨ <code>ss -nlt | grep 8080</code> çš„æ–¹å¼æŸ¥çœ‹ Recv-Q çš„å€¼ã€‚
ä¹Ÿå¯é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹å…¨è¿æ¥é˜Ÿåˆ—çš„æº¢å‡ºæƒ…å†µã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>$netstat</span> -s <span class=p>|</span> grep overflow
</span></span><span class=line><span class=cl>    <span class=m>3255</span> <span class=nb>times</span> the listen queue of a socket overflowed
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer></footer></article><script src=https://giscus.app/client.js data-repo=kuring/kuring.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkyODM4MzQ0NTk=" data-category=Announcements data-category-id=DIC_kwDOEOr4W84CdeTU data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=light data-lang=zh-CN data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2013 -
2025 kuring</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>