<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="ç®€ä»‹ è…¾è®¯äº‘å¼€æºçš„k8så¤šé›†ç¾¤ç®¡ç†æ–¹æ¡ˆï¼Œå¯å‘å¸ƒåº”ç”¨åˆ°å¤šä¸ªk8sé›†ç¾¤ã€‚ https://github.com/clusternet/clusternet GitHub Starï¼š891\næ¶æ„ åŒ…å«clusternet-hubå’Œclusternet-agentä¸¤ä¸ªç»„ä»¶ã€‚\n"><title>k8så¤šé›†ç¾¤ç®¡ç†æ–¹æ¡ˆ - clusternet</title><link rel=canonical href=/post/k8s%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E6%96%B9%E6%A1%88-clusternet/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="k8så¤šé›†ç¾¤ç®¡ç†æ–¹æ¡ˆ - clusternet"><meta property='og:description' content="ç®€ä»‹ è…¾è®¯äº‘å¼€æºçš„k8så¤šé›†ç¾¤ç®¡ç†æ–¹æ¡ˆï¼Œå¯å‘å¸ƒåº”ç”¨åˆ°å¤šä¸ªk8sé›†ç¾¤ã€‚ https://github.com/clusternet/clusternet GitHub Starï¼š891\næ¶æ„ åŒ…å«clusternet-hubå’Œclusternet-agentä¸¤ä¸ªç»„ä»¶ã€‚\n"><meta property='og:url' content='/post/k8s%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E6%96%B9%E6%A1%88-clusternet/'><meta property='og:site_name' content='404é¢‘é“'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='å¤šé›†ç¾¤'><meta property='article:published_time' content='2021-12-26T21:44:17+00:00'><meta property='article:modified_time' content='2021-12-26T21:44:17+00:00'><meta name=twitter:title content="k8så¤šé›†ç¾¤ç®¡ç†æ–¹æ¡ˆ - clusternet"><meta name=twitter:description content="ç®€ä»‹ è…¾è®¯äº‘å¼€æºçš„k8så¤šé›†ç¾¤ç®¡ç†æ–¹æ¡ˆï¼Œå¯å‘å¸ƒåº”ç”¨åˆ°å¤šä¸ªk8sé›†ç¾¤ã€‚ https://github.com/clusternet/clusternet GitHub Starï¼š891\næ¶æ„ åŒ…å«clusternet-hubå’Œclusternet-agentä¸¤ä¸ªç»„ä»¶ã€‚\n"><link rel="shortcut icon" href=/images/avatar.jpeg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_16fb6c03614f4da2.jpeg width=300 height=280 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ“¡</span></figure><div class=site-meta><h1 class=site-name><a href=/>404é¢‘é“</a></h1><h2 class=site-description>å­¦ä¹ ç¬”è®°</h2></div></header><ol class=menu-social><li><a href=https://github.com/kuring target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äºæˆ‘</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#clusterregistrationrequest>ClusterRegistrationRequest</a></li><li><a href=#clusterroleå’Œrole>ClusterRoleå’ŒRole</a></li><li><a href=#managedcluster>ManagedCluster</a></li><li><a href=#subscription>Subscription</a></li><li><a href=#helmchart>HelmChart</a></li><li><a href=#localization>Localization</a></li><li><a href=#globalization>Globalization</a></li><li><a href=#base>Base</a></li><li><a href=#description>Description</a></li></ol><ol><li><a href=#kubectl-clusternetå‘½ä»¤è¡Œæ–¹å¼è®¿é—®>kubectl-clusternetå‘½ä»¤è¡Œæ–¹å¼è®¿é—®</a></li><li><a href=#ä»£ç å±‚é¢è®¿é—®å­é›†ç¾¤>ä»£ç å±‚é¢è®¿é—®å­é›†ç¾¤</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/post/k8s%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E6%96%B9%E6%A1%88-clusternet/>k8så¤šé›†ç¾¤ç®¡ç†æ–¹æ¡ˆ - clusternet</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2021-12-26T21:44:17Z>2021-12-26</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 5 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h1 id=ç®€ä»‹>ç®€ä»‹</h1><p>è…¾è®¯äº‘å¼€æºçš„k8så¤šé›†ç¾¤ç®¡ç†æ–¹æ¡ˆï¼Œå¯å‘å¸ƒåº”ç”¨åˆ°å¤šä¸ªk8sé›†ç¾¤ã€‚
<a class=link href=https://github.com/clusternet/clusternet target=_blank rel=noopener>https://github.com/clusternet/clusternet</a>
GitHub Starï¼š891</p><h1 id=æ¶æ„>æ¶æ„</h1><p><img src=https://kuring.oss-cn-beijing.aliyuncs.com/images/clusternet1.png loading=lazy alt=image.png>
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/images/clusternet2.png loading=lazy alt=image.png>
åŒ…å«clusternet-hubå’Œclusternet-agentä¸¤ä¸ªç»„ä»¶ã€‚</p><p>clusternet-hubéƒ¨ç½²åœ¨çˆ¶é›†ç¾¤ï¼Œç”¨é€”ï¼š</p><ul><li>æ¥æ”¶å­é›†ç¾¤çš„æ³¨å†Œè¯·æ±‚ï¼Œå¹¶ä¸ºæ¯ä¸ªè‡ªå·±ç¾¤åˆ›å»ºnamespaceã€serviceaccountç­‰èµ„æº</li><li>æä¾›çˆ¶é›†ç¾¤è·Ÿå„ä¸ªå­é›†ç¾¤çš„é•¿è¿æ¥</li><li>æä¾›restful apiæ¥è®¿é—®å„ä¸ªå­é›†ç¾¤ï¼ŒåŒæ—¶æ”¯æŒå­é›†ç¾¤çš„äº’è®¿</li></ul><p>clusternet-agentéƒ¨ç½²åœ¨å­é›†ç¾¤ï¼Œç”¨é€”ï¼š</p><ul><li>è‡ªåŠ¨æ³¨å†Œå­é›†ç¾¤åˆ°çˆ¶é›†ç¾¤</li><li>å¿ƒè·³æŠ¥å‘Šåˆ°ä¸­å¿ƒé›†ç¾¤ï¼ŒåŒ…æ‹¬k8sç‰ˆæœ¬ã€è¿è¡Œå¹³å°ã€å¥åº·çŠ¶æ€ç­‰</li><li>é€šè¿‡websocketåè®®è·Ÿçˆ¶é›†ç¾¤é€šè®¯</li></ul><h1 id=crdæŠ½è±¡>CRDæŠ½è±¡</h1><h2 id=clusterregistrationrequest>ClusterRegistrationRequest</h2><p>clusternet-agentåœ¨çˆ¶é›†ç¾¤ä¸­åˆ›å»ºçš„CRï¼Œä¸€ä¸ªk8sé›†ç¾¤ä¸€ä¸ª</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1beta1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>ClusterRegistrationRequest</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>labels</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>cluster-id</span><span class=err>:</span> <span class=n>2bcd48d2</span><span class=p>-</span><span class=n>0ead</span><span class=p>-</span><span class=n>45f7</span><span class=p>-</span><span class=n>938b</span><span class=p>-</span><span class=n>5af6af7da5fd</span>
</span></span><span class=line><span class=cl>    <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>cluster-name</span><span class=err>:</span> <span class=nb>clusternet-cluster</span><span class=n>-pmlbp</span>
</span></span><span class=line><span class=cl>    <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>registered-by</span><span class=err>:</span> <span class=nb>clusternet-agent</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=n>clusternet</span><span class=p>-</span><span class=n>2bcd48d2</span><span class=p>-</span><span class=n>0ead</span><span class=p>-</span><span class=n>45f7</span><span class=p>-</span><span class=n>938b</span><span class=p>-</span><span class=n>5af6af7da5fd</span>
</span></span><span class=line><span class=cl><span class=n>spec</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>clusterId</span><span class=err>:</span> <span class=n>2bcd48d2</span><span class=p>-</span><span class=n>0ead</span><span class=p>-</span><span class=n>45f7</span><span class=p>-</span><span class=n>938b</span><span class=p>-</span><span class=n>5af6af7da5fd</span>
</span></span><span class=line><span class=cl>  <span class=n>clusterName</span><span class=err>:</span> <span class=nb>clusternet-cluster</span><span class=n>-pmlbp</span> <span class=c># é›†ç¾¤åç§°</span>
</span></span><span class=line><span class=cl>  <span class=n>clusterType</span><span class=err>:</span> <span class=n>EdgeCluster</span> <span class=c># é›†ç¾¤ç±»å‹</span>
</span></span><span class=line><span class=cl>  <span class=n>syncMode</span><span class=err>:</span> <span class=n>Dual</span>
</span></span><span class=line><span class=cl><span class=n>status</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>caCertificate</span><span class=err>:</span> <span class=n>LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeE1USXhNekV3TWpjeE5Wb1hEVE14TVRJeE1URXdNamN4TlZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTHVCCmJwdXNaZXM5RXFXaEw1WUVGb2c4eHRJai9jbFh2S1lTMnZYbGR4cUt1MUR3VHV3aUcxZUN4VGlHa2dLQXVXd1IKVFFheEh5aGY3U29lc0hqMG43NnFBKzhQT05lS1VGdERJOWVzejF2WTF5bXFoUHR0QVo0cGhkWmhmbXJjZTJLRQpuMS84MzNWbWlXd0pSZmNWcEJtTU52MjFYMVVwNWp6RGtncS9tY0JOOGN0ZU5PMEpKNkVVeTE2RXZLbjhyWG90ClErTW5PUHE4anFNMzJjRFFqYWVEdGxvM2kveXlRd1NMa2wzNFo4aElwZDZNWWVSTWpXcmhrazF4L0RYZjNJK3IKOGs5S1FBbEsvNWZRMXk5NHYwT25TK0FKZTliczZMT2srYVFWYm5SbExab2E2aVZWbUJNam03UjBjQ2w0Y1hpRwpyekRnN1ZLc3lsY1o3aGFRRTNFQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZPaGwxMHUwNnJvenZJUm9XVmpNYlVPMzFDbERNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFBQytqMXpPQVZYVXpNUFJ0U29Kd3JhMU1FSkJOUTNMWitmWnZRYjdIbk53b00zaCthMgoyc25yUitSWTYrOFFDbXVKeis1eU5yYStEZDlnNzQ1Q0hDaFpVZzlsY3RjQTRzZVR5OXZqcUVQNVBNSzEvbi9PCnFEcDQyMUpqTjYvUXJmamIvbVM0elUvZXNGZGowQXRYQ0FLMWJsNmF0ai9jZXVBbzh1bTRPaUVlNnJhanBYTHUKWFlmQ1FVZFV5TWpQdEZHTDMwNytna0RpdlVsdXk3RkQ4aUpURTh2QWpxOVBXOW40SmxFMjdQWXR5QnNocy9XSApCZ2czQjZpTG10SjZlNzJiWnA3ZmptdmJWTC9VdkxzYXZqRXltZDhrMnN1bFFwQUpzeVJrMkEzM1g3NWJpS0RGCk1CU29DaHc3U2JMSkJrN0FNckRzTjd1Q2U3WWVIWGdZemdhRAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg</span><span class=p>==</span>
</span></span><span class=line><span class=cl>  <span class=n>dedicatedNamespace</span><span class=err>:</span> <span class=nb>clusternet-sdqrh</span>
</span></span><span class=line><span class=cl>  <span class=n>managedClusterName</span><span class=err>:</span> <span class=nb>clusternet-cluster</span><span class=n>-pmlbp</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span><span class=err>:</span> <span class=n>Approved</span>
</span></span><span class=line><span class=cl>  <span class=n>token</span><span class=err>:</span> <span class=n>ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNkluZFpWMUV6UmxCbFdUUldWa1Y0UmxBeWMzaDJOV3RuUzBabVJsaG9jWG94TkhKM2JtUkxiRTlrYUZVaWZRLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUpqYkhWemRHVnlibVYwTFhOa2NYSm9JaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpXTnlaWFF1Ym1GdFpTSTZJbU5zZFhOMFpYSnVaWFF0YmpneWFHc3RkRzlyWlc0dGN6SnpjRFVpTENKcmRXSmxjbTVsZEdWekxtbHZMM05sY25acFkyVmhZMk52ZFc1MEwzTmxjblpwWTJVdFlXTmpiM1Z1ZEM1dVlXMWxJam9pWTJ4MWMzUmxjbTVsZEMxdU9ESm9heUlzSW10MVltVnlibVYwWlhNdWFXOHZjMlZ5ZG1salpXRmpZMjkxYm5RdmMyVnlkbWxqWlMxaFkyTnZkVzUwTG5WcFpDSTZJamN3TWpRMk1tTTBMV0prTlRFdE5HVXpNeTA1WXpnekxUWmpPV1F6TUdGall6bG1aU0lzSW5OMVlpSTZJbk41YzNSbGJUcHpaWEoyYVdObFlXTmpiM1Z1ZERwamJIVnpkR1Z5Ym1WMExYTmtjWEpvT21Oc2RYTjBaWEp1WlhRdGJqZ3lhR3NpZlEuUjJCdEQ1YzQxRm1seC1hTEFKSWQzbGxvOThSY25TakVUak5pSnVuTXg1US1jYXhwc3VkamUxekVtUF9mTHR6TjU4d21Dd3RXcHpoaXhSMWFTUHE5LXJTRlBIYzk3aDlTT3daZGdicC10alFBSjA4dllfYWdiVFRKLU1WN1dpN0xQVzRIcmt1U3RlemUzVHh2RW11NWwySlpzbG5UTXdkR3NGRVlVZzVfeWFoLUQwQ2pnTkZlR1ljUjJ1TlJBWjdkNW00Q1c5VmRkdkNsanNqRE5WX1k0RkFEbGo2cHgzSlh0SDQ4U1ZUd254TS1sNHl0eXBENjZFbG1PYXpUMmRwSWd4eWNSZ0tJSUlacWNQNnZVc0ZOM1Zka21ZZ29ydy1NSUcwc25YdzFaZ1lwRk9SUDJRa3hjd2NOUVVOTjh6VUZqSUZSSmdSSFdjNlo4aXd2eURnZTVn</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=clusterroleå’Œrole>ClusterRoleå’ŒRole</h2><p>ClusterRegistrationRequestè¢«æ¥æ”¶åä¼šåˆ›å»ºClusterRole</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>rbac</span><span class=p>.</span><span class=py>authorization</span><span class=p>.</span><span class=py>k8s</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>ClusterRole</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>annotations</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>autoupdate</span><span class=err>:</span> <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>labels</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>created-by</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>bootstrapping</span><span class=err>:</span> <span class=nb>rbac-defaults</span>
</span></span><span class=line><span class=cl>    <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>cluster-id</span><span class=err>:</span> <span class=n>2bcd48d2</span><span class=p>-</span><span class=n>0ead</span><span class=p>-</span><span class=n>45f7</span><span class=p>-</span><span class=n>938b</span><span class=p>-</span><span class=n>5af6af7da5fd</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=n>clusternet</span><span class=p>-</span><span class=n>2bcd48d2</span><span class=p>-</span><span class=n>0ead</span><span class=p>-</span><span class=n>45f7</span><span class=p>-</span><span class=n>938b</span><span class=p>-</span><span class=n>5af6af7da5fd</span>
</span></span><span class=line><span class=cl><span class=n>rules</span><span class=err>:</span>
</span></span><span class=line><span class=cl><span class=p>-</span> <span class=n>apiGroups</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=py>io</span>
</span></span><span class=line><span class=cl>  <span class=n>resources</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=n>clusterregistrationrequests</span>
</span></span><span class=line><span class=cl>  <span class=n>verbs</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=n>create</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=n>get</span>
</span></span><span class=line><span class=cl><span class=p>-</span> <span class=n>apiGroups</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=n>proxies</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=py>io</span>
</span></span><span class=line><span class=cl>  <span class=n>resourceNames</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=n>2bcd48d2</span><span class=p>-</span><span class=n>0ead</span><span class=p>-</span><span class=n>45f7</span><span class=p>-</span><span class=n>938b</span><span class=p>-</span><span class=n>5af6af7da5fd</span>
</span></span><span class=line><span class=cl>  <span class=n>resources</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=n>sockets</span>
</span></span><span class=line><span class=cl>  <span class=n>verbs</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=s1>&#39;*&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¹¶ä¼šåœ¨clusterå¯¹åº”çš„namespaceä¸‹åˆ›å»ºRole</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>rbac</span><span class=p>.</span><span class=py>authorization</span><span class=p>.</span><span class=py>k8s</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>Role</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>annotations</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>autoupdate</span><span class=err>:</span> <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>labels</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>created-by</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>bootstrapping</span><span class=err>:</span> <span class=nb>rbac-defaults</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=nb>clusternet-managedcluster</span><span class=n>-role</span>
</span></span><span class=line><span class=cl>  <span class=n>namespace</span><span class=err>:</span> <span class=nb>clusternet-sdqrh</span>
</span></span><span class=line><span class=cl><span class=n>rules</span><span class=err>:</span>
</span></span><span class=line><span class=cl><span class=p>-</span> <span class=n>apiGroups</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=s1>&#39;*&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>resources</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=s1>&#39;*&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>verbs</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=s1>&#39;*&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=managedcluster>ManagedCluster</h2><p>clusternet-hubåœ¨æ¥å—ClusterRegistrationRequeståï¼Œä¼šåˆ›å»ºä¸€ä¸ªManagedClusterã€‚ä¸€ä¸ªk8sé›†ç¾¤ä¸€ä¸ªnamespace</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1beta1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>ManagedCluster</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>labels</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>created-by</span><span class=err>:</span> <span class=nb>clusternet-agent</span>
</span></span><span class=line><span class=cl>    <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>cluster-id</span><span class=err>:</span> <span class=n>2bcd48d2</span><span class=p>-</span><span class=n>0ead</span><span class=p>-</span><span class=n>45f7</span><span class=p>-</span><span class=n>938b</span><span class=p>-</span><span class=n>5af6af7da5fd</span>
</span></span><span class=line><span class=cl>    <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>cluster-name</span><span class=err>:</span> <span class=nb>clusternet-cluster</span><span class=n>-pmlbp</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=nb>clusternet-cluster</span><span class=n>-pmlbp</span>
</span></span><span class=line><span class=cl>  <span class=n>namespace</span><span class=err>:</span> <span class=nb>clusternet-sdqrh</span>
</span></span><span class=line><span class=cl><span class=n>spec</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>clusterId</span><span class=err>:</span> <span class=n>2bcd48d2</span><span class=p>-</span><span class=n>0ead</span><span class=p>-</span><span class=n>45f7</span><span class=p>-</span><span class=n>938b</span><span class=p>-</span><span class=n>5af6af7da5fd</span>
</span></span><span class=line><span class=cl>  <span class=n>clusterType</span><span class=err>:</span> <span class=n>EdgeCluster</span>
</span></span><span class=line><span class=cl>  <span class=n>syncMode</span><span class=err>:</span> <span class=n>Dual</span>
</span></span><span class=line><span class=cl><span class=n>status</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>allocatable</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>cpu</span><span class=err>:</span> <span class=mf>7600m</span>
</span></span><span class=line><span class=cl>    <span class=n>memory</span><span class=err>:</span> <span class=s2>&#34;30792789992&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>apiserverURL</span><span class=err>:</span> <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=mf>10.233</span><span class=p>.</span><span class=py>0</span><span class=p>.</span><span class=mf>1</span><span class=err>:</span><span class=mf>443</span> <span class=c># default/kubernetesçš„service clusterip</span>
</span></span><span class=line><span class=cl>  <span class=n>appPusher</span><span class=err>:</span> <span class=n>true</span>
</span></span><span class=line><span class=cl>  <span class=n>capacity</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>cpu</span><span class=err>:</span> <span class=s2>&#34;8&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>memory</span><span class=err>:</span> <span class=n>32192720Ki</span>
</span></span><span class=line><span class=cl>  <span class=n>clusterCIDR</span><span class=err>:</span> <span class=mf>10.233</span><span class=p>.</span><span class=py>0</span><span class=p>.</span><span class=mf>0</span><span class=p>/</span><span class=mf>18</span>
</span></span><span class=line><span class=cl>  <span class=n>conditions</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span> <span class=n>lastTransitionTime</span><span class=err>:</span> <span class=s2>&#34;2021-12-15T07:47:10Z&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>message</span><span class=err>:</span> <span class=n>managed</span> <span class=n>cluster</span> <span class=n>is</span> <span class=n>ready</span><span class=p>.</span>
</span></span><span class=line><span class=cl>    <span class=n>reason</span><span class=err>:</span> <span class=n>ManagedClusterReady</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span><span class=err>:</span> <span class=s2>&#34;True&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>type</span><span class=err>:</span> <span class=n>Ready</span>
</span></span><span class=line><span class=cl>  <span class=n>healthz</span><span class=err>:</span> <span class=n>true</span>
</span></span><span class=line><span class=cl>  <span class=n>heartbeatFrequencySeconds</span><span class=err>:</span> <span class=mf>180</span>
</span></span><span class=line><span class=cl>  <span class=n>k8sVersion</span><span class=err>:</span> <span class=n>v1</span><span class=p>.</span><span class=py>21</span><span class=p>.</span><span class=py>5</span>
</span></span><span class=line><span class=cl>  <span class=n>lastObservedTime</span><span class=err>:</span> <span class=s2>&#34;2021-12-15T07:47:10Z&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>livez</span><span class=err>:</span> <span class=n>true</span>
</span></span><span class=line><span class=cl>  <span class=n>nodeStatistics</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>readyNodes</span><span class=err>:</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl>  <span class=n>parentAPIServerURL</span><span class=err>:</span> <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=mf>172.21</span><span class=p>.</span><span class=py>115</span><span class=p>.</span><span class=mf>160</span><span class=err>:</span><span class=mf>6443</span>  <span class=c># çˆ¶é›†ç¾¤åœ°å€</span>
</span></span><span class=line><span class=cl>  <span class=n>platform</span><span class=err>:</span> <span class=n>linux</span><span class=p>/</span><span class=n>amd64</span>
</span></span><span class=line><span class=cl>  <span class=n>readyz</span><span class=err>:</span> <span class=n>true</span>
</span></span><span class=line><span class=cl>  <span class=n>serviceCIDR</span><span class=err>:</span> <span class=mf>10.233</span><span class=p>.</span><span class=py>64</span><span class=p>.</span><span class=mf>0</span><span class=p>/</span><span class=mf>18</span>
</span></span><span class=line><span class=cl>  <span class=n>useSocket</span><span class=err>:</span> <span class=n>true</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=subscription>Subscription</h2><p>åº”ç”¨å‘å¸ƒçš„æŠ½è±¡ï¼Œäººå·¥æäº¤åˆ°ç¯å¢ƒä¸­ã€‚è¦å‘å¸ƒçš„èµ„æºå³å¯ä»¥æ˜¯helm chartï¼Œä¹Ÿå¯ä»¥æ˜¯åŸç”Ÿçš„k8så¯¹è±¡ã€‚clusternetåœ¨éƒ¨ç½²çš„æ—¶å€™ä¼šæŸ¥çœ‹éƒ¨ç½²çš„ä¼˜å…ˆçº§ï¼Œå¹¶ä¸”æ”¯æŒweightï¼Œä¼˜å…ˆéƒ¨ç½²clusterçº§åˆ«çš„èµ„æºï¼Œè¿™ç‚¹è·Ÿhelméƒ¨ç½²çš„é€»è¾‘ä¸€è‡´ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>apps</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1alpha1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>Subscription</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=nb>app-demo</span>
</span></span><span class=line><span class=cl>  <span class=n>namespace</span><span class=err>:</span> <span class=k>default</span>
</span></span><span class=line><span class=cl><span class=n>spec</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=c># å®šä¹‰åº”ç”¨è¦å‘å¸ƒåˆ°å“ªä¸ªk8sé›†ç¾¤</span>
</span></span><span class=line><span class=cl>  <span class=n>subscribers</span><span class=err>:</span> <span class=c># defines the clusters to be distributed to</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>clusterAffinity</span><span class=err>:</span>
</span></span><span class=line><span class=cl>        <span class=n>matchLabels</span><span class=err>:</span>
</span></span><span class=line><span class=cl>          <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>cluster-id</span><span class=err>:</span> <span class=n>dc91021d</span><span class=p>-</span><span class=mf>2361</span><span class=p>-</span><span class=n>4f6d-a404</span><span class=p>-</span><span class=n>7c33b9e01118</span> <span class=c># PLEASE UPDATE THIS CLUSTER-ID TO YOURS!!!</span>
</span></span><span class=line><span class=cl>	<span class=c># å®šä¹‰äº†è¦å‘å¸ƒå“ªäº›èµ„æº</span>
</span></span><span class=line><span class=cl>  <span class=n>feeds</span><span class=err>:</span> <span class=c># defines all the resources to be deployed with</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>apiVersion</span><span class=err>:</span> <span class=n>apps</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1alpha1</span>
</span></span><span class=line><span class=cl>      <span class=n>kind</span><span class=err>:</span> <span class=n>HelmChart</span>
</span></span><span class=line><span class=cl>      <span class=n>name</span><span class=err>:</span> <span class=n>mysql</span>
</span></span><span class=line><span class=cl>      <span class=n>namespace</span><span class=err>:</span> <span class=k>default</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>apiVersion</span><span class=err>:</span> <span class=n>v1</span>
</span></span><span class=line><span class=cl>      <span class=n>kind</span><span class=err>:</span> <span class=n>Namespace</span>
</span></span><span class=line><span class=cl>      <span class=n>name</span><span class=err>:</span> <span class=n>foo</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>apiVersion</span><span class=err>:</span> <span class=n>v1</span>
</span></span><span class=line><span class=cl>      <span class=n>kind</span><span class=err>:</span> <span class=n>Service</span>
</span></span><span class=line><span class=cl>      <span class=n>name</span><span class=err>:</span> <span class=nb>my-nginx</span><span class=n>-svc</span>
</span></span><span class=line><span class=cl>      <span class=n>namespace</span><span class=err>:</span> <span class=n>foo</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>apiVersion</span><span class=err>:</span> <span class=n>apps</span><span class=p>/</span><span class=n>v1</span>
</span></span><span class=line><span class=cl>      <span class=n>kind</span><span class=err>:</span> <span class=n>Deployment</span>
</span></span><span class=line><span class=cl>      <span class=n>name</span><span class=err>:</span> <span class=nb>my-nginx</span>
</span></span><span class=line><span class=cl>      <span class=n>namespace</span><span class=err>:</span> <span class=n>foo</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=helmchart>HelmChart</h2><p>Subscriberå‘å¸ƒçš„ä¸€ä¸ªå­èµ„æºä¹‹ä¸€ï¼Œå¯¹åº”ä¸€ä¸ªhelm chartçš„å®Œæ•´æè¿°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>apps</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1alpha1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>HelmChart</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=n>mysql</span>
</span></span><span class=line><span class=cl>  <span class=n>namespace</span><span class=err>:</span> <span class=k>default</span>
</span></span><span class=line><span class=cl><span class=n>spec</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>repo</span><span class=err>:</span> <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>charts</span><span class=p>.</span><span class=py>bitnami</span><span class=p>.</span><span class=n>com</span><span class=p>/</span><span class=n>bitnami</span>
</span></span><span class=line><span class=cl>  <span class=n>chart</span><span class=err>:</span> <span class=n>mysql</span>
</span></span><span class=line><span class=cl>  <span class=n>version</span><span class=err>:</span> <span class=mf>8.6</span><span class=p>.</span><span class=py>2</span>
</span></span><span class=line><span class=cl>  <span class=n>targetNamespace</span><span class=err>:</span> <span class=n>abc</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=localization>Localization</h2><p>å·®å¼‚åŒ–ä¸åŒäºå…¶ä»–é›†ç¾¤çš„é…ç½®ï¼Œç”¨æ¥æè¿°namespaceçº§åˆ«çš„å·®å¼‚åŒ–é…ç½®ã€‚</p><h2 id=globalization>Globalization</h2><p>ç”¨æ¥æè¿°ä¸åŒé›†ç¾¤çš„clusterçº§åˆ«çš„å·®å¼‚åŒ–é…ç½®ã€‚</p><h2 id=base>Base</h2><h2 id=description>Description</h2><p>è·ŸBaseå¯¹è±¡æ ¹æ®Localizationå’ŒGlobalizationæ¸²æŸ“å¾—åˆ°çš„æœ€ç»ˆè¦å‘å¸ƒåˆ°é›†ç¾¤ä¸­çš„æœ€ç»ˆå¯¹è±¡ã€‚</p><h1 id=å®‰è£…>å®‰è£…</h1><p>æœ¬æ–‡ä½¿ç”¨kindè¿›è¡Œæµ‹è¯•ï¼Œä½¿ç”¨kindåˆ›å»ºä¸¤ä¸ªk8sé›†ç¾¤hostå’Œmember1ï¼Œä¸¤ä¸ªé›†ç¾¤çš„apiserverå‡ç›‘å¬åœ¨å®¿ä¸»æœºçš„ç«¯å£ï¼Œç¡®ä¿ä»ä¸€ä¸ªé›†ç¾¤å¯ä»¥è®¿é—®åˆ°å¦å¤–ä¸€ä¸ªé›†ç¾¤çš„apiserverã€‚</p><p>åœ¨çˆ¶é›†ç¾¤æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…clusternetç®¡æ§ç»„ä»¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>helm</span> <span class=n>repo</span> <span class=n>add</span> <span class=n>clusternet</span> <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>clusternet</span><span class=p>.</span><span class=py>github</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>charts</span>
</span></span><span class=line><span class=cl><span class=n>helm</span> <span class=n>install</span> <span class=nb>clusternet-hub</span> <span class=n>-n</span> <span class=nb>clusternet-system</span> <span class=p>-</span><span class=n>-create-namespace</span> <span class=n>clusternet</span><span class=p>/</span><span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl><span class=n>kubectl</span> <span class=n>apply</span> <span class=o>-f</span> <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>raw</span><span class=p>.</span><span class=py>githubusercontent</span><span class=p>.</span><span class=n>com</span><span class=p>/</span><span class=n>clusternet</span><span class=p>/</span><span class=n>clusternet</span><span class=p>/</span><span class=n>main</span><span class=p>/</span><span class=n>manifests</span><span class=p>/</span><span class=n>samples</span><span class=p>/</span><span class=n>cluster_bootstrap_token</span><span class=p>.</span><span class=py>yaml</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¼šåœ¨clusternet-system namespaceä¸‹åˆ›å»ºdeployment clusternet-hubã€‚</p><p>æœ€åä¸€æ¡å‘½ä»¤ï¼Œä¼šåˆ›å»ºä¸€ä¸ªsecretï¼Œå…¶ä¸­çš„tokenä¿¡æ¯ä¸º07401b.f395accd246ae52dï¼Œåœ¨å­é›†ç¾¤æ³¨å†Œçš„æ—¶å€™éœ€è¦ç”¨åˆ°ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>v1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>Secret</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=c># Name MUST be of form &#34;bootstrap-token-&lt;token id&gt;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=nb>bootstrap-token</span><span class=p>-</span><span class=n>07401b</span>
</span></span><span class=line><span class=cl>  <span class=n>namespace</span><span class=err>:</span> <span class=nb>kube-system</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Type MUST be &#39;bootstrap.kubernetes.io/token&#39;</span>
</span></span><span class=line><span class=cl><span class=n>type</span><span class=err>:</span> <span class=n>bootstrap</span><span class=p>.</span><span class=py>kubernetes</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>token</span>
</span></span><span class=line><span class=cl><span class=n>stringData</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=c># Human readable description. Optional.</span>
</span></span><span class=line><span class=cl>  <span class=n>description</span><span class=err>:</span> <span class=s2>&#34;The bootstrap token used by clusternet cluster registration.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c># Token ID and secret. Required.</span>
</span></span><span class=line><span class=cl>  <span class=nb>token-id</span><span class=err>:</span> <span class=n>07401b</span>
</span></span><span class=line><span class=cl>  <span class=nb>token-secret</span><span class=err>:</span> <span class=n>f395accd246ae52d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c># Expiration. Optional.</span>
</span></span><span class=line><span class=cl>  <span class=n>expiration</span><span class=err>:</span> <span class=mf>2025</span><span class=p>-</span><span class=mf>05</span><span class=p>-</span><span class=n>10T03</span><span class=err>:</span><span class=mf>22</span><span class=err>:</span><span class=n>11Z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c># Allowed usages.</span>
</span></span><span class=line><span class=cl>  <span class=nb>usage-bootstrap</span><span class=n>-authentication:</span> <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>usage-bootstrap</span><span class=n>-signing:</span> <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c># Extra groups to authenticate the token as. Must start with &#34;system:bootstrappers:&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>auth-extra</span><span class=n>-groups:</span> <span class=n>system</span><span class=err>:</span><span class=n>bootstrappers</span><span class=err>:</span><span class=n>clusternet</span><span class=err>:</span><span class=nb>register-cluster</span><span class=n>-token</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨å­é›†ç¾¤æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå…¶ä¸­parentURLè¦ä¿®æ”¹ä¸ºçˆ¶é›†ç¾¤çš„apiserveråœ°å€</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>helm</span> <span class=n>repo</span> <span class=n>add</span> <span class=n>clusternet</span> <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>clusternet</span><span class=p>.</span><span class=py>github</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>charts</span>
</span></span><span class=line><span class=cl><span class=n>helm</span> <span class=n>install</span> <span class=nb>clusternet-agent</span> <span class=n>-n</span> <span class=nb>clusternet-system</span> <span class=p>-</span><span class=n>-create-namespace</span> <span class=p>\</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span><span class=n>-set</span> <span class=n>parentURL</span><span class=p>=</span><span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=mf>10.0</span><span class=p>.</span><span class=py>248</span><span class=p>.</span><span class=mf>96</span><span class=err>:</span><span class=mf>8443</span> <span class=p>\</span>
</span></span><span class=line><span class=cl>  <span class=p>-</span><span class=n>-set</span> <span class=n>registrationToken</span><span class=p>=</span><span class=n>07401b</span><span class=p>.</span><span class=py>f395accd246ae52d</span> <span class=p>\</span>
</span></span><span class=line><span class=cl>  <span class=n>clusternet</span><span class=p>/</span><span class=nb>clusternet-agent</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶ä¸­parentURLä¸ºçˆ¶é›†ç¾¤çš„apiserveråœ°å€ï¼ŒregistrationTokenä¸ºçˆ¶é›†ç¾¤æ³¨å†Œçš„tokenä¿¡æ¯ã€‚</p><h1 id=è®¿é—®å­é›†ç¾¤>è®¿é—®å­é›†ç¾¤</h1><h2 id=kubectl-clusternetå‘½ä»¤è¡Œæ–¹å¼è®¿é—®>kubectl-clusternetå‘½ä»¤è¡Œæ–¹å¼è®¿é—®</h2><p>å®‰è£…kubectl krewæ’ä»¶ï¼Œå‚è€ƒ <a class=link href=https://krew.sigs.k8s.io/docs/user-guide/setup/install/ target=_blank rel=noopener>https://krew.sigs.k8s.io/docs/user-guide/setup/install/</a>ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>yum</span> <span class=n>install</span> <span class=n>git</span> <span class=n>-y</span>
</span></span><span class=line><span class=cl><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nb>set </span><span class=n>-x</span><span class=p>;</span> <span class=nb>cd </span><span class=s2>&#34;</span><span class=p>$(</span><span class=n>mktemp</span> <span class=n>-d</span><span class=p>)</span><span class=s2>&#34;</span> <span class=p>&amp;&amp;</span>
</span></span><span class=line><span class=cl>  <span class=n>OS</span><span class=p>=</span><span class=s2>&#34;</span><span class=p>$(</span><span class=n>uname</span> <span class=p>|</span> <span class=n>tr</span> <span class=s1>&#39;[:upper:]&#39;</span> <span class=s1>&#39;[:lower:]&#39;</span><span class=p>)</span><span class=s2>&#34;</span> <span class=p>&amp;&amp;</span>
</span></span><span class=line><span class=cl>  <span class=n>ARCH</span><span class=p>=</span><span class=s2>&#34;</span><span class=p>$(</span><span class=n>uname</span> <span class=n>-m</span> <span class=p>|</span> <span class=n>sed</span> <span class=n>-e</span> <span class=s1>&#39;s/x86_64/amd64/&#39;</span> <span class=n>-e</span> <span class=s1>&#39;s/\(arm\)\(64\)\?.*/\1\2/&#39;</span> <span class=n>-e</span> <span class=s1>&#39;s/aarch64$/arm64/&#39;</span><span class=p>)</span><span class=s2>&#34;</span> <span class=p>&amp;&amp;</span>
</span></span><span class=line><span class=cl>  <span class=n>KREW</span><span class=p>=</span><span class=s2>&#34;krew-</span><span class=nv>${OS}</span><span class=s2>_</span><span class=nv>${ARCH}</span><span class=s2>&#34;</span> <span class=p>&amp;&amp;</span>
</span></span><span class=line><span class=cl>  <span class=nb>curl </span><span class=n>-fsSLO</span> <span class=s2>&#34;https://github.com/kubernetes-sigs/krew/releases/latest/download/</span><span class=nv>${KREW}</span><span class=s2>.tar.gz&#34;</span> <span class=p>&amp;&amp;</span>
</span></span><span class=line><span class=cl>  <span class=n>tar</span> <span class=n>zxvf</span> <span class=s2>&#34;</span><span class=nv>${KREW}</span><span class=s2>.tar.gz&#34;</span> <span class=p>&amp;&amp;</span>
</span></span><span class=line><span class=cl>  <span class=p>./</span><span class=s2>&#34;</span><span class=nv>${KREW}</span><span class=s2>&#34;</span> <span class=n>install</span> <span class=n>krew</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=s1>&#39;export PATH=&#34;${PATH}:${HOME}/.krew/bin&#34;&#39;</span> <span class=p>&gt;&gt;</span>  <span class=p>~/.</span><span class=py>bashrc</span>
</span></span><span class=line><span class=cl><span class=n>source</span> <span class=p>~/.</span><span class=py>bashrc</span>
</span></span></code></pre></td></tr></table></div></div><p>å®‰è£…kubectlæ’ä»¶clusternetï¼škubectl krew install clusternet</p><p>ä½¿ç”¨kubectl clusternet getå¯ä»¥çœ‹åˆ°å‘å¸ƒçš„åº”ç”¨ï¼Œéå‘å¸ƒçš„åº”ç”¨çœ‹ä¸åˆ°ã€‚</p><h2 id=ä»£ç å±‚é¢è®¿é—®å­é›†ç¾¤>ä»£ç å±‚é¢è®¿é—®å­é›†ç¾¤</h2><p>å¯ä»¥å‚ç…§ä¾‹å­ï¼š<a class=link href=https://github.com/clusternet/clusternet/blob/main/examples/clientgo/demo.go#L42-L45 target=_blank rel=noopener>https://github.com/clusternet/clusternet/blob/main/examples/clientgo/demo.go#L42-L45</a></p><p>æ”¹åŠ¨ä»£ç éå¸¸å°ï¼Œä»…éœ€è¦è·å–åˆ°å¯¹åº”é›†ç¾¤çš„configä¿¡æ¯å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>config</span><span class=p>,</span> <span class=n>err</span> <span class=err>:</span><span class=p>=</span> <span class=n>rest</span><span class=p>.</span><span class=py>InClusterConfig</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=n>err</span> <span class=p>!=</span> <span class=n>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>klog</span><span class=p>.</span><span class=py>Error</span><span class=p>(</span><span class=n>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>os</span><span class=p>.</span><span class=py>Exit</span><span class=p>(</span><span class=mf>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>//</span> <span class=n>This</span> <span class=n>is</span> <span class=n>the</span> <span class=n>ONLY</span> <span class=n>place</span> <span class=n>you</span> <span class=n>need</span> <span class=n>to</span> <span class=n>wrap</span> <span class=k>for</span> <span class=n>Clusternet</span>
</span></span><span class=line><span class=cl>	<span class=n>config</span><span class=p>.</span><span class=py>Wrap</span><span class=p>(</span><span class=n>func</span><span class=p>(</span><span class=n>rt</span> <span class=n>http</span><span class=p>.</span><span class=n>RoundTripper</span><span class=p>)</span> <span class=n>http</span><span class=p>.</span><span class=py>RoundTripper</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>clientgo</span><span class=p>.</span><span class=py>NewClusternetTransport</span><span class=p>(</span><span class=n>config</span><span class=p>.</span><span class=n>Host</span><span class=p>,</span> <span class=n>rt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>//</span> <span class=n>now</span> <span class=n>we</span> <span class=n>could</span> <span class=n>create</span> <span class=n>and</span> <span class=n>visit</span> <span class=n>all</span> <span class=n>the</span> <span class=n>resources</span>
</span></span><span class=line><span class=cl>	<span class=n>client</span> <span class=err>:</span><span class=p>=</span> <span class=n>kubernetes</span><span class=p>.</span><span class=py>NewForConfigOrDie</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>_</span><span class=p>,</span> <span class=n>err</span> <span class=p>=</span> <span class=n>client</span><span class=p>.</span><span class=py>CoreV1</span><span class=p>().</span><span class=py>Namespaces</span><span class=p>().</span><span class=py>Create</span><span class=p>(</span><span class=n>context</span><span class=p>.</span><span class=py>TODO</span><span class=p>(),</span> <span class=p>&amp;</span><span class=n>corev1</span><span class=p>.</span><span class=py>Namespace</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>ObjectMeta</span><span class=err>:</span> <span class=n>metav1</span><span class=p>.</span><span class=py>ObjectMeta</span><span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>Name</span><span class=err>:</span> <span class=s2>&#34;demo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>},</span> <span class=n>metav1</span><span class=p>.</span><span class=py>CreateOptions</span><span class=p>{})</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=åº”ç”¨å‘å¸ƒ>åº”ç”¨å‘å¸ƒ</h1><p><img src=https://kuring.oss-cn-beijing.aliyuncs.com/images/clusternet3.png loading=lazy alt=image.png>
åœ¨ä¸»é›†ç¾¤æäº¤å¦‚ä¸‹çš„yamlæ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>apps</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1alpha1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>Subscription</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=nb>app-demo</span>
</span></span><span class=line><span class=cl>  <span class=n>namespace</span><span class=err>:</span> <span class=k>default</span>
</span></span><span class=line><span class=cl><span class=n>spec</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>subscribers</span><span class=err>:</span> <span class=c># defines the clusters to be distributed to</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>clusterAffinity</span><span class=err>:</span>
</span></span><span class=line><span class=cl>        <span class=n>matchLabels</span><span class=err>:</span>
</span></span><span class=line><span class=cl>          <span class=n>clusters</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>cluster-id</span><span class=err>:</span> <span class=n>dc91021d</span><span class=p>-</span><span class=mf>2361</span><span class=p>-</span><span class=n>4f6d-a404</span><span class=p>-</span><span class=n>7c33b9e01118</span> <span class=c># PLEASE UPDATE THIS CLUSTER-ID TO YOURS!!!</span>
</span></span><span class=line><span class=cl>  <span class=n>feeds</span><span class=err>:</span> <span class=c># defines all the resources to be deployed with</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>apiVersion</span><span class=err>:</span> <span class=n>apps</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1alpha1</span>
</span></span><span class=line><span class=cl>      <span class=n>kind</span><span class=err>:</span> <span class=n>HelmChart</span>
</span></span><span class=line><span class=cl>      <span class=n>name</span><span class=err>:</span> <span class=n>mysql</span>
</span></span><span class=line><span class=cl>      <span class=n>namespace</span><span class=err>:</span> <span class=k>default</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>apiVersion</span><span class=err>:</span> <span class=n>v1</span>
</span></span><span class=line><span class=cl>      <span class=n>kind</span><span class=err>:</span> <span class=n>Namespace</span>
</span></span><span class=line><span class=cl>      <span class=n>name</span><span class=err>:</span> <span class=n>foo</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>apiVersion</span><span class=err>:</span> <span class=n>apps</span><span class=p>/</span><span class=n>v1</span>
</span></span><span class=line><span class=cl>      <span class=n>kind</span><span class=err>:</span> <span class=n>Service</span>
</span></span><span class=line><span class=cl>      <span class=n>name</span><span class=err>:</span> <span class=nb>my-nginx</span><span class=n>-svc</span>
</span></span><span class=line><span class=cl>      <span class=n>namespace</span><span class=err>:</span> <span class=n>foo</span>
</span></span><span class=line><span class=cl>    <span class=p>-</span> <span class=n>apiVersion</span><span class=err>:</span> <span class=n>apps</span><span class=p>/</span><span class=n>v1</span>
</span></span><span class=line><span class=cl>      <span class=n>kind</span><span class=err>:</span> <span class=n>Deployment</span>
</span></span><span class=line><span class=cl>      <span class=n>name</span><span class=err>:</span> <span class=nb>my-nginx</span>
</span></span><span class=line><span class=cl>      <span class=n>namespace</span><span class=err>:</span> <span class=n>foo</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=å®ç°åˆ†æ>å®ç°åˆ†æ</h1><p>åœ¨ä¸»é›†ç¾¤å®ç°äº†ä¸¤ä¸ªaggregated apiservice</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>apiregistration</span><span class=p>.</span><span class=py>k8s</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>APIService</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>annotations</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>meta</span><span class=p>.</span><span class=py>helm</span><span class=p>.</span><span class=n>sh</span><span class=p>/</span><span class=nb>release-name</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>meta</span><span class=p>.</span><span class=py>helm</span><span class=p>.</span><span class=n>sh</span><span class=p>/</span><span class=nb>release-namespace</span><span class=err>:</span> <span class=nb>clusternet-system</span>
</span></span><span class=line><span class=cl>  <span class=n>labels</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=py>kubernetes</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>instance</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=py>kubernetes</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>managed-by</span><span class=err>:</span> <span class=n>Helm</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=py>kubernetes</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>name</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>helm</span><span class=p>.</span><span class=n>sh</span><span class=p>/</span><span class=n>chart</span><span class=err>:</span> <span class=nb>clusternet-hub</span><span class=p>-</span><span class=mf>0.2</span><span class=p>.</span><span class=py>1</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=n>v1alpha1</span><span class=p>.</span><span class=py>proxies</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=py>io</span>
</span></span><span class=line><span class=cl><span class=n>spec</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>group</span><span class=err>:</span> <span class=n>proxies</span><span class=p>.</span><span class=py>clusternet</span><span class=p>.</span><span class=py>io</span>
</span></span><span class=line><span class=cl>  <span class=n>groupPriorityMinimum</span><span class=err>:</span> <span class=mf>1000</span>
</span></span><span class=line><span class=cl>  <span class=n>insecureSkipTLSVerify</span><span class=err>:</span> <span class=n>true</span>
</span></span><span class=line><span class=cl>  <span class=n>service</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>namespace</span><span class=err>:</span> <span class=nb>clusternet-system</span>
</span></span><span class=line><span class=cl>    <span class=n>port</span><span class=err>:</span> <span class=mf>443</span>
</span></span><span class=line><span class=cl>  <span class=n>version</span><span class=err>:</span> <span class=n>v1alpha1</span>
</span></span><span class=line><span class=cl>  <span class=n>versionPriority</span><span class=err>:</span> <span class=mf>100</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>apiVersion</span><span class=err>:</span> <span class=n>apiregistration</span><span class=p>.</span><span class=py>k8s</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>v1</span>
</span></span><span class=line><span class=cl><span class=n>kind</span><span class=err>:</span> <span class=n>APIService</span>
</span></span><span class=line><span class=cl><span class=n>metadata</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>annotations</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>meta</span><span class=p>.</span><span class=py>helm</span><span class=p>.</span><span class=n>sh</span><span class=p>/</span><span class=nb>release-name</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>meta</span><span class=p>.</span><span class=py>helm</span><span class=p>.</span><span class=n>sh</span><span class=p>/</span><span class=nb>release-namespace</span><span class=err>:</span> <span class=nb>clusternet-system</span>
</span></span><span class=line><span class=cl>  <span class=n>labels</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=py>kubernetes</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>instance</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=py>kubernetes</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=nb>managed-by</span><span class=err>:</span> <span class=n>Helm</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=py>kubernetes</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>name</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>helm</span><span class=p>.</span><span class=n>sh</span><span class=p>/</span><span class=n>chart</span><span class=err>:</span> <span class=nb>clusternet-hub</span><span class=p>-</span><span class=mf>0.2</span><span class=p>.</span><span class=py>1</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=err>:</span> <span class=n>v1alpha1</span><span class=p>.</span><span class=py>shadow</span>
</span></span><span class=line><span class=cl><span class=n>spec</span><span class=err>:</span>
</span></span><span class=line><span class=cl>  <span class=n>group</span><span class=err>:</span> <span class=n>shadow</span>
</span></span><span class=line><span class=cl>  <span class=n>groupPriorityMinimum</span><span class=err>:</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl>  <span class=n>insecureSkipTLSVerify</span><span class=err>:</span> <span class=n>true</span>
</span></span><span class=line><span class=cl>  <span class=n>service</span><span class=err>:</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=err>:</span> <span class=nb>clusternet-hub</span>
</span></span><span class=line><span class=cl>    <span class=n>namespace</span><span class=err>:</span> <span class=nb>clusternet-system</span>
</span></span><span class=line><span class=cl>    <span class=n>port</span><span class=err>:</span> <span class=mf>443</span>
</span></span><span class=line><span class=cl>  <span class=n>version</span><span class=err>:</span> <span class=n>v1alpha1</span>
</span></span><span class=line><span class=cl>  <span class=n>versionPriority</span><span class=err>:</span> <span class=mf>1</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=ç›¸å…³é“¾æ¥>ç›¸å…³é“¾æ¥</h1><ul><li><a class=link href=https://mp.weixin.qq.com/s/BSgb2uoAuHbxQOUvn8fEsA target=_blank rel=noopener>https://mp.weixin.qq.com/s/BSgb2uoAuHbxQOUvn8fEsA</a></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/%E5%A4%9A%E9%9B%86%E7%BE%A4/>å¤šé›†ç¾¤</a></section></footer></article><script src=https://giscus.app/client.js data-repo=kuring/kuring.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkyODM4MzQ0NTk=" data-category=Announcements data-category-id=DIC_kwDOEOr4W84CdeTU data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=light data-lang=zh-CN data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2013 -
2026 kuring</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>