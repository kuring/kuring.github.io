<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="title: 我要看电视 - 将树莓派 5 打造成 Android TV 电视盒子折腾记（1） date: 2024-02-17 11:23:07 tags: author: 在上一篇文章 《我要看电视 - 投影仪和电视盒子选型》中，提到了用树莓派 5 来作为电视盒子，需要刷 Android TV 系统，本文将详细介绍折腾经历。\n在这之前我并没有接触过树莓派，Android 系统倒是曾经刷过机，但也了解不深。文中如有不正确的地方，欢迎指正。\n"><title></title><link rel=canonical href=https://kuring.me/post/pi5-1/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content><meta property='og:description' content="title: 我要看电视 - 将树莓派 5 打造成 Android TV 电视盒子折腾记（1） date: 2024-02-17 11:23:07 tags: author: 在上一篇文章 《我要看电视 - 投影仪和电视盒子选型》中，提到了用树莓派 5 来作为电视盒子，需要刷 Android TV 系统，本文将详细介绍折腾经历。\n在这之前我并没有接触过树莓派，Android 系统倒是曾经刷过机，但也了解不深。文中如有不正确的地方，欢迎指正。\n"><meta property='og:url' content='https://kuring.me/post/pi5-1/'><meta property='og:site_name' content='404频道'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta name=twitter:title content><meta name=twitter:description content="title: 我要看电视 - 将树莓派 5 打造成 Android TV 电视盒子折腾记（1） date: 2024-02-17 11:23:07 tags: author: 在上一篇文章 《我要看电视 - 投影仪和电视盒子选型》中，提到了用树莓派 5 来作为电视盒子，需要刷 Android TV 系统，本文将详细介绍折腾经历。\n在这之前我并没有接触过树莓派，Android 系统倒是曾经刷过机，但也了解不深。文中如有不正确的地方，欢迎指正。\n"><link rel="shortcut icon" href=/images/avatar.jpeg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_16fb6c03614f4da2.jpeg width=300 height=280 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>📡</span></figure><div class=site-meta><h1 class=site-name><a href=/>404频道</a></h1><h2 class=site-description>学习笔记</h2></div></header><ol class=menu-social><li><a href=https://github.com/kuring target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于我</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#author>title: 我要看电视 - 将树莓派 5 打造成 Android TV 电视盒子折腾记（1）
date: 2024-02-17 11:23:07
tags:
author:</a></li></ol><ol><li><a href=#刷入-google-apps-包>刷入 Google Apps 包</a></li><li><a href=#查询并注册-android-id>查询并注册 Android ID</a></li><li><a href=#使用-google-账号登录>使用 Google 账号登录</a></li></ol><ol><li><a href=#听不到声音>听不到声音</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/post/pi5-1/></a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 9 分钟</time></div></footer></div></header><section class=article-content><h2 id=author>title: 我要看电视 - 将树莓派 5 打造成 Android TV 电视盒子折腾记（1）
date: 2024-02-17 11:23:07
tags:
author:</h2><p>在上一篇文章 《<a class=link href=/post/watch-tv/>我要看电视 - 投影仪和电视盒子选型</a>》中，提到了用树莓派 5 来作为电视盒子，需要刷 Android TV 系统，本文将详细介绍折腾经历。<br>在这之前我并没有接触过树莓派，Android 系统倒是曾经刷过机，但也了解不深。文中如有不正确的地方，欢迎指正。</p><h1 id=准备工作>准备工作</h1><p>要想折腾树莓派，还是需要一点点设备，我使用到的设备清单如下：</p><ol><li>一台 Mac 笔记本电脑：用来下载镜像、烧录景象、远程连接电视盒子等。其他操作系统的电脑均可。</li><li>一个 32G SD 卡：用来作为树莓派的存储系统 RAM。</li><li>一个 SD 读卡器：用来读取 SD 卡，供电脑烧录系统使用。</li><li>一个 U 盘：该 U 盘并非树莓派的 SD 卡，而是作为树莓派的额外存储，用来向树莓派中复制文件。</li><li>一台显示器：用来显示树莓派的内容，也可以是电视或者投影仪等设备。</li><li>一个 USB 键盘：用来连接树莓派进行操作。</li><li>一个 USB 鼠标：用来连接树莓派进行操作。</li><li>一个蓝牙遥控器：用来连接树莓派的 Android TV 系统。我直接使用了家里办宽带送的移动电视盒子的遥控器。</li><li>一根 HDMI 数据线：其中一头为 Micro HDMI，用来连接树莓派，另外一头为标准 HDMI 口，用来连接显示器。</li></ol><p>另外：</p><ol><li>网络需要能够访问 Google 等网站。</li></ol><h1 id=寻找-android-tv-系统>寻找 Android TV 系统</h1><p>找到树莓派对应的 Android TV 镜像是非常重要的前提，找到合适的 ROM 永远是 Android 系统刷机中非常重要的一环，一般每个设备总有那么几个大神在提供各类 ROM。<br>查找一个设备的资源最快的方式就是去 github.com 上查找 awesome，树莓派的项目地址为：<a class=link href=https://github.com/thibmaek/awesome-raspberry-pi target=_blank rel=noopener>awesome-raspberry-pi</a>。在 OS Images 章节中包含了支持树莓派的多种 OS，单纯搜索 Android TV 并不能找到对应的 OS，但实际上 <a class=link href=https://konstakang.com/devices/rpi4/ target=_blank rel=noopener>KonstaKANG</a> 对应就是 Android 镜像，这是文档不好的地方，并没有将简介写清楚。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/konstakang-1.png loading=lazy alt=image.png></p><p><a class=link href=https://konstakang.com/devices/rpi4/ target=_blank rel=noopener>KonstaKANG</a> 并非一个系统，而是一个网站，包含了多种设备的 OS 镜像。对应的 <a class=link href=https://konstakang.com/devices/rpi5/ target=_blank rel=noopener>Raspberry 5</a> 的页面包含了 AOSP 和 LineageOS 两种 OS 镜像，AOSP 和 LineageOS 均为 android 的发型版。但只提供了 LineageOS 20 一个 Android TV 的版本，剩下的两个为 Android 版本。Android TV 和 Android 并非同一个系统，Android TV 是针对电视使用的系统，而 Android 是针对智能手机和平板使用的系统，用户体验上还是有较大区别。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/konstakang-2.png loading=lazy alt=image.png>
因此，<a class=link href=https://konstakang.com/devices/rpi5/LineageOS20-ATV/ target=_blank rel=noopener>LineageOS 20 Android TV (Android 13) </a>即变为了目前唯一一个可以在树莓派 5 上使用 Android TV 系统，除此之外，别无他选。无论该系统是否完善，这就是目前的唯一选择了。在文章中介绍了非常多的系统方面的支持，建议精读一遍，包括文章后面的评论。<br>文中的两个镜像，一个是原始镜像，另外一个是 ota 补丁包，两个均需要安装。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/konstakang-3.png loading=lazy alt=image.png></p><h1 id=用到的文件>用到的文件</h1><p>由于在国内下载非常不稳定，通常需要魔法下载，我将需要用到的文件上传到云盘供下载使用。我对部分软件的用途一知半解，但我知道安装了应该没有坏处，选择全部安装。</p><ul><li><a class=link href="https://pan.baidu.com/s/1pgGB_h2bUhq9iUXHrosW9w?pwd=rgad" target=_blank rel=noopener>lineage-20.0-20240112-UNOFFICIAL-KonstaKANG-rpi5-atv.zip</a> 提取码：rgad</li><li><a class=link href="https://pan.baidu.com/s/15RAKHM2q6pOGSt0a8jfJUg?pwd=3t4m" target=_blank rel=noopener>lineage-20.0-20240112-UNOFFICIAL-KonstaKANG-rpi5-atv-ota.zip</a> 提取码: 3t4m</li><li><a class=link href="https://pan.baidu.com/s/1HWv0P22uAH2eavIycuaf1A?pwd=33wj" target=_blank rel=noopener>MindTheGapps-13.0.0-arm64-ATV-full-20240104_210039.zip</a> 提取码：33wj</li><li><a class=link href="https://pan.baidu.com/s/1z0NcAlssVKPwav7RZTIUNg?pwd=c6ja" target=_blank rel=noopener>lineage-20.0-rpi-resize.zip</a> 提取码：c6ja</li><li><a class=link href="https://androidfilehost.com/?fid=14871746926876846664#google_vignette" target=_blank rel=noopener>lineage-20.0-rpi-magisk-v25.2.zip</a></li><li><a class=link href="https://androidfilehost.com/?fid=11701882489785033173" target=_blank rel=noopener>lineage-20.0-rpi-widevine.zip</a></li><li><a class=link href=https://github.com/topjohnwu/Magisk/releases/tag/v25.2 target=_blank rel=noopener>Magisk-v25.2.apk</a></li><li><a class=link href="https://androidfilehost.com/?fid=11701882489785033172" target=_blank rel=noopener>lineage-20.0-rpi-gsfaid.zip</a></li></ul><h1 id=刷-lineageos-到树莓派>刷 LineageOS 到树莓派</h1><p>树莓派官方提供了镜像烧录工具 <a class=link href=https://www.raspberrypi.com/software/ target=_blank rel=noopener>Imager</a>，支持 Windows、Ubuntu、Mac，刷机非常方便。<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/imager.png loading=lazy alt=image.png>
将树莓派的 SD 插入到电脑，在 <code>Raspberry Pi Device</code> 中选择 <code>RASPBERRY PI 5</code>，在<code>请选择需要写入的操作系统</code>中使用 <code>Use custom</code> 选项选择已经下载好的文件 lineage-20.0-20240112-UNOFFICIAL-KonstaKANG-rpi5-atv.zip，选择对应的 SD 卡，再点击 <code>Next</code> 即可开始将镜像写入到SD 卡中。<br>值得一提的是，对于树莓派其他的系统，都不需要事先下载，选择系统后，该工具可以自动下载最新版本，这个功能还是非常值得👍。</p><h1 id=lineageos-初步体验及初步设置>LineageOS 初步体验及初步设置</h1><p>在将系统刷入 SD 卡后，即可将 SD 卡放到树莓派 5 中，在树莓派中连接好键盘和鼠标。
下面步骤中可能会用到键盘的一些快捷键：F1 = Home, F2 = Back, F3 = Multi-tasking, F4 = Menu, F5 = Power, F11 = Volume down, and F12 = Volume up
开机后即可看到 LineageOS 的开机动画。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-1.png loading=lazy alt=image.png></p><p>接下来就会看到查找蓝牙设备的界面，这里可以选择等待一会后自动跳过。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-2.png loading=lazy alt=image.png></p><p>接下来就来到了 Welcome 的界面，点击 <code>Start</code>。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-3.png loading=lazy alt=image.png></p><p>接下来会进入到选择语言、连接 WIFI 等操作，完成后即可进入到操作系统界面。操作系统界面可谓简洁到不能再精简，只有一个文件的应用。左上角的语音和搜索功能均不能使用。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-4.png loading=lazy alt=image.png></p><p>但设置功能作为 Android 系统的核心，这部分功能一点都不会少。在设置中连接 Wifi 后发现会持续断开，不知道是否为系统的问题。</p><p>打开 Recovery 模式：设置 -> 系统 -> Buttons，打开右侧的 Advanced restart。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-5.png loading=lazy alt=image.png></p><p>打开开发者模式：设置 -> 系统 -> 关于 -> Android TV 操作系统版本，连续点击键盘的回车键，会提示开发者模式已打开。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-6.png loading=lazy alt=image.png></p><p>打开 Rooted debug：设置 -> 系统 -> 开发者选项 -> 打开 <code>USB 调试</code>、<code>Rooted debugging</code>、<code>ADB over network</code> 三个选项。</p><p>打开树莓派的 SSH 服务：设置 -> 系统 -> Raspberry Pi Settings 中将 SSH 服务打开。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-7.png loading=lazy alt=image.png></p><h1 id=刷入-ota-包>刷入 ota 包</h1><p>接下来选择刷入 OTA 包 <a class=link href="https://pan.baidu.com/s/15RAKHM2q6pOGSt0a8jfJUg?pwd=3t4m" target=_blank rel=noopener>lineage-20.0-20240112-UNOFFICIAL-KonstaKANG-rpi5-atv-ota.zip</a>，ota 包不会用到树莓派镜像烧录器，而是要通过Android Recovery 模式刷入。需要事先准备好 OTA 包，并将其复制到 U 盘中，并将 U 盘插入到树莓派中。</p><p>在 Android 系统设置 -> 系统 -> 重新启动中选择 Recovery，此时系统会重启进入到 Recovery 模式。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/ota-1.png loading=lazy alt=image.png></p><p>点击 <code>Install</code>，并选择右下角的 <code>Select Storage</code> 按钮，选择 USB 存储，即刚插入的 U 盘。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/ota-2.png loading=lazy alt=image.png></p><p>在 U 盘中选择要刷入的 ota 补丁，取消 <code>Zip signature verification</code>。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/ota-3.png loading=lazy alt=image.png></p><p>在 <code>Swipe to confirm Flash</code>处向右滑动鼠标，即可进入到安装 ota 补丁的界面。ota 补丁安装完成后，即可自动重启进入到 Android TV 系统中。重新进入系统后，发现系统的界面没有任何变化，不知道该 ota 补丁的具体影响功能。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/ota-4.png loading=lazy alt=image.png></p><h1 id=系统存储空间设置>系统存储空间设置</h1><p>在默认的情况下，打开设置 -> 存储空间，可以看到内部共享存储空间仅为 4.7 GB，这里的存储空间为 /data 目录挂载的设备，并没有将 U 盘的空间全部使用起来，U 盘剩余的磁盘空间处于未分配状态。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-8.png loading=lazy alt=image.png></p><p>这里使用 <a class=link href="https://pan.baidu.com/s/1z0NcAlssVKPwav7RZTIUNg?pwd=c6ja" target=_blank rel=noopener>lineage-20.0-rpi-resize.zip</a> 工具来修改存储空间，按照刷入 ota 包相同的方式，进入 Recovery 模式下刷入该包，重新进入系统后即发现存储空间已经变大。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-9.png loading=lazy alt=image.png></p><h1 id=安装-adb-工具>安装 adb 工具</h1><p>前置条件：开发者选项中的 ADB over network 必须为开启状态。</p><p>adb 命令需要安装到电脑上，在 mac 下使用 <code>brew install android-platform-tools</code>即可安装完成。</p><p>在 android tv 上查看当前的 ip 地址，我这里为 192.168.31.167。执行 <code>adb connect 192.168.31.167</code> 后即可获取到 USB 调试信息，并选中<code>一律允许使用这台计算机进行调试处</code>后点击允许。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-10.png loading=lazy alt=image.png>
此时在终端中即可显示出连接成功的信息：<code>already connected to 192.168.31.167:5555</code>。</p><p>在安装完 adb 工具后，即可以通过 adb 命令来远程访问 Android TV 系统了。例如：</p><ul><li><code>adb install</code> 可以安装 apk 包。</li><li><code>adb shell settings list global</code> 命令来查看 Android 系统的所有global 配置。</li><li><code>adb logcat</code> 查看 android 的日志。</li></ul><h1 id=远程-ssh-连接>远程 ssh 连接</h1><p>前置条件：</p><ol><li>ssh 连接需要首先在 <code>Raspberry Pi Settings</code> 中的 <code>Remote access</code> 中打开 SSH。</li><li><code>adb connect</code> 可以连接到 Android TV。</li></ol><p>在开启 SSH 服务后，ssh 连接需要使用对应的私钥信息，而私钥信息需要通过 adb 命令获取。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>adb connect 192.168.31.166
</span></span><span class=line><span class=cl>adb root
</span></span><span class=line><span class=cl><span class=c1># 可查看 /data/ssh 目录下的 ssh 秘钥信息</span>
</span></span><span class=line><span class=cl>adb shell ls /data/ssh
</span></span><span class=line><span class=cl><span class=c1># 将秘钥信息放到本地</span>
</span></span><span class=line><span class=cl>adb pull /data/ssh/ssh_host_ed25519_key ~/.ssh/android_tv.key
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> ~/.ssh/android_tv.key
</span></span><span class=line><span class=cl><span class=c1># 成功 ssh 连接</span>
</span></span><span class=line><span class=cl>ssh -i ~/.ssh/android_tv.key root@192.168.31.166
</span></span></code></pre></td></tr></table></div></div><h1 id=安装-google-apps>安装 Google Apps</h1><blockquote><p>注意：此处要求网络具备魔法，可以访问 Google</p></blockquote><h2 id=刷入-google-apps-包>刷入 Google Apps 包</h2><p>Google Apps 包为必须用到的包，通过 Recovery 模式刷入包 <code>MindTheGapps-13.0.0-arm64-ATV-full-20240104_210039.zip</code>。包安装完成后，重新进入系统发现界面发生了变化，多出了应用 Google Play Store，左上角的语音和搜索功能虽然不可以用，但是点击后提示信息已经发生了变化。</p><blockquote><p>原来的文件应用在这里消失不见了，实际上在所有应用中还可以找到。</p></blockquote><p><img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-11.png loading=lazy alt=image.png>
在系统中使用 Google 账号登录 Google Play Store，即使在可以访问 Google 的网络下，发现也一直会失败。</p><h2 id=查询并注册-android-id>查询并注册 Android ID</h2><p>因为该 Android TV 设备并不被信任，需要将 Android ID 在 Android 网站注册。如果不注册，那么 Google 账号登录不成功。<br>将树莓派的 SD 卡插入到笔记本，查看 SD 卡中的文件 gsf-android_id.txt，该文件对应的内容即为 Android ID。<br>还有另外一种办法可以获取到 Android ID，在笔记本上通过 adb 命令查询到当前设备的 Android ID。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>adb root
</span></span><span class=line><span class=cl># 找到 google service 的 sqlite3 数据库文件
</span></span><span class=line><span class=cl>adb shell &#39;find /data -name &#34;gservices.db&#34;&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 通过数据库查询到 android id
</span></span><span class=line><span class=cl># 其中 sqlite3 命令后的为上面步骤查询出的文件路径，如果查询出多个，可以任选一个
</span></span><span class=line><span class=cl>adb shell &#39;sqlite3 /data/data/com.google.android.gsf/databases/gservices.db &#34;select * from main where name = \&#34;android_id\&#34;;&#34;&#39;
</span></span></code></pre></td></tr></table></div></div><p>将上述 Android ID 在网站进行注册，网址：<a class=link href=https://www.google.com/android/uncertified/ target=_blank rel=noopener>https://www.google.com/android/uncertified/</a>
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-12.png loading=lazy alt=image.png></p><h2 id=使用-google-账号登录>使用 Google 账号登录</h2><p>重新进入 Recovery 模式，点击 Wipe -> Factory reset，此时机器会进行重启。该操作会清空系统中的 /data/media 下的内容。(还不太清楚该步骤是否为必须操作)
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-13.png loading=lazy alt=image.png></p><p>机器重新后会重新进入一遍系统的初始化，但现在的初始化界面跟最初的 LineageOS 的初始化有所不同，进入到了 GMS 的开机引导，该步骤中必须要登录到 Google 账号，而且无法跳过。如果 Android ID 没有注册，此时登录 Google 账号一直会失败，导致无法进入到系统中。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-14.png loading=lazy alt=image.png></p><p>登录完成后在首页可以看到了更多的一些信息：
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-15.png loading=lazy alt=image.png></p><h1 id=通过-recovery-刷入其他包>通过 Recovery 刷入其他包</h1><p>widevine 是在 Android 生态下跟数字版权相关的包，通过 Recovery 模式刷入包 lineage-20.0-rpi-widevine.zip。</p><p>通过 Recovery 模式刷入包 lineage-20.0-rpi-magisk-v25.2.zip，进入到 Android TV 系统后通过文件工具安装包 Magisk-v25.2.apk。</p><h1 id=解决网络连接受限>解决网络连接受限</h1><p>如果本地的网络无法访问 Google，默认情况下，网络会提示<code>网络连接受限</code>，原因主要还是跟访问不了 Google 的域名有关，以至于 Android TV 系统不能识别出可以连接互联网。
<img src=https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-16.png loading=lazy alt=image.png></p><p>网络连接受限状态的 WIFI，经测试机器重启后无法自动连接，需要每次都手工连接 WIFI。</p><p>执行如下的命令来系统进行设置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>adb</span> <span class=n>connect</span> <span class=mf>192.168</span><span class=p>.</span><span class=py>31</span><span class=p>.</span><span class=py>166</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 设置时间服务器</span>
</span></span><span class=line><span class=cl><span class=n>adb</span> <span class=n>shell</span> <span class=n>settings</span> <span class=n>put</span> <span class=n>global</span> <span class=n>ntp_server</span> <span class=n>ntp1</span><span class=p>.</span><span class=py>aliyun</span><span class=p>.</span><span class=py>com</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 该值默认为 0</span>
</span></span><span class=line><span class=cl><span class=n>adb</span> <span class=n>shell</span> <span class=n>settings</span> <span class=n>put</span> <span class=n>global</span> <span class=n>captive_portal_detection_enabled</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 默认没有这两个值</span>
</span></span><span class=line><span class=cl><span class=n>adb</span> <span class=n>shell</span> <span class=n>settings</span> <span class=n>put</span> <span class=n>global</span> <span class=n>captive_portal_https_url</span> <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>connect</span><span class=p>.</span><span class=py>rom</span><span class=p>.</span><span class=py>miui</span><span class=p>.</span><span class=n>com</span><span class=p>/</span><span class=n>generate_204</span>
</span></span></code></pre></td></tr></table></div></div><p>设置完成后重启系统，即可看到网络的连接受限已经消除，并且 WIFI 已经可以自动连接了。</p><h1 id=常用-apk-软件安装>常用 apk 软件安装</h1><p>我这里使用了 <a class=link href=https://kxsw.gitbook.io/tv/ target=_blank rel=noopener>https://kxsw.gitbook.io/tv/</a> 中的方法安装了 File Commands 和 Clash 软件。File Commands 可以用来管理本地的文件，甚至可以提供 HTTP Server，供远程来下载或者上传文件。<br>国内的常见应用在 Google Play Store 中并不存在，而且通过 Google Play Store 直接安装应用很可能会失败，跟使用的网络有很大关系。国内的应用我直接使用了当贝市场来安装电视应用即可。</p><h1 id=其他问题>其他问题</h1><h2 id=听不到声音>听不到声音</h2><p>在播放视频时发现听不到声音，原因是因为默认情况下使用了 hdmi0 接口来输入声音，通过 hdmi1 只能输出视频信号，没有声音。将 hdmi 线切换到 hdmi0 口后并重启系统后，声音即正常。</p><h1 id=后续>后续</h1><p>到目前为止，树莓派已经具备了完整的 Android TV 系统的功能，而且使用起来还比较稳定，这一点超出了我的预期，毕竟树莓派 5 比较新，该系统出来的时间比较短。<br>后面我计划使用新的文章来记录使用体验，以及新的折腾经历，比如：如何通过遥控器实现正常的开关机。<br>敬请期待。。。</p><h1 id=资料>资料</h1><ul><li><a class=link href=https://blog.csdn.net/u013120422/article/details/132107317 target=_blank rel=noopener>https://blog.csdn.net/u013120422/article/details/132107317</a></li><li><a class=link href=https://konstakang.com/devices/rpi5/LineageOS20-ATV/ target=_blank rel=noopener>https://konstakang.com/devices/rpi5/LineageOS20-ATV/</a></li></ul></section><footer class=article-footer></footer></article><script src=https://giscus.app/client.js data-repo=kuring/kuring.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkyODM4MzQ0NTk=" data-category=Announcements data-category-id=DIC_kwDOEOr4W84CdeTU data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=light data-lang=zh-CN data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2013 -
2025 kuring</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>