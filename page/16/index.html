<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"kuring.me","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":true,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="404频道">
<meta property="og:url" content="http://kuring.me/page/16/index.html">
<meta property="og:site_name" content="404频道">
<meta property="og:locale">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://kuring.me/page/16/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-Hans","comments":"","permalink":"","path":"page/16/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>404频道</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">404频道</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">学习笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">227</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/kuring" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kuring" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/my_makefile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/my_makefile/" class="post-title-link" itemprop="url">我的Makefile文件</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-11-23 00:00:00" itemprop="dateCreated datePublished" datetime="2014-11-23T00:00:00+00:00">2014-11-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近学习了《GNU Make项目管理》，改进了我之前一直在用的Makefile文件，解决我之前的Makefile中一直存在的修改依赖头文件后不能自动编译cpp文件的问题。本文列举了我常用的两个Makefile文件，其中第一个为我常用的Makefile，第二个为从网上找到的其他Makefile文件。</p>
<h1 id="第一个Makefile"><a href="#第一个Makefile" class="headerlink" title="第一个Makefile"></a>第一个Makefile</h1><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all:</span></span><br><span class="line">INCLUDE = -I./</span><br><span class="line"></span><br><span class="line">FLAGS = -g -Wall <span class="variable">$(INCLUDE)</span></span><br><span class="line">FLAGS += -fPIC</span><br><span class="line"></span><br><span class="line">LIBDIR = -lz -lm -lcrypto</span><br><span class="line"></span><br><span class="line">LINK = <span class="variable">$(LIBDIR)</span> -lpthread</span><br><span class="line"></span><br><span class="line">GCC = g++</span><br><span class="line"></span><br><span class="line"><span class="comment"># for C++ language</span></span><br><span class="line">CODE.cpp = main.cpp \</span><br><span class="line">			trim.cpp</span><br><span class="line"></span><br><span class="line">CPP.o = $(CODE.cpp:.cpp=.o)</span><br><span class="line">OBJS.d = $(CODE.cpp:.cpp=.d)</span><br><span class="line"></span><br><span class="line">OBJS.o = $(CPP.o)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决头文件依赖</span></span><br><span class="line"><span class="keyword">-include</span> <span class="variable">$(<span class="built_in">subst</span> .cpp,.d,$(CODE.cpp)</span>)</span><br><span class="line"></span><br><span class="line"><span class="section">%.d: %.cpp</span></span><br><span class="line">	<span class="variable">$(GCC)</span> -M <span class="variable">$(FLAGS)</span> <span class="variable">$&lt;</span> &gt; <span class="variable">$@</span>.$$$$;		\</span><br><span class="line">	sed &#x27;s,\(<span class="variable">$*</span>\)\.o[ :]*,\1.o <span class="variable">$@</span> : ,g&#x27; &lt; <span class="variable">$@</span>.$$$$ &gt; <span class="variable">$@</span>;	\</span><br><span class="line">	rm -f <span class="variable">$@</span>.$$$$</span><br><span class="line"></span><br><span class="line"><span class="comment"># rule for C++ language</span></span><br><span class="line">%.o : %.cpp	</span><br><span class="line">	<span class="variable">$(GCC)</span> <span class="variable">$(FLAGS)</span> -o <span class="variable">$@</span> -c <span class="variable">$&lt;</span>	</span><br><span class="line">	@echo <span class="variable">$*</span>.o build successfully!......</span><br><span class="line"></span><br><span class="line">TARGET = main</span><br><span class="line">	</span><br><span class="line"><span class="variable">$(TARGET)</span> : $(OBJS.o) </span><br><span class="line">	<span class="variable">$(GCC)</span> $(OBJS.o) -o <span class="variable">$(TARGET)</span> <span class="variable">$(LINK)</span></span><br><span class="line">	@echo <span class="variable">$(TARGET)</span> BUILD OK!.........</span><br><span class="line"></span><br><span class="line">all : <span class="variable">$(TARGET)</span></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>:</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -rf <span class="variable">$(TARGET)</span></span><br><span class="line">	rm -rf $(OBJS.o)</span><br><span class="line">	rm -rf $(OBJS.d)</span><br><span class="line">	rm -rf *.d</span><br></pre></td></tr></table></figure>

<p>该文件特点为需要手工将需要编译的源文件手动添加到Makefile中，可能比较麻烦，但是编译时比较灵活。可以随意修改需要编译源文件的顺序和是否需要编译源文件。</p>
<h1 id="第二个Makefile"><a href="#第二个Makefile" class="headerlink" title="第二个Makefile"></a>第二个Makefile</h1><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># KEFILE FOR C/C++ PROJECT</span></span><br><span class="line"><span class="comment"># Author: swm8023 &lt;swm8023@gmail.com&gt;</span></span><br><span class="line"><span class="comment"># Date:   2014/01/30</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">###########################################################</span></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: all clean</span></span><br><span class="line"><span class="section">all: </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># annotation when release version</span></span><br><span class="line">DEBUG       := y</span><br><span class="line">TARGET_PROG := main</span><br><span class="line"></span><br><span class="line"><span class="comment"># project directory	</span></span><br><span class="line">DEBUG_DIR   := ./Debug</span><br><span class="line">RELEASE_DIR := ./Release</span><br><span class="line">BIN_DIR     := <span class="variable">$(<span class="built_in">if</span> <span class="variable">$(DEBUG)</span>, <span class="variable">$(DEBUG_DIR)</span>, <span class="variable">$(RELEASE_DIR)</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># shell command</span></span><br><span class="line">CC    := gcc</span><br><span class="line">CXX   := g++</span><br><span class="line">RM    := rm -rf</span><br><span class="line">MKDIR := mkdir -p</span><br><span class="line">SED   := sed</span><br><span class="line">MV    := mv</span><br><span class="line"></span><br><span class="line"><span class="comment"># init sources &amp; objects &amp; depends</span></span><br><span class="line">sources_all := <span class="variable">$(<span class="built_in">shell</span> find . -name &quot;*.c&quot; -o -name &quot;*.cpp&quot; -o -name &quot;*.h&quot;)</span></span><br><span class="line">sources_c   := <span class="variable">$(<span class="built_in">filter</span> %.c, <span class="variable">$(sources_all)</span>)</span></span><br><span class="line">sources_cpp := <span class="variable">$(<span class="built_in">filter</span> %.cpp, <span class="variable">$(sources_all)</span>)</span></span><br><span class="line">sources_h   := <span class="variable">$(<span class="built_in">filter</span> %.h, <span class="variable">$(sources_all)</span>)</span></span><br><span class="line">objs        := <span class="variable">$(<span class="built_in">addprefix</span> <span class="variable">$(BIN_DIR)</span>/,$(<span class="built_in">strip</span> $(sources_cpp:.cpp=.o)</span> $(sources_c:.c=.o)))</span><br><span class="line">deps        := <span class="variable">$(<span class="built_in">addprefix</span> <span class="variable">$(BIN_DIR)</span>/,$(<span class="built_in">strip</span> $(sources_cpp:.cpp=.d)</span> $(sources_c:.c=.d)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># create directory</span></span><br><span class="line"><span class="variable">$(<span class="built_in">foreach</span> dirname,$(<span class="built_in">sort</span> $(<span class="built_in">dir</span> <span class="variable">$(sources_c)</span> <span class="variable">$(sources_cpp)</span>)</span>),\</span><br><span class="line">  <span class="variable">$(<span class="built_in">shell</span> <span class="variable">$(MKDIR)</span> <span class="variable">$(BIN_DIR)</span>/<span class="variable">$(dirname)</span>)</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># complie &amp; link variable</span></span><br><span class="line">CFLAGS     := <span class="variable">$(<span class="built_in">if</span> <span class="variable">$(DEBUG)</span>,-g -O, -O2)</span></span><br><span class="line">CFLAGS     += <span class="variable">$(<span class="built_in">addprefix</span> -I ,$(<span class="built_in">sort</span> $(<span class="built_in">dir</span> <span class="variable">$(sources_h)</span>)</span>))</span><br><span class="line">CXXFLAGS    = <span class="variable">$(CFLAGS)</span></span><br><span class="line">LDFLAGS    := </span><br><span class="line">LOADLIBES  += <span class="comment">#-L/usr/include/mysql</span></span><br><span class="line">LDLIBS     += <span class="comment">#-lpthread -lmysqlclient</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># add vpath</span></span><br><span class="line"><span class="keyword">vpath</span> %.h <span class="variable">$(<span class="built_in">sort</span> $(<span class="built_in">dir</span> <span class="variable">$(sources_h)</span>)</span>)</span><br><span class="line"><span class="keyword">vpath</span> %.c <span class="variable">$(<span class="built_in">sort</span> $(<span class="built_in">dir</span> <span class="variable">$(sources_c)</span>)</span>)</span><br><span class="line"><span class="keyword">vpath</span> %.cpp <span class="variable">$(<span class="built_in">sort</span> $(<span class="built_in">dir</span> <span class="variable">$(sources_cpp)</span>)</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate depend files</span></span><br><span class="line"><span class="comment"># actually generate after object generated, beacasue it only used when next make)</span></span><br><span class="line"><span class="keyword">ifneq</span> <span class="string">&quot;<span class="variable">$(MAKECMDGOALS)</span>&quot;</span> <span class="string">&quot;clean&quot;</span></span><br><span class="line"><span class="keyword">sinclude</span> <span class="variable">$(deps)</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># make-depend(depend-file,source-file,object-file,cc)</span></span><br><span class="line"><span class="keyword">define</span> make-depend</span><br><span class="line">  <span class="variable">$(RM)</span> $1;                                     \</span><br><span class="line">  $4 <span class="variable">$(CFLAGS)</span> -MM $2 |                         \</span><br><span class="line">  <span class="variable">$(SED)</span> &#x27;s,\(<span class="variable">$(<span class="built_in">notdir</span> $3)</span>\): ,$3: ,&#x27; &gt; $1.tmp; \</span><br><span class="line">  <span class="variable">$(SED)</span> -e &#x27;s/<span class="comment">#.*//&#x27;                           \</span></span><br><span class="line">         -e &#x27;s/^[^:]*: *//&#x27;                     \</span><br><span class="line">         -e &#x27;s/ *\\$$//&#x27;                        \</span><br><span class="line">         -e &#x27;/^$$/ d&#x27;                           \</span><br><span class="line">         -e &#x27;s/$$/ :/&#x27; &lt; $1.tmp &gt;&gt; $1.tmp;      \</span><br><span class="line">  <span class="variable">$(MV)</span> $1.tmp $1;</span><br><span class="line"><span class="keyword">endef</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># rules to generate objects file</span></span><br><span class="line"><span class="variable">$(BIN_DIR)</span>/%.o: %.c</span><br><span class="line">	@<span class="variable">$(<span class="built_in">call</span> make-depend,$(<span class="built_in">patsubst</span> %.o,%.d,<span class="variable">$@</span>)</span>,<span class="variable">$&lt;</span>,<span class="variable">$@</span>,<span class="variable">$(CC)</span>)</span><br><span class="line">	<span class="variable">$(CC)</span> <span class="variable">$(CFLAGS)</span> -o <span class="variable">$@</span> -c <span class="variable">$&lt;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(BIN_DIR)</span>/%.o: %.cpp</span><br><span class="line">	@<span class="variable">$(<span class="built_in">call</span> make-depend,$(<span class="built_in">patsubst</span> %.o,%.d,<span class="variable">$@</span>)</span>,<span class="variable">$&lt;</span>,<span class="variable">$@</span>,<span class="variable">$(CXX)</span>)</span><br><span class="line">	<span class="variable">$(CXX)</span> <span class="variable">$(CXXFLAGS)</span> -o <span class="variable">$@</span> -c <span class="variable">$&lt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># add-target(target,objs,cc)</span></span><br><span class="line"><span class="keyword">define</span> add-target</span><br><span class="line">  REAL_TARGET += <span class="variable">$(BIN_DIR)</span>/$1</span><br><span class="line">  <span class="variable">$(BIN_DIR)</span>/$1: $2</span><br><span class="line">	$3 <span class="variable">$(LDFLAGS)</span> $<span class="variable">$^</span> <span class="variable">$(LOADLIBES)</span> <span class="variable">$(LDLIBS)</span> -o $<span class="variable">$@</span></span><br><span class="line"><span class="keyword">endef</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># call add-target</span></span><br><span class="line"><span class="variable">$(<span class="built_in">foreach</span> targ,<span class="variable">$(TARGET_PROG)</span>,$(<span class="built_in">eval</span> $(<span class="built_in">call</span> add-target,<span class="variable">$(targ)</span>,<span class="variable">$(objs)</span>,<span class="variable">$(CXX)</span>)</span>))</span><br><span class="line"></span><br><span class="line"><span class="section">all: <span class="variable">$(REAL_TARGET)</span> <span class="variable">$(TARGET_LIBS)</span></span></span><br><span class="line"></span><br><span class="line"><span class="section">clean: </span></span><br><span class="line">	<span class="variable">$(RM)</span> <span class="variable">$(BIN_DIR)</span></span><br></pre></td></tr></table></figure>

<p>该Makefile为从<a target="_blank" rel="noopener" href="http://c4fun.cn/blog/2014/01/30/common-makefile/">一个通用的C&#x2F;C++ Makefile</a>中直接获得的，为了避免原博客以后不能访问的情况，这里备份一下。</p>
<p>该Makefile可以动检测Makefile所在目录及其子目录中的.c和.cpp文件，并进行编译，不需要手动修改Makefile来填写需要编译的源文件，比较自动化。</p>
<h1 id="相关参考"><a href="#相关参考" class="headerlink" title="相关参考"></a>相关参考</h1><p>第二个Makefile文件的作者博客中的两篇文章：<a target="_blank" rel="noopener" href="http://c4fun.cn/blog/2014/01/13/gnu-make-study01/">GNU Make学习总结（一）</a>和<a target="_blank" rel="noopener" href="http://c4fun.cn/blog/2014/01/13/gnu-make-study02/">GNU Make学习总结（二）</a></p>
<h1 id="相关下载"><a href="#相关下载" class="headerlink" title="相关下载"></a>相关下载</h1><p><a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1jGDo5ls">一个包含上述两个Makefile的例子</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/programming_pearls_1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/programming_pearls_1/" class="post-title-link" itemprop="url">编程珠玑读书笔记第1章开篇</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-11-23 00:00:00" itemprop="dateCreated datePublished" datetime="2014-11-23T00:00:00+00:00">2014-11-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>一个最多包含n个正整数的文件，每个数小于n，其中n为10000000。要求升序排列整数列表，最多使用1MB的内存，运行时间尽可能短。</p>
<h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><pre><code class="c++">#include &lt;stdio.h&gt;                                                                                                                                                              
#include &lt;stdlib.h&gt;

#define BITSPERWORD 32
#define SHIFT 5
#define MASK 0x1F
#define N 10000000

int a[1 + N/BITSPERWORD] = &#123;0&#125;;

/**
 * i&gt;&gt;SHIFT相当于i/32，用于确定i在第几个int数组中
 * 其中i&amp;MASK含义为i%32，用于确定在int中的第几位
 */
void set(int i)
&#123;
    a[i &gt;&gt; SHIFT] |= (1 &lt;&lt; (i &amp; MASK));
&#125;

void clr(int i)
&#123;
    a[i &gt;&gt; SHIFT] &amp;= (0 &lt;&lt; (i &amp; MASK));
&#125;

int test(int i)
&#123;
    return a[i &gt;&gt; SHIFT] &amp; (1 &lt;&lt; (i &amp; MASK));
&#125;

int main(void)
&#123;
    int i;
    while (scanf(&quot;%d&quot;, &amp;i) != EOF)
    &#123;
        set(i);
    &#125;
    for (i=0; i&lt;N; i++)
    &#123;
        if (test(i))
        &#123;
            printf(&quot;%d\n&quot;, i);
        &#125;
    &#125;
    return 0;
&#125;
</code></pre>
<h1 id="习题5"><a href="#习题5" class="headerlink" title="习题5"></a>习题5</h1><p>通过shell命令<code>echo &quot;scale=2; 10000000 / 1024 / 8 / 1024.0&quot; | bc</code>计算该程序运行时至少需要的存储空间为1.19MB，如果仅提供了1MB的存储空间，则需要更改上述程序的处理方式。</p>
<p>可采用多趟算法，多趟读入输入数据，每次完成一步。针对该题，可采用2步来完成，int数组的大小变更为5000000&#x2F;8，比之前小了一半。第一步处理0-4999999之间的数据，第二步处理5000000-999999之间的数据。</p>
<h1 id="习题6"><a href="#习题6" class="headerlink" title="习题6"></a>习题6</h1><p>如果是每个整数至少出现10次，而不是原先的一次。可以使用4bit来统计出现的次数，申请的数组大小变为了10000000&#x2F;2。只要是每个整数有出现的最多次数上限该种处理方式就合适，当然整数出现的上限不能太大，否则该算法就没有了任何优势。</p>
<h1 id="习题9"><a href="#习题9" class="headerlink" title="习题9"></a>习题9</h1><p>对一个大的数组的初始化操作需要耗费一些时间，为了消除数组的初始化，可以通过两个额外的数组来解决，这是典型的用空间换时间的方法。</p>
<pre style="font-family: Courier, monospace;">
      +---+---+---+---+---+---+---+----+
data  |   |   | 3 |   | 2 |   | 8 |    |
      +---+---+---+---+---+---+---+----+
                                        
      +---+---+---+---+---+---+---+----+
from  |   |   | 0 |   | 2 |   | 1 |    |
      +---+---+---+---+---+---+---+----+
                                        
      +---+---+---+---+---+---+---+----+
to    | 1 | 5 | 3 |   |   |   |   |    |
      +---+---+---+---+---+---+---+----+
                                        
                    ^                   
                    +                   
                   top                  
</pre>

<p>上图中data为要初始化的数组，from和to为辅助数组。如果data[i]已经初始化，则from[i]&lt;top，to[from[i]]&#x3D;i。from是一个简单的标识，to和top确保了from中不会写入内存中的随机内容。</p>
<h1 id="习题11"><a href="#习题11" class="headerlink" title="习题11"></a>习题11</h1><p>该题的答案太他妈逗了，为了能够解决两地之间的数据传输瓶颈，作者给出的答案居然是用信鸽传输图片的底片后再将底片放大的方式来代替原先的用汽车运输的方式，这就是中国古代的飞鸽传书啊。</p>
<h1 id="习题12"><a href="#习题12" class="headerlink" title="习题12"></a>习题12</h1><p>该题在《三傻大闹宝莱坞》中见过，这跟编程毛线关系也没有啊。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/http_range/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/http_range/" class="post-title-link" itemprop="url">一个实例讲解HTTP的断点续传</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-11-06 00:00:00" itemprop="dateCreated datePublished" datetime="2014-11-06T00:00:00+00:00">2014-11-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本文以从服务器下载一个文件为例，讲解HTTP的断点续传功能。</p>
<p>客户端IP地址为：192.168.1.2<br>服务器IP地址为：192.168.1.3</p>
<h1 id="客户端向服务器发送请求"><a href="#客户端向服务器发送请求" class="headerlink" title="客户端向服务器发送请求"></a>客户端向服务器发送请求</h1><p>客户端向服务器发送的请求为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /deepc.a HTTP/1.1</span><br><span class="line">Host: 192.168.100.189</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.14 Safari/537.36</span><br><span class="line">Accept-Encoding: gzip,deflate,sdch</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en;q=0.6</span><br></pre></td></tr></table></figure>

<p>从中可以看出请求的文件名为deepc.a文件。</p>
<h1 id="客户端向服务器发送具体请求"><a href="#客户端向服务器发送具体请求" class="headerlink" title="客户端向服务器发送具体请求"></a>客户端向服务器发送具体请求</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET /deepc.a HTTP/1.1</span><br><span class="line">Host: 192.168.100.189</span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.14 Safari/537.36</span><br><span class="line">Accept: */*</span><br><span class="line">Referer: http://192.168.100.189/deepc.a</span><br><span class="line">Accept-Encoding: gzip,deflate,sdch</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en;q=0.6</span><br><span class="line">Range: bytes=0-32767</span><br></pre></td></tr></table></figure>

<p>Range字段表示请求文件的范围为0-32767。</p>
<h1 id="服务器响应"><a href="#服务器响应" class="headerlink" title="服务器响应"></a>服务器响应</h1><p>第一次服务器的HTTP响应报文如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">GET /deepc.a HTTP/1.1</span><br><span class="line">Host: 192.168.1.3</span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.14 Safari/537.36</span><br><span class="line">Accept: */*</span><br><span class="line">Referer: http://192.168.1.3/deepc.a</span><br><span class="line">Accept-Encoding: gzip,deflate,sdch</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en;q=0.6</span><br><span class="line">Range: bytes=0-32767</span><br><span class="line"></span><br><span class="line">HTTP/1.1 206 Partial Content</span><br><span class="line">Date: Sun, 04 May 2014 05:14:54 GMT</span><br><span class="line">Server: Apache/2.4.4 (Win32) PHP/5.4.16</span><br><span class="line">Last-Modified: Sat, 03 May 2014 00:43:22 GMT</span><br><span class="line">ETag: &quot;7efce6-4f8742f6ed9b2&quot;</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 32768</span><br><span class="line">Content-Range: bytes 0-32767/8322278</span><br><span class="line">Keep-Alive: timeout=5, max=100</span><br><span class="line">Connection: Keep-Alive</span><br></pre></td></tr></table></figure>

<p>HTTP的状态为206，表示服务器已经处理了部分HTTP相应。其中Content-Range字段表示服务器已经响应了0-32767个字节的文件内容。8322278表示文件的总长度为8322278字节。</p>
<h1 id="客户端继续向服务器发送请求"><a href="#客户端继续向服务器发送请求" class="headerlink" title="客户端继续向服务器发送请求"></a>客户端继续向服务器发送请求</h1><p>客户端根据上次HTTP报文中服务器已经返回给的客户端的数据情况继续向服务器发送请求报文，向服务器发送的请求报文内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">GET /deepc.a HTTP/1.1</span><br><span class="line">Host: 192.168.100.189</span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.14 Safari/537.36</span><br><span class="line">Accept: */*</span><br><span class="line">Referer: http://192.168.100.189/deepc.a</span><br><span class="line">Accept-Encoding: gzip,deflate,sdch</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en;q=0.6</span><br><span class="line">Range: bytes=32768-8322277</span><br><span class="line">If-Range: &quot;7efce6-4f8742f6ed9b2&quot;</span><br><span class="line"></span><br><span class="line">HTTP/1.1 206 Partial Content</span><br><span class="line">Date: Sun, 04 May 2014 05:14:54 GMT</span><br><span class="line">Server: Apache/2.4.4 (Win32) PHP/5.4.16</span><br><span class="line">Last-Modified: Sat, 03 May 2014 00:43:22 GMT</span><br><span class="line">ETag: &quot;7efce6-4f8742f6ed9b2&quot;</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 8289510</span><br><span class="line">Content-Range: bytes 32768-8322277/8322278</span><br><span class="line">Keep-Alive: timeout=5, max=98</span><br><span class="line">Connection: Keep-Alive</span><br></pre></td></tr></table></figure>

<p>Content-Range的内容表示客户端向服务器请求文件中32768-8322277之间的字节数据。</p>
<h1 id="第二次服务器的HTTP响应报文如下："><a href="#第二次服务器的HTTP响应报文如下：" class="headerlink" title="第二次服务器的HTTP响应报文如下："></a>第二次服务器的HTTP响应报文如下：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 206 Partial Content</span><br><span class="line">Date: Sun, 04 May 2014 05:14:54 GMT</span><br><span class="line">Server: Apache/2.4.4 (Win32) PHP/5.4.16</span><br><span class="line">Last-Modified: Sat, 03 May 2014 00:43:22 GMT</span><br><span class="line">ETag: &quot;7efce6-4f8742f6ed9b2&quot;</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 8289510</span><br><span class="line">Content-Range: bytes 32768-8322277/8322278</span><br><span class="line">Keep-Alive: timeout=5, max=98</span><br><span class="line">Connection: Keep-Alive</span><br></pre></td></tr></table></figure>

<p>表示服务器已经相应完成了32768-8322277之间的数据。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/linux_listen_shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/linux_listen_shell/" class="post-title-link" itemprop="url">一个Linux下的监听脚本程序</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-11-06 00:00:00" itemprop="dateCreated datePublished" datetime="2014-11-06T00:00:00+00:00">2014-11-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>为了避免linux下的控制台程序A死掉，可以通过一个另外一个程序B来监听A程序，当A程序异常退出时将B程序带起来。当然程序设计的最好方式为程序不崩溃，但是程序中存在bug很难避免，该方法还是有一定的实践意义。对于B程序可以通过shell脚本或者单独一个应用程序来解决。本文将通过shell脚本来解决此问题。</p>
<h1 id="shell脚本的内容"><a href="#shell脚本的内容" class="headerlink" title="shell脚本的内容"></a>shell脚本的内容</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">check_process()</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta prompt_">	# </span><span class="language-bash">check parameter</span></span><br><span class="line">	if [ $1 = &quot;&quot; ];</span><br><span class="line">	then</span><br><span class="line">		return -1</span><br><span class="line">	fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">	# </span><span class="language-bash">get the running process</span></span><br><span class="line">	process_names=$(ps -ef | grep $1 | grep -v grep | awk &#x27;&#123;print $8&#125;&#x27;)</span><br><span class="line">	for process_name in $process_names</span><br><span class="line">	do</span><br><span class="line">		if [ $process_name = $1 ] ;</span><br><span class="line">		then</span><br><span class="line">			return 1</span><br><span class="line">		fi</span><br><span class="line">	done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">	# </span><span class="language-bash">not run and run the process</span></span><br><span class="line">	echo &quot;$(date) : process $1 not run, just run it&quot;</span><br><span class="line"><span class="meta prompt_">	$</span><span class="language-bash">1</span></span><br><span class="line">	return 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">while [ 1 ];do</span><br><span class="line">	check_process &quot;/usr/bin/app/process&quot;	# programe path</span><br><span class="line">	sleep 5</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h1 id="将shell脚本在脱离控制台下可以运行"><a href="#将shell脚本在脱离控制台下可以运行" class="headerlink" title="将shell脚本在脱离控制台下可以运行"></a>将shell脚本在脱离控制台下可以运行</h1><p>一旦断开了控制台，shell脚本就会由于接收到SIGHUP信号而退出。这里有两种思路来解决该问题，一种是通过系统的crontab来定期调用脚本程序，另外一种是通过神奇的screen程序来解决该问题，我这里通过screen程序来解决该问题，具体screen程序的应用见我的另外一篇文章《》。</p>
<h1 id="应用程序为daemon方式运行"><a href="#应用程序为daemon方式运行" class="headerlink" title="应用程序为daemon方式运行"></a>应用程序为daemon方式运行</h1><p>为了能够保证该脚本监控多个应用程序，需要将应用程序设置为daemon方式运行，可以调用函数daemon实现。也可以调用单独实现的daemon函数，具体代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">void init_daemon(void) </span><br><span class="line">&#123; </span><br><span class="line">    int pid; </span><br><span class="line">    int i;  </span><br><span class="line"></span><br><span class="line">    if(pid=fork()) </span><br><span class="line">        exit(0);//是父进程，结束父进程 </span><br><span class="line">    else if(pid&lt; 0)  </span><br><span class="line">        exit(1);//fork失败，退出 </span><br><span class="line">    //是第一子进程，后台继续执行 </span><br><span class="line"></span><br><span class="line">    setsid();//第一子进程成为新的会话组长和进程组长 </span><br><span class="line">    //并与控制终端分离 </span><br><span class="line">    if(pid=fork()) </span><br><span class="line">        exit(0);//是第一子进程，结束第一子进程 </span><br><span class="line">    else if(pid&lt; 0)  </span><br><span class="line">        exit(1);//fork失败，退出 </span><br><span class="line">    //是第二子进程，继续 </span><br><span class="line">    //第二子进程不再是会话组长 </span><br><span class="line"></span><br><span class="line">    for(i=0;i&lt; NOFILE;++i)//关闭打开的文件描述符 </span><br><span class="line">        close(i); </span><br><span class="line">    chdir(&quot;/tmp&quot;);//改变工作目录到/tmp </span><br><span class="line">    umask(0);//重设文件创建掩模 </span><br><span class="line">    return; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/github_fork_sync/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/github_fork_sync/" class="post-title-link" itemprop="url">在github上同步fork的项目</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-11-02 00:00:00" itemprop="dateCreated datePublished" datetime="2014-11-02T00:00:00+00:00">2014-11-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在github上可以fork别人的项目成为自己的项目，但是当fork的项目更新后自己fork的项目应该怎么怎么更新呢？我从网上看到了两种方式，一种是采用github的web界面中的操作来实现，具体是通过“Pull Request”功能来实现；另外一种是通过在本地合并代码分支的方式来解决。本文将采用第二种方式，以我最近fork的项目为例来说明。</p>
<h1 id="将fork后自己的项目clone到本地"><a href="#将fork后自己的项目clone到本地" class="headerlink" title="将fork后自己的项目clone到本地"></a>将fork后自己的项目clone到本地</h1><p>执行<code>git clone https://github.com/kuring/leetcode.git</code>即可将自己fork的代码更新到本地。</p>
<p>fork完成后的远程分支和所有分支情况如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kuring@T420:/data/git/leetcode$ git remote -v</span><br><span class="line">origin	https://github.com/kuring/leetcode.git (fetch)</span><br><span class="line">origin	https://github.com/kuring/leetcode.git (push)</span><br><span class="line">kuring@T420:/data/git/leetcode$ git branch -a</span><br><span class="line">* master</span><br><span class="line">  remotes/origin/HEAD -&gt; origin/master</span><br><span class="line">  remotes/origin/master</span><br></pre></td></tr></table></figure>

<h1 id="将fork之前的项目clone到本地"><a href="#将fork之前的项目clone到本地" class="headerlink" title="将fork之前的项目clone到本地"></a>将fork之前的项目clone到本地</h1><p>将fork之前的项目添加到本地的远程分支haoel中，执行<code>git remote add haoel https://github.com/haoel/leetcode</code>。</p>
<p>再查看一下远程分支和所有分支情况：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kuring@T420:/data/git/leetcode$ git remote -v</span><br><span class="line">haoel	https://github.com/haoel/leetcode (fetch)</span><br><span class="line">haoel	https://github.com/haoel/leetcode (push)</span><br><span class="line">origin	https://github.com/kuring/leetcode.git (fetch)</span><br><span class="line">origin	https://github.com/kuring/leetcode.git (push)</span><br><span class="line">kuring@T420:/data/git/leetcode$ git branch -a</span><br><span class="line">* master</span><br><span class="line">  remotes/origin/HEAD -&gt; origin/master</span><br><span class="line">  remotes/origin/master</span><br></pre></td></tr></table></figure>

<h1 id="将远程代码halel分支fetch到本地"><a href="#将远程代码halel分支fetch到本地" class="headerlink" title="将远程代码halel分支fetch到本地"></a>将远程代码halel分支fetch到本地</h1><p>执行<code>git fetch haoel</code>，此时的所有分支情况如下，可以看出多了一个remotes&#x2F;haoel&#x2F;master分支。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kuring@T420:/data/git/leetcode$ git branch -a</span><br><span class="line">* master</span><br><span class="line">  remotes/haoel/master</span><br><span class="line">  remotes/origin/HEAD -&gt; origin/master</span><br><span class="line">  remotes/origin/master</span><br></pre></td></tr></table></figure>

<h1 id="将halel分支merge到本地的分支"><a href="#将halel分支merge到本地的分支" class="headerlink" title="将halel分支merge到本地的分支"></a>将halel分支merge到本地的分支</h1><p>执行<code>git merge remotes/haoel/master</code>，此时发现有冲突，提示内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uring@T420:/data/git/leetcode$ git merge haoel/master</span><br><span class="line">自动合并 src/reverseInteger/reverseInteger.cpp</span><br><span class="line">冲突（内容）：合并冲突于 src/reverseInteger/reverseInteger.cpp</span><br><span class="line">自动合并失败，修正冲突然后提交修正的结果。</span><br></pre></td></tr></table></figure>

<p>之所以出现上述错误，这是由于我在fork之后在本地修正了源代码中的一处bug，而在fork之后到现在的时间间隔内原作者haoel也正好修正了该bug。打开文件后发现存在如下的内容，其实就是代码风格的问题，我这里将错误进行修正。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">36 &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD                                                                                                                                                                </span><br><span class="line">37     while( x != 0 )&#123;</span><br><span class="line">38 =======</span><br><span class="line">39     while( x != 0)&#123;</span><br><span class="line">40 &gt;&gt;&gt;&gt;&gt;&gt;&gt; haoel/master</span><br></pre></td></tr></table></figure>

<p>如果没有冲突的情况下通过merge命令即会将haoel&#x2F;master分支合并master分支并执行commit操作。可以通过<code>git status</code>命令看到当前冲突的文件和已经修改的文件。执行<code>git status</code>命令可以看到如下内容，说明未冲突的文件已经在暂存区，冲突的文件需要修改后执行add操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">kuring@T420:/data/git/leetcode$ git status</span><br><span class="line">位于分支 master</span><br><span class="line">您的分支与上游分支 &#x27;origin/master&#x27; 一致。</span><br><span class="line"></span><br><span class="line">您有尚未合并的路径。</span><br><span class="line">  （解决冲突并运行 &quot;git commit&quot;）</span><br><span class="line"></span><br><span class="line">要提交的变更：</span><br><span class="line"></span><br><span class="line">	修改:         src/3Sum/3Sum.cpp</span><br><span class="line">	修改:         src/4Sum/4Sum.cpp</span><br><span class="line">	修改:         src/LRUCache/LRUCache.cpp</span><br><span class="line">	......	// 此处省略了很多重复的</span><br><span class="line">	......</span><br><span class="line"></span><br><span class="line">未合并的路径：</span><br><span class="line">  （使用 &quot;git add &lt;file&gt;...&quot; 标记解决方案）</span><br><span class="line"></span><br><span class="line">	双方修改：     src/reverseInteger/reverseInteger.cpp</span><br></pre></td></tr></table></figure>

<p>解决完冲突后执行add操作后再通过<code>git status</code>命令查看的内容如下。通过<code>git status</code>命令却看不到已经解决的冲突文件，对于这一点我还是很理解，参考文章中的<a target="_blank" rel="noopener" href="http://git-scm.com/book/zh/v1/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6">Git 分支 - 分支的新建与合并</a>是可以看到已经解决的冲突文件的，因为执行<code>git add</code>后将解决完成冲突的文件放到了暂存区中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kuring@T420:/data/git/leetcode$ git status</span><br><span class="line">位于分支 master</span><br><span class="line">您的分支与上游分支 &#x27;origin/master&#x27; 一致。</span><br><span class="line"></span><br><span class="line">所有冲突已解决但您仍处于合并中。</span><br><span class="line">  （使用 &quot;git commit&quot; 结束合并）</span><br><span class="line"></span><br><span class="line">要提交的变更：</span><br><span class="line"></span><br><span class="line">	修改:         src/3Sum/3Sum.cpp</span><br><span class="line">	修改:         src/4Sum/4Sum.cpp</span><br><span class="line">	修改:         src/LRUCache/LRUCache.cpp</span><br><span class="line">	......	// 此处省略了很多重复的</span><br><span class="line">	......</span><br></pre></td></tr></table></figure>

<p>这里冲突后merge操作并没有执行commit操作，需要解决冲突后再手工执行commit操作，此时整个的同步操作就已经完成了。</p>
<h1 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h1><p>如果隔一段时间后又需要同步项目了仅需要执行<code>git fetch haoel</code>命令以下的操作即可。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a target="_blank" rel="noopener" href="http://git-scm.com/book/zh/v1/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6">Git 分支 - 分支的新建与合并</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/rubylouvre/archive/2013/01/24/2874694.html">如何在github上fork一个项目来贡献代码以及同步原作者的修改</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/do_it__/article/details/7836513">Github上更新自己fork的代码</a></li>
</ul>
<p>由于git命令较多，为了便于查阅增加一处git data transprot commands</p>
<p><img src="http://kuring.qiniudn.com/git_data_transport_commands.png" alt="Git图解"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/leetcode_unique_binary_search_trees_ii/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/leetcode_unique_binary_search_trees_ii/" class="post-title-link" itemprop="url">Unique Binary Search Trees II</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-09-29 00:00:00" itemprop="dateCreated datePublished" datetime="2014-09-29T00:00:00+00:00">2014-09-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>Given n, generate all structurally unique BST’s (binary search trees) that store values 1…n.</p>
<p>For example,<br>Given n &#x3D; 3, your program should return all 5 unique BST’s shown below.</p>
<pre style="font-family: Courier, monospace;">
   1         3     3      2      1
    \       /     /      / \      \
     3     2     1      1   3      2
    /     /       \                 \
   2     1         2                 3
</pre>

<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p>要想能够生成多个树并存储到vector中，最容易想到的就是递归算法。要想能够递归，题目中提供的函数仅有一个参数，结合题目不能够完成递归的条件，考虑到unique binary search trees中的解法，需要递归具有两个参数的函数。</p>
<p>考虑到了递归的问题，还需要利用循环不断将树添加到vector中，这编写起来也是比较有难度，需要掌握循环的次数和什么时候将树添加到vector中。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;TreeNode *&gt; <span class="title">generateTrees</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	vector&lt;TreeNode *&gt; sub_tree = <span class="built_in">generateTrees</span>(<span class="number">1</span>, n);</span><br><span class="line">	<span class="keyword">return</span> sub_tree;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;TreeNode *&gt; <span class="title">generateTrees</span><span class="params">(<span class="type">int</span> low, <span class="type">int</span> high)</span> </span>&#123;</span><br><span class="line">	vector&lt;TreeNode *&gt; result;</span><br><span class="line">	<span class="keyword">if</span> (low &gt; high)</span><br><span class="line">	&#123;</span><br><span class="line">		result.<span class="built_in">push_back</span>(<span class="literal">NULL</span>);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (low == high)</span><br><span class="line">	&#123;</span><br><span class="line">		TreeNode *node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(low);</span><br><span class="line">		result.<span class="built_in">push_back</span>(node);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i=low; i&lt;=high; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		vector&lt;TreeNode *&gt; left = <span class="built_in">generateTrees</span>(low, i - <span class="number">1</span>);</span><br><span class="line">		vector&lt;TreeNode *&gt; right = <span class="built_in">generateTrees</span>(i + <span class="number">1</span>, high);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>; j&lt;left.<span class="built_in">size</span>(); j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> k=<span class="number">0</span>; k&lt;right.<span class="built_in">size</span>(); k++)</span><br><span class="line">			&#123;</span><br><span class="line">				TreeNode *root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(i);</span><br><span class="line">				root-&gt;left = left[j];</span><br><span class="line">				root-&gt;right = right[k];</span><br><span class="line">				result.<span class="built_in">push_back</span>(root);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/traverse_graph/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/traverse_graph/" class="post-title-link" itemprop="url">图的存储和遍历</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-09-28 00:00:00" itemprop="dateCreated datePublished" datetime="2014-09-28T00:00:00+00:00">2014-09-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="图的存储"><a href="#图的存储" class="headerlink" title="图的存储"></a>图的存储</h1><p>在leetcode中图的存储形式如下，这种形式的图只能适合用来存储是连通图的情况，且根据leetcode提供的_{0,1,2#1,2#2,2}_格式的字符串通过程序来自动构造图比较麻烦，预知字符串的含义请移步到<a target="_blank" rel="noopener" href="https://oj.leetcode.com/problems/clone-graph/">leetcode的解释</a>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for undirected graph.</span></span><br><span class="line"><span class="comment"> * struct UndirectedGraphNode &#123;</span></span><br><span class="line"><span class="comment"> *     int label;</span></span><br><span class="line"><span class="comment"> *     vector&lt;UndirectedGraphNode *&gt; neighbors;</span></span><br><span class="line"><span class="comment"> *     UndirectedGraphNode(int x) : label(x) &#123;&#125;;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br></pre></td></tr></table></figure>

<p>本文为了能够用字符串表示所有图，并且便于程序的构造，使用了邻接表的形式来对图进行存储，即可以用来存储有向图，有可以存储无向图。图一个节点的结构如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 图节点的邻接表表示形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">GraphNode</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> label;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;GraphNode *&gt; neighbors;</span><br><span class="line">    <span class="type">bool</span> visited;			<span class="comment">// 深度优先搜索和广度优先搜索的遍历都需要visited数组，为了简化程序，直接在节点的存储结构中设置visited变量</span></span><br><span class="line">    GraphNode(<span class="built_in">std</span>::<span class="built_in">string</span> x) : label(x), visited(<span class="literal">false</span>) &#123;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>图的创建方面为了简化算法实现，对程序的效率没做太多关注，算法复杂度稍高。本算法的难点在于对字符串的拆解，并根据字符串找到对应的节点指针。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 图节点的邻接表表示形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GraphNode</span> &#123;</span><br><span class="line">    std::string label;</span><br><span class="line">    std::vector&lt;GraphNode *&gt; neighbors;</span><br><span class="line">    <span class="type">bool</span> visited;</span><br><span class="line">    <span class="built_in">GraphNode</span>(std::string x) : <span class="built_in">label</span>(x), <span class="built_in">visited</span>(<span class="literal">false</span>) &#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过字符串的值，找到该字符串对应的图节点</span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function">GraphNode *<span class="title">get_one_node</span><span class="params">(<span class="type">const</span> std::vector&lt;GraphNode *&gt; &amp;node_vector, std::string str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::const_iterator iter = node_vector.<span class="built_in">begin</span>(); iter != node_vector.<span class="built_in">end</span>(); iter++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ((*iter)-&gt;label == str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> *iter;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 时间复杂度高,对图的构建一般效率要求较低</span></span><br><span class="line"><span class="comment"> * 对于查找某个节点的邻接点的指针操作可以使用map来提高查询效率</span></span><br><span class="line"><span class="comment"> * 或者可以通过不需要初始化所有节点的方式来构造图，而是采用需要哪个节点构造哪个节点的方式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">std::vector&lt;GraphNode *&gt; <span class="title">create_graph</span><span class="params">(std::string str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::vector&lt;GraphNode *&gt; node_vector;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// init all nodes</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> pos = <span class="number">0</span>; pos &lt; str.<span class="built_in">length</span>() - <span class="number">1</span>;)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">size_t</span> end = str.<span class="built_in">find</span>(<span class="string">&#x27;,&#x27;</span>, pos);</span><br><span class="line">        <span class="keyword">if</span> (end != std::string::npos)</span><br><span class="line">        &#123;</span><br><span class="line">            GraphNode *node = <span class="keyword">new</span> <span class="built_in">GraphNode</span>(str.<span class="built_in">substr</span>(pos, end - pos));</span><br><span class="line">            node_vector.<span class="built_in">push_back</span>(node);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        pos = str.<span class="built_in">find</span>(<span class="string">&#x27;#&#x27;</span>, pos);</span><br><span class="line">        <span class="keyword">if</span> (pos == std::string::npos)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            pos++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add neighbors in every node</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> pos = <span class="number">0</span>; pos &lt; str.<span class="built_in">length</span>() - <span class="number">1</span>; )</span><br><span class="line">    &#123;</span><br><span class="line">        GraphNode *current_node = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="type">size_t</span> current_end = str.<span class="built_in">find</span>(<span class="string">&#x27;,&#x27;</span>, pos);</span><br><span class="line">        <span class="keyword">if</span> (current_end != std::string::npos)</span><br><span class="line">        &#123;</span><br><span class="line">            current_node = <span class="built_in">get_one_node</span>(node_vector, str.<span class="built_in">substr</span>(pos, current_end - pos));</span><br><span class="line">            pos = current_end + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">size_t</span> node_end = str.<span class="built_in">find</span>(<span class="string">&#x27;#&#x27;</span>, pos);   <span class="comment">// 当前节点的字符串的结束位置</span></span><br><span class="line">        <span class="keyword">if</span> (node_end == std::string::npos)</span><br><span class="line">        &#123;</span><br><span class="line">            node_end = str.<span class="built_in">length</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            node_end--;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ( ; ; )</span><br><span class="line">        &#123;</span><br><span class="line">            current_end = str.<span class="built_in">find</span>(<span class="string">&#x27;,&#x27;</span>, pos);</span><br><span class="line">            <span class="keyword">if</span> (current_end &gt; node_end || current_end == std::string::npos)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 一个节点的最后一个邻接点</span></span><br><span class="line">                current_end = node_end;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                current_end--;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            GraphNode *node = <span class="built_in">get_one_node</span>(node_vector, str.<span class="built_in">substr</span>(pos, current_end - pos + <span class="number">1</span>)); </span><br><span class="line">            <span class="keyword">if</span> (node != <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                current_node-&gt;neighbors.<span class="built_in">push_back</span>(node);</span><br><span class="line">                std::cout &lt;&lt; current_node-&gt;label &lt;&lt; <span class="string">&quot; add &quot;</span> &lt;&lt; node-&gt;label &lt;&lt; std::endl;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (current_end == node_end)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 一个节点的最后一个邻接点</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                pos = current_end + <span class="number">2</span>;  <span class="comment">// 该节点之后还有其他邻接点</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        pos = node_end + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> node_vector;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="深度优先搜索"><a href="#深度优先搜索" class="headerlink" title="深度优先搜索"></a>深度优先搜索</h1><p>深度优先搜索遵循贪心算法的原理，如果孩子节点不为空，则一直遍历下去。</p>
<h2 id="递归算法"><a href="#递归算法" class="headerlink" title="递归算法"></a>递归算法</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">DFS_traverse_recursion</span><span class="params">(GraphNode *node)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!node-&gt;visited)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; node-&gt;label &lt;&lt; <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line">        node-&gt;visited = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::iterator iter = node-&gt;neighbors.<span class="built_in">begin</span>(); iter != node-&gt;neighbors.<span class="built_in">end</span>(); iter++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(*iter)-&gt;visited)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">DFS_traverse_recursion</span>(*iter);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 图的深度优先搜索的递归形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DFS_traverse_recursion</span><span class="params">(std::vector&lt;GraphNode *&gt; &amp;graph)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::iterator iter = graph.<span class="built_in">begin</span>(); iter != graph.<span class="built_in">end</span>(); iter++)</span><br><span class="line">    &#123;</span><br><span class="line">        (*iter)-&gt;visited = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::iterator iter = graph.<span class="built_in">begin</span>(); iter != graph.<span class="built_in">end</span>(); iter++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(*iter)-&gt;visited)</span><br><span class="line">            <span class="built_in">DFS_traverse_recursion</span>(*iter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="非递归算法"><a href="#非递归算法" class="headerlink" title="非递归算法"></a>非递归算法</h2><p>使用栈来实现非递归。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 图的深度优先搜索的非递归形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DFS_traverse_not_recursion</span><span class="params">(std::vector&lt;GraphNode *&gt; &amp;graph)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::iterator iter = graph.<span class="built_in">begin</span>(); iter != graph.<span class="built_in">end</span>(); iter++)</span><br><span class="line">    &#123;</span><br><span class="line">        (*iter)-&gt;visited = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::iterator iter = graph.<span class="built_in">begin</span>(); iter != graph.<span class="built_in">end</span>(); iter++)</span><br><span class="line">    &#123;</span><br><span class="line">        std::stack&lt;GraphNode *&gt; node_stack;</span><br><span class="line">        <span class="keyword">if</span> ((*iter)-&gt;visited)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        node_stack.<span class="built_in">push</span>(*iter);</span><br><span class="line">        <span class="keyword">while</span> (!node_stack.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            GraphNode *node = node_stack.<span class="built_in">top</span>();</span><br><span class="line">            node_stack.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (node-&gt;visited)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            std::cout &lt;&lt; node-&gt;label &lt;&lt; <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line">            node-&gt;visited = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">/* 使用反向迭代器遍历后将节点加入到栈中 */</span></span><br><span class="line">            <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::reverse_iterator iter2 = node-&gt;neighbors.<span class="built_in">rbegin</span>(); iter2 != node-&gt;neighbors.<span class="built_in">rend</span>(); iter2++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!(*iter2)-&gt;visited)</span><br><span class="line">                &#123;</span><br><span class="line">                    node_stack.<span class="built_in">push</span>(*iter2);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="广度优先搜索"><a href="#广度优先搜索" class="headerlink" title="广度优先搜索"></a>广度优先搜索</h1><p>该算法不存在递归算法，仅有非递归版本。需要利用队列来保存需要遍历的节点，占用的存储空间稍多。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 图的广度优先搜索的非递归形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BFS_traverse_not_recursion</span><span class="params">(std::vector&lt;GraphNode *&gt; &amp;graph)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::iterator iter = graph.<span class="built_in">begin</span>(); iter != graph.<span class="built_in">end</span>(); iter++)</span><br><span class="line">    &#123;</span><br><span class="line">        (*iter)-&gt;visited = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::iterator iter = graph.<span class="built_in">begin</span>(); iter != graph.<span class="built_in">end</span>(); iter++)</span><br><span class="line">    &#123;</span><br><span class="line">        std::queue&lt;GraphNode *&gt; node_queue;</span><br><span class="line">        <span class="keyword">if</span> ((*iter)-&gt;visited)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        node_queue.<span class="built_in">push</span>(*iter);</span><br><span class="line">        <span class="keyword">while</span> (!node_queue.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            GraphNode *node = node_queue.<span class="built_in">front</span>();</span><br><span class="line">            node_queue.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (node-&gt;visited)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            std::cout &lt;&lt; node-&gt;label &lt;&lt; <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line">            node-&gt;visited = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (std::vector&lt;GraphNode *&gt;::iterator iter2 = node-&gt;neighbors.<span class="built_in">begin</span>(); iter2 != node-&gt;neighbors.<span class="built_in">end</span>(); iter2++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!(*iter2)-&gt;visited)</span><br><span class="line">                &#123;</span><br><span class="line">                    node_queue.<span class="built_in">push</span>(*iter2);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="相关下载"><a href="#相关下载" class="headerlink" title="相关下载"></a>相关下载</h1><p><a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1i3GIj9V">本文相关源码</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/traverse_tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/traverse_tree/" class="post-title-link" itemprop="url">二叉树的遍历</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-09-28 00:00:00" itemprop="dateCreated datePublished" datetime="2014-09-28T00:00:00+00:00">2014-09-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>[TOC]</p>
<p>近期准备复习数据结构和算法的知识，参照了网络上各路大神的学习攻略，大部分算法学习的思路为参照一些经典书籍（如算法导论）并结合一些代码的实践来完成，并未找到一条适合我的算法学习之路。经过思考后决定采用代码编写曾经的教科书中代码实例的方式来学习，曾经接触的算法教科书包括《数据结构（C语言版）》和《计算机算法基础》。一来这些算法已经基本熟悉，只是时间久远有些已经忘记；二来，通过思考后编写代码增强自己的记忆。</p>
<p>同时我编写的这些实例可以作为leetcode上的很多题目的基础，为下一个阶段刷leetcode上的题目打好基础。</p>
<p>树的存储形式包括了顺序存储（采用数组形式）和链式存储，其中链式存储更为灵活，可以表示任意形式的树，本文中的代码将采用树的链式存储方式。</p>
<h1 id="树的构建"><a href="#树的构建" class="headerlink" title="树的构建"></a>树的构建</h1><p>树的构建有多种方式，本文使用字符串采用了自顶向下、自左到右的顺序构建树，跟leetcode的形式一致。其中’#’表示该节点为空，如果该节点为空节点，其左右子孩子节点也要用’#’表示，而不能不用任何字符表示。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 二叉树的链式存储结构</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> data;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">TreeNode</span> *left;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">TreeNode</span> *right;</span><br><span class="line">    <span class="built_in">TreeNode</span>(<span class="type">char</span> data) : <span class="built_in">data</span>(data), <span class="built_in">left</span>(<span class="literal">NULL</span>), <span class="built_in">right</span>(<span class="literal">NULL</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 构造二叉树，要构造的字符串采用了自顶向下、自左到右的顺序，跟leetcode的形式一致</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">TreeNode *<span class="title">create_binary_tree</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!str || <span class="built_in">strlen</span>(str) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对每个节点分配存储空间</span></span><br><span class="line">    <span class="type">int</span> node_size = <span class="built_in">strlen</span>(str);</span><br><span class="line">    TreeNode **tree = <span class="keyword">new</span> TreeNode*[node_size];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;node_size; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (str[i] == <span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            tree[i] = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tree[i] = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(str[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>, j=<span class="number">0</span>; i&lt;node_size &amp;&amp; j&lt;node_size; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (tree[i] != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((j + <span class="number">1</span>) &lt; node_size)</span><br><span class="line">            &#123;</span><br><span class="line">                tree[i]-&gt;left = tree[++j];</span><br><span class="line">                tree[i]-&gt;right = tree[++j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            j += <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="二叉树的先序遍历"><a href="#二叉树的先序遍历" class="headerlink" title="二叉树的先序遍历"></a>二叉树的先序遍历</h1><h2 id="递归实现"><a href="#递归实现" class="headerlink" title="递归实现"></a>递归实现</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 先序遍历二叉树的递归形式</span><br><span class="line"> */</span><br><span class="line">void preorder_traverse_recursion(TreeNode *root)</span><br><span class="line">&#123;</span><br><span class="line">    if (!root)</span><br><span class="line">    &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    printf(&quot;%c\t&quot;, root-&gt;data);</span><br><span class="line">    </span><br><span class="line">    preorder_traverse_recursion(root-&gt;left);</span><br><span class="line"></span><br><span class="line">    preorder_traverse_recursion(root-&gt;right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="非递归实现"><a href="#非递归实现" class="headerlink" title="非递归实现"></a>非递归实现</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 先序遍历的非递归形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">preorder_traverse_not_recursion</span><span class="params">(TreeNode *root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    std::stack&lt;TreeNode *&gt; tree_stack;</span><br><span class="line">    tree_stack.<span class="built_in">push</span>(root);</span><br><span class="line">    <span class="keyword">while</span> (tree_stack.<span class="built_in">size</span>() &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        TreeNode *node = tree_stack.<span class="built_in">top</span>();</span><br><span class="line">        tree_stack.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c\t&quot;</span>, node-&gt;data);</span><br><span class="line">        <span class="keyword">if</span> (node-&gt;right != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            tree_stack.<span class="built_in">push</span>(node-&gt;right);   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (node-&gt;left != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            tree_stack.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="二叉树的中序遍历"><a href="#二叉树的中序遍历" class="headerlink" title="二叉树的中序遍历"></a>二叉树的中序遍历</h1><h2 id="递归实现-1"><a href="#递归实现-1" class="headerlink" title="递归实现"></a>递归实现</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 中序遍历二叉树的递归形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">inorder_traverse_recursion</span><span class="params">(TreeNode *root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">inorder_traverse_recursion</span>(root-&gt;left);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c\t&quot;</span>, root-&gt;data);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">inorder_traverse_recursion</span>(root-&gt;right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="非递归实现-1"><a href="#非递归实现-1" class="headerlink" title="非递归实现"></a>非递归实现</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 中序遍历二叉树的非递归形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">inorder_traverse_not_recursion</span><span class="params">(TreeNode *root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    std::stack&lt;TreeNode *&gt; tree_stack;</span><br><span class="line">    <span class="keyword">while</span> (root != <span class="literal">NULL</span> || tree_stack.<span class="built_in">size</span>() &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 遍历到左子树的叶子节点</span></span><br><span class="line">        <span class="keyword">while</span> (root)</span><br><span class="line">        &#123;</span><br><span class="line">            tree_stack.<span class="built_in">push</span>(root);</span><br><span class="line">            root = root-&gt;left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 遍历栈顶节点</span></span><br><span class="line">        root = tree_stack.<span class="built_in">top</span>();</span><br><span class="line">        tree_stack.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c\t&quot;</span>, root-&gt;data);</span><br><span class="line"></span><br><span class="line">        root = root-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="二叉树的后序遍历"><a href="#二叉树的后序遍历" class="headerlink" title="二叉树的后序遍历"></a>二叉树的后序遍历</h1><h2 id="递归实现-2"><a href="#递归实现-2" class="headerlink" title="递归实现"></a>递归实现</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 后序遍历二叉树的递归形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">postorder_traverse_recursion</span><span class="params">(TreeNode *root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">postorder_traverse_recursion</span>(root-&gt;left);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">postorder_traverse_recursion</span>(root-&gt;right);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c\t&quot;</span>, root-&gt;data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="非递归实现-2"><a href="#非递归实现-2" class="headerlink" title="非递归实现"></a>非递归实现</h2><p>仅用一个栈不能够实现后序遍历非递归算法，需要保存一个上次访问过节点的变量。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 后序遍历二叉树的非递归形式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">postorder_traverse_not_recursion</span><span class="params">(TreeNode *root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    std::stack&lt;TreeNode *&gt; tree_stack;</span><br><span class="line">    TreeNode *visited = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span> (root != <span class="literal">NULL</span> || tree_stack.<span class="built_in">size</span>() &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 遍历到左子树的叶子节点</span></span><br><span class="line">        <span class="keyword">while</span> (root)</span><br><span class="line">        &#123;</span><br><span class="line">            tree_stack.<span class="built_in">push</span>(root);</span><br><span class="line">            root = root-&gt;left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        root = tree_stack.<span class="built_in">top</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (root-&gt;right == <span class="literal">NULL</span> || root-&gt;right == visited)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 如果没有右孩子，或者右孩子刚刚访问过，则访问当前节点</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c\t&quot;</span>, root-&gt;data);</span><br><span class="line">            tree_stack.<span class="built_in">pop</span>();</span><br><span class="line">            visited = root;</span><br><span class="line">            root = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            root = root-&gt;right;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>二叉树遍历的递归形式程序结构类似，编写相对简单。但是递归方法在C语言中存在执行效率差（需要维护函数栈），容易出现栈溢出的异常的问题。任何递归问题问题都可以转化为非递归问题，转化的思路包括了直接转化法和间接转化法。直接转化法可以通过循环来解决，间接转化法需要借助栈加循环来解决。</p>
<p>二叉树遍历的非递归形式相对复杂，二叉树的先序遍历的非递归形式容易理解，二叉树的中序遍历稍微困难，后序遍历的非递归形式最复杂。</p>
<h1 id="相关下载"><a href="#相关下载" class="headerlink" title="相关下载"></a>相关下载</h1><p><a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1eQmweSM">程序源代码</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/min_stack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/min_stack/" class="post-title-link" itemprop="url">leetcode题目之Min Stack</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-09-27 00:00:00" itemprop="dateCreated datePublished" datetime="2014-09-27T00:00:00+00:00">2014-09-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><blockquote>
<p>Memory Limit Exceeded</p>
</blockquote>
<blockquote>
<p>Design a stack that supports push, pop, top, and retrieving the minimum element in constant time.</p>
</blockquote>
<blockquote>
<p>push(x) – Push element x onto stack.<br>pop() – Removes the element on top of the stack.<br>top() – Get the top element.<br>getMin() – Retrieve the minimum element in the stack.</p>
</blockquote>
<h1 id="错误代码"><a href="#错误代码" class="headerlink" title="错误代码"></a>错误代码</h1><p>看到此题目，以为是用实现一个简单的栈结构，于是就直接写下了如下代码，采用了双向链表的方式来实现：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span> &#123;</span></span><br><span class="line">public:</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">	&#123;</span></span><br><span class="line">		<span class="type">int</span> data;</span><br><span class="line">		Node *next;</span><br><span class="line">		Node *pre;</span><br><span class="line">		Node() : next(<span class="literal">NULL</span>),pre(<span class="literal">NULL</span>) &#123;&#125;; </span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	MinStack()</span><br><span class="line">	&#123;</span><br><span class="line">		header = new Node();</span><br><span class="line">		tail = header;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="type">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        Node *node = new Node();</span><br><span class="line">		node-&gt;data = x;</span><br><span class="line">		node-&gt;pre = tail;</span><br><span class="line">		tail-&gt;next = node;</span><br><span class="line">		tail = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        Node *pre = tail-&gt;pre;</span><br><span class="line">		delete tail;</span><br><span class="line">		tail = pre;</span><br><span class="line">		tail-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (tail == header)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="keyword">return</span> tail-&gt;data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">getMin</span><span class="params">()</span> &#123;</span><br><span class="line">		Node *begin = header-&gt;next;</span><br><span class="line">		<span class="type">int</span> min = INT_MIN;</span><br><span class="line">        <span class="keyword">while</span>(begin)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (min &gt; begin-&gt;data)</span><br><span class="line">			&#123;</span><br><span class="line">				min = begin-&gt;data;</span><br><span class="line">			&#125;</span><br><span class="line">			begin = begin-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">private:</span><br><span class="line">	Node *header;</span><br><span class="line">	Node *tail;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>提交后提示<code>Memory Limit Exceeded</code>错误，开始考虑是不是双向链表占用的空间过多。</p>
<h1 id="正确代码"><a href="#正确代码" class="headerlink" title="正确代码"></a>正确代码</h1><p>仔细看题目后发现<code>retrieving the minimum element in constant time</code>，即时间复杂度为O(1)，上述实现代码时间复杂度为O(n)，明显不符合要求。看来理解题目有误，不是为了实现栈类，而是为了利用数据结构解决获取最小值问题。</p>
<p>经过考虑后可以通过在类内部维护存储最小值的栈来解决，存储最小值的栈除了需要存储最小值外，还需要维护最小值个数。</p>
<p>实现代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span> &#123;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">MinUnit</span></span></span><br><span class="line"><span class="class">	&#123;</span></span><br><span class="line">		<span class="type">int</span> count;</span><br><span class="line">		<span class="type">int</span> value;</span><br><span class="line">		MinUnit(<span class="type">int</span> count, <span class="type">int</span> value) : count(count), value(value) &#123;&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">public:</span><br><span class="line">    <span class="type">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        data_stack.push(x);</span><br><span class="line">		<span class="keyword">if</span> (min_stack.empty() || x &lt; min_stack.top()-&gt;value)</span><br><span class="line">		&#123;</span><br><span class="line">			MinUnit *p_unit = new MinUnit(<span class="number">1</span>, x);</span><br><span class="line">			min_stack.push(p_unit);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == min_stack.top()-&gt;value)</span><br><span class="line">		&#123;</span><br><span class="line">			min_stack.top()-&gt;count++;</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (data_stack.top() == min_stack.top()-&gt;value)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (min_stack.top()-&gt;count == <span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				MinUnit *punit = min_stack.top();</span><br><span class="line">				min_stack.pop();</span><br><span class="line">				delete punit;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				min_stack.top()-&gt;count--;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		data_stack.pop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> data_stack.top();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">getMin</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> min_stack.top()-&gt;value;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">private:</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">stack</span>&lt;<span class="type">int</span>&gt; data_stack;</span><br><span class="line">	<span class="comment">// 最小栈，为了便于修改栈单元中的count值，采用存储指针方式</span></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">stack</span>&lt;MinUnit*&gt; min_stack;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/linux_convert_ary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/linux_convert_ary/" class="post-title-link" itemprop="url">Linux下通过命令行进行进制转换</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2014-09-27 00:00:00" itemprop="dateCreated datePublished" datetime="2014-09-27T00:00:00+00:00">2014-09-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 15:13:53" itemprop="dateModified" datetime="2023-08-15T15:13:53+00:00">2023-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在Windows下可以通过计算器进行进制之间的转换，非常方便。本文总结Linux下可用的进行进制之间的转换方法。</p>
<h1 id="利用shell"><a href="#利用shell" class="headerlink" title="利用shell"></a>利用shell</h1><p>shell脚本默认数值是由10进制数处理，除非这个数字某种特殊的标记法或前缀开头，才可以表示其它进制类型数值。如：以0开头就是8进制、以0x开头就是16进制数。使用“BASE#NUMBER”这种形式可以表示其它进制。BASE值的范围为2-64。</p>
<p>其他进制转10进制</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kuring@T420:~$ echo $((16#4000000))</span><br><span class="line">67108864</span><br><span class="line">kuring@T420:~$ echo $((2#111))</span><br><span class="line">7</span><br><span class="line">kuring@T420:~$ echo $((0x10))</span><br><span class="line">16</span><br><span class="line">kuring@T420:~$ echo $((010))</span><br><span class="line">8</span><br><span class="line"></span><br><span class="line">// 对进制转换为10进制进行运算，稍显啰嗦</span><br><span class="line">kuring@T420:~$ echo $(($((16#4000000))/1014/1024));</span><br><span class="line">64</span><br></pre></td></tr></table></figure>

<h1 id="利用let命令"><a href="#利用let命令" class="headerlink" title="利用let命令"></a>利用let命令</h1><p>let用来执行算数运算和数值表达式测试。可以利用该命令完成简单的计算，并将计算结果赋给其他变量。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 对进制转换为10进制后进行运算，比纯shell方式简洁</span><br><span class="line">kuring@T420:~$ let a=$((16#4000000))/1014/1024;</span><br><span class="line">kuring@T420:~$ echo $a</span><br><span class="line">64</span><br></pre></td></tr></table></figure>

<h1 id="利用bc命令"><a href="#利用bc命令" class="headerlink" title="利用bc命令"></a>利用bc命令</h1><p>该命令是一个强大的计算器软件，可以利用其中的ibase和obase进行输入进制的转换，ibase表示输入数字的进制，obase表示输出数字的进制。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 如果没有制定，则默认为10进制</span><br><span class="line">// 对于16进制，要使用F，而不能使用f</span><br><span class="line">kuring@T420:~$ echo &quot;ibase=16;FF&quot; | bc</span><br><span class="line">255</span><br><span class="line">kuring@T420:~$ echo &quot;obase=2;ibase=16;FF&quot; | bc</span><br><span class="line">11111111</span><br></pre></td></tr></table></figure>

<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/chengmo/archive/2010/10/14/1851570.html">linux shell 不同进制数据转换（二进制，八进制，十六进制，base64)</a></p>
<p><a target="_blank" rel="noopener" href="http://blog.csdn.net/fengyuxing168/article/details/8896955">Shell进制转换小结</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/15/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/17/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder"></span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
