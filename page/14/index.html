<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"kuring.me","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":true,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="404频道">
<meta property="og:url" content="http://kuring.me/page/14/index.html">
<meta property="og:site_name" content="404频道">
<meta property="og:locale">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://kuring.me/page/14/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-Hans","comments":"","permalink":"","path":"page/14/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>404频道</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">404频道</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">学习笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">239</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/kuring" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kuring" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/yum-build/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/yum-build/" class="post-title-link" itemprop="url">yum源搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-12-07 12:10:19" itemprop="dateCreated datePublished" datetime="2017-12-07T12:10:19+00:00">2017-12-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>某些情况下需要搭建自己的yum源，比如维持特定的软件包版本等，只需要从网上下载合适的rpm包，即可构建yum源。</p>
<h1 id="repodata数据"><a href="#repodata数据" class="headerlink" title="repodata数据"></a>repodata数据</h1><p>创建&#x2F;data&#x2F;yum.repo目录用来存放rpm包。</p>
<p>可以使用yumdownloader命令来下载rpm包到本地，并且不安装。这里以安装mesos为例，在&#x2F;data&#x2F;yum.repo目录下执行<code>yumdownloader mesos</code>即可下载mesos的rpm包到本地。</p>
<p>安装createrepo：<code>yum install createrepo</code>，用来根据rpm包产生对应的包信息。</p>
<p>每加入一个rpm包需要更新下repo的信息，执行<code>createrepo --update /data/yum.repo</code>。会自动产生repodata目录。</p>
<h1 id="搭建web服务"><a href="#搭建web服务" class="headerlink" title="搭建web服务"></a>搭建web服务</h1><p>需要对外提供web服务，通常会使用nginx或者apache来对外提供服务，这里使用python SimpleHTTPServer来对外提供服务，执行<code>cd /data/yum.repo &amp;&amp; python -m SimpleHTTPServer 1080</code>。</p>
<h1 id="客户端的repo文件设置"><a href="#客户端的repo文件设置" class="headerlink" title="客户端的repo文件设置"></a>客户端的repo文件设置</h1><p>安装yum优先级插件，用来设置yum源的优先级: <code>yum install -y yum-plugin-priorities</code></p>
<p>每个需要使用该yum源的客户端需要在&#x2F;etc&#x2F;yum.repo.d&#x2F;目录下增加devops.repo文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[devops]</span><br><span class="line">name=dev-ops</span><br><span class="line">baseurl=http://10.103.17.184:1080/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">priority=1</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/grafana-upgrade/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/grafana-upgrade/" class="post-title-link" itemprop="url">grafana升级</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-09-13 00:22:51" itemprop="dateCreated datePublished" datetime="2017-09-13T00:22:51+00:00">2017-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本次grafana的升级从版本3.1.1，变更为4.4.3，涉及到一个大的版本跨度。同时之前在使用的存储为sqlite，趁着这次升级更改为mysql。</p>
<h1 id="grafana升级"><a href="#grafana升级" class="headerlink" title="grafana升级"></a>grafana升级</h1><p>直接从官网下载对应的4.4.3版本的二进制包，修改部分配置即可，该部分没任何难度。</p>
<h1 id="sqlite-to-mysql"><a href="#sqlite-to-mysql" class="headerlink" title="sqlite to mysql"></a>sqlite to mysql</h1><p>由于grafana使用的表结构在3.1.1到4.4.3之间有变更，不能直接将3.1.1版本的sqlite中的数据导入到4.4.3的mysql中。我的方法为先使用3.1.1版grafana将数据从sqlite导入到mysql中，然后再升级grafana的版本，grafana可以自动修改表结构。</p>
<p>在的mysql中创建grafana的数据库，并修改数据库的编码为utf-8.</p>
<p>修改grafana 3.1.1配置文件conf&#x2F;defaults.ini如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[database]</span><br><span class="line"># You can configure the database connection by specifying type, host, name, user and password</span><br><span class="line"># as separate properties or as on string using the url property.</span><br><span class="line"></span><br><span class="line"># Either &quot;mysql&quot;, &quot;postgres&quot; or &quot;sqlite3&quot;, it&#x27;s your choice</span><br><span class="line">type = mysql</span><br><span class="line">host = xx.xx.xx.xx:3306</span><br><span class="line">name = grafana</span><br><span class="line">user = dev</span><br><span class="line"># If the password contains # or ; you have to wrap it with triple quotes. Ex &quot;&quot;&quot;#password;&quot;&quot;&quot;</span><br><span class="line">password = dev</span><br></pre></td></tr></table></figure>

<p>启动grafana后会自动在grafana数据库中创建相应的表结构，接下来就是将sqlite中的数据导入到mysql中。</p>
<p>在data目录下增加如下脚本sqlitedump.sh，并执行<code>sh sqlitedump.sh grafana.db &gt; grafana.sql</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">DB=$1</span><br><span class="line">TABLES=$(sqlite3 $DB .tables | grep -v migration_log)</span><br><span class="line">for t in $TABLES; do</span><br><span class="line">    echo &quot;TRUNCATE TABLE $t;&quot;</span><br><span class="line">done</span><br><span class="line">for t in $TABLES; do</span><br><span class="line">    echo -e &quot;.mode insert $t\nselect * from $t;&quot;</span><br><span class="line">done | sqlite3 $DB</span><br></pre></td></tr></table></figure>

<p>然后将grafana.sql导入到新创建的mysql。</p>
<p>将grafana 3.1.1版本停掉，将grafana 4.4.3版本的配置指向到mysql数据库，启动grafana 4.4.3后，mysql中的表结构会自动变更。</p>
<p>至此，grafana的升级完成。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/rsync-bypass-ralay/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/rsync-bypass-ralay/" class="post-title-link" itemprop="url">通过rsync来绕过relay同步文件</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-06-07 11:58:54" itemprop="dateCreated datePublished" datetime="2017-06-07T11:58:54+00:00">2017-06-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>由于不允许通过ssh直接连接服务器，即服务器的22端口是不开放的，但是其他端口号可以访问。这就造成了往服务器上传输文件会特别麻烦，需要通过relay中转一下。</p>
<p>rsync命令有shell模式和daemon模式，为了解决该问题，可以通过rsync的daemon模式，rysnc的daemon模式会默认使用873端口，不使用ssh协议，以此来绕过ssh的22端口限制。</p>
<p>最终可以实现在本地通过rsync一条命令直接同步文件或文件夹到服务器的指定目录下。</p>
<p>首先在服务器上搭建rsync的服务端，rsync的安装不再介绍。</p>
<p>修改服务器的rsync配置文件&#x2F;etc&#x2F;rsyncd.conf如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[worker]</span><br><span class="line">path = /home/worker</span><br><span class="line">list = true</span><br><span class="line">uid = worker</span><br><span class="line">gid = worker</span><br><span class="line">read only = false</span><br></pre></td></tr></table></figure>

<p>这里为了简便，并未设置rsync的用户名和密码。</p>
<p>客户端同步文件的命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -avz $SRC worker@$HOST::worker --exclude=target --exclude=.git --exclude=.idea --delete</span><br></pre></td></tr></table></figure>

<p>命令中的第一个worker为HOST的登录用户名，第二个worker为rysncd配置文件中配置的组名。–exclude选项可以用来屏蔽需要同步的文件夹。–delete选项用来同步删除的文件或文件夹。</p>
<p>daemon模式跟ssh模式相比，无法指定服务器的具体某一个路径，使用不够灵活，但也基本可以满足需求。只能通过daemon配置文件中配置的组中的path参数，同步时仅能通过<code>::组名</code>的形式来指定。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/relay-auto-login/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/relay-auto-login/" class="post-title-link" itemprop="url">自动通过跳板机登录到其他服务器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-05-17 16:04:01" itemprop="dateCreated datePublished" datetime="2017-05-17T16:04:01+00:00">2017-05-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近公司需要首先登录跳板机relay，然后通过跳板机才能登录服务器，操作上略显麻烦。为了节省登录服务器的时间，我编写了一个简单的脚本来简化登录操作。</p>
<p>实现效果为在本地terminal下，执行<code>wrelay $host</code>，即可自动登录到相应的主机。</p>
<h1 id="在relay服务器上增加对其他服务器的免登录命令"><a href="#在relay服务器上增加对其他服务器的免登录命令" class="headerlink" title="在relay服务器上增加对其他服务器的免登录命令"></a>在relay服务器上增加对其他服务器的免登录命令</h1><p>在relay服务器上ssh到其他主机时需要输入密码，使用expect命令来登录到其他主机时通过expect脚本来实现自动输入密码并登录的功能。</p>
<p>在&#x2F;home&#x2F;$user目录下新建mybin文件夹，并将mybin文件夹添加到$PATH环境变量中，具体修改方法不展开。</p>
<p>在mybin目录下增加gw脚本，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/expect</span><br><span class="line"></span><br><span class="line">if &#123;$argc &lt; 1&#125; &#123;</span><br><span class="line">    puts &quot;Usage:cmd &lt;host&gt;&quot;</span><br><span class="line">    exit 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">set host [lindex $argv 0]</span><br><span class="line"># 在这里填写要登录的用户</span><br><span class="line">set username &quot;worker&quot;</span><br><span class="line"># 在这里填写要登录的密码</span><br><span class="line">set password &quot;worker&quot;</span><br><span class="line"></span><br><span class="line">spawn ssh $username@$host</span><br><span class="line">set timeout 2</span><br><span class="line">expect &#123;</span><br><span class="line">    &quot;*password:&quot; &#123;</span><br><span class="line">        send &quot;$password\n&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    &quot;Are you sure you want to continue connecting (yes/no)?&quot; &#123;</span><br><span class="line">        send &quot;yes\r&quot;</span><br><span class="line">        exp_continue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">expect &quot;*#&quot;</span><br><span class="line">interact</span><br></pre></td></tr></table></figure>

<p>执行<code>gw 10.1.1.8</code>，即可登录到对应的主机上。</p>
<h1 id="本地主机免登录relay服务器，并自动登录到对应的服务器"><a href="#本地主机免登录relay服务器，并自动登录到对应的服务器" class="headerlink" title="本地主机免登录relay服务器，并自动登录到对应的服务器"></a>本地主机免登录relay服务器，并自动登录到对应的服务器</h1><p>在本地自动登录relay主机同样使用expect的方式，脚本名称为wrelay，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/expect</span><br><span class="line"></span><br><span class="line">if &#123;$argc &lt; 1&#125; &#123;</span><br><span class="line">    puts &quot;Usage:cmd &lt;remote_host&gt;&quot;</span><br><span class="line">    exit 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 下面指定relay主机</span><br><span class="line">set host &quot;relay.name&quot;</span><br><span class="line"># 这里输入relay的用户名</span><br><span class="line">set username &quot;&quot;</span><br><span class="line"># 这里输入relay的密码</span><br><span class="line">set password &quot;&quot;</span><br><span class="line">set remote_host [lindex $argv 0]</span><br><span class="line"></span><br><span class="line">spawn ssh $username@$host</span><br><span class="line">set timeout 2</span><br><span class="line">expect &#123;</span><br><span class="line">    &quot;*password:&quot; &#123;</span><br><span class="line">        send &quot;$password\n&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    &quot;Are you sure you want to continue connecting (yes/no)?&quot; &#123;</span><br><span class="line">        send &quot;yes\r&quot;</span><br><span class="line">        exp_continue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">expect &quot;*#&quot;</span><br><span class="line"></span><br><span class="line">sleep 0.1</span><br><span class="line"># 在relay上自动登录到其他服务器主机</span><br><span class="line">send &quot;gw $remote_host\n&quot;</span><br><span class="line">interact</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/mv-farbox-to-hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/mv-farbox-to-hexo/" class="post-title-link" itemprop="url">blog从farbox迁移到了hexo</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-04-06 23:33:47" itemprop="dateCreated datePublished" datetime="2017-04-06T23:33:47+00:00">2017-04-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>清明节假期突然想起了我好久不更的blog，看到Farbox官网上的<a target="_blank" rel="noopener" href="https://blog.farbox.com/post/2017">《2016，终结了几个产品》</a>，说明Farbox已经停止更新了。虽然我挺喜欢Farbox这个项目，也见证了Farbox的成长及作者做产品的思考，在这里也向作者致敬。</p>
<p>我当时开始准备启用Farbox之前试用过jekyll，翻遍了整个github，也没找到个合我心意的theme。幸好是Farbox的出现，让我眼前一亮，这就是我想好的blog系统了。Farbox的停更使我不得不考虑重新换个blog，虽然2016的文章数量仅为罕见的个位数，但有可能今年有时间会多写一些。</p>
<p>近几年hexo特别的火，在试看了官方文档了解功能及考虑了blog的迁移成本后，心想，这就是我想要的blog系统了。hexo该有的功能全都有，甚至比Farbox要强大很多。Farbox的很多设计思想跟hexo相仿，但hexo显的更加自由，blog需要自己一手搭建完成。</p>
<p>当然hexo要想使用的好，做一些全面的了解及折腾是必不可少的，毕竟最终利用的Github pages是个静态的系统。早已没有了想当年翻遍整个github上jekyll theme的精力了，我这次的基调是能少折腾就少折腾，毕竟blog我也不是经常写，访问量也更是少的可怜，就当全面了解下当前最火的hexo就好了。</p>
<h1 id="theme"><a href="#theme" class="headerlink" title="theme"></a>theme</h1><p>本着不折腾原则，直接启用了很火的hexo-theme-next，文档比较全，维护比较及时。基本上按照文档走一遍，该配置的就都可以配置上了。</p>
<h1 id="代码同步"><a href="#代码同步" class="headerlink" title="代码同步"></a>代码同步</h1><p>代码通过git同步是必备技能。</p>
<h2 id="hexo项目代码同步"><a href="#hexo项目代码同步" class="headerlink" title="hexo项目代码同步"></a>hexo项目代码同步</h2><p>hexo采用的是node.js环境，而Github pages是静态的，因此Github pages上仅能存储的是hexo编译后的静态文件，这些静态文件直接通过<code>hexo d</code>部署到kuring.github.com仓库中就可以了。</p>
<p>而对于项目中的_config.yml、md文件我直接用git同步到Github上另外一个项目hexo_bak中了。网上还有思路是同步到kuring.github.com上的另外一个分支，我感觉太啰嗦，容易出错，还不如直接分开来的简便。</p>
<h2 id="theme项目的代码同步"><a href="#theme项目的代码同步" class="headerlink" title="theme项目的代码同步"></a>theme项目的代码同步</h2><p>theme项目中也包含了部分自己的配置及修改，我这里选择的同步策略为从github上fork对应的theme项目，然后clone fork下来的项目到本地，然后直接在theme的项目中通过git命令同步到github fork的项目中。</p>
<p>网上也有思路是通过git subtree的方式来解决，我仍然感觉太啰嗦，不采用。</p>
<p>但这样一个blog项目需要多个git仓库，git push起来会比较麻烦，好在theme一般不怎么修改。</p>
<h1 id="评论系统"><a href="#评论系统" class="headerlink" title="评论系统"></a>评论系统</h1><p>之前用多说的时候也没几个评论的，用起来还不错，至少比被墙了的disqus要好很多，可是多说这么好的项目要关闭了。我直接使用了国内的网易云跟帖来满足评论的需求。</p>
<h1 id="站内搜索"><a href="#站内搜索" class="headerlink" title="站内搜索"></a>站内搜索</h1><p>站内搜索是必不可少的功能，next主题提供了多种选择，我直接使用了hexo-generator-searchdb通过本地搜索来完成，生成的xml文件目前还比较小，效果还可以。</p>
<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><ul>
<li>启用本地server端：<code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</code></li>
<li>部署到github：<code>hexo d</code></li>
<li>发布文章：<code>hexo new 文章url</code></li>
</ul>
<p>使用<code>hexo new draft test</code>会在source&#x2F;_drafts目录下创建对应文件，此时文件不会生成页面，用于存放未写完的文章。<code>hexo publish draft test</code>命令可将_drafts下的文章移动到_posts目录下，并添加创建时间等信息。</p>
<h1 id="收个尾"><a href="#收个尾" class="headerlink" title="收个尾"></a>收个尾</h1><p>blog总算迁移完成了，期望今年能多写上几篇。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/logstash-php-fpm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/logstash-php-fpm/" class="post-title-link" itemprop="url">使用logstash收集php-fpm slow log</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-06-10 00:00:00" itemprop="dateCreated datePublished" datetime="2016-06-10T00:00:00+00:00">2016-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>目前php-fpm的服务部署在了docker中，对php-fpm的log和php error log可以通过syslog协议的形式发送出去，而php-fpm的slow log却不能配置为syslog协议，只能输出到文件中，因为一条slow log的是有多行组成的。</p>
<p>在docker中使用时发现fpm-slowlog不能正常输出，后经发现是docker默认没有ptrace系统调用的权限，而slow log的产生需要该系统调用。通过在docker启动的时候增加”–cap-add SYS_PTRACE”启动项可修正该问题。</p>
<p>为了收集slow log，可以通过logstash、flume等工具进行收集，本文采用logstash对slow log进行收集，并将收集的log写入到kafka中，便于后续的处理。logstash的input采用读取文件的方式，即跟tail -f的原理类似。为了能够将多行日志作为一行，采用了filter中的multiline来对多行日志进行合并操作。logstash的配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">    file &#123;</span><br><span class="line">        path =&gt; [“/var/log/php-fpm/fpm-slow.log&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">filter &#123;</span><br><span class="line">    multiline &#123;</span><br><span class="line">        pattern =&gt; &quot;^$&quot;</span><br><span class="line">        negate =&gt; true</span><br><span class="line">        what =&gt; &quot;previous&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">    stdout&#123;codec =&gt; rubydebug&#125;</span><br><span class="line">    kafka &#123;</span><br><span class="line">        codec =&gt; plain &#123;</span><br><span class="line">           format =&gt; “tag|%&#123;host&#125;%&#123;message&#125;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        topic_id =&gt; &quot;fpm-slowlog&quot;</span><br><span class="line">        bootstrap_servers =&gt; “kafka1.hostname:8082,kafka2.hostname:8082&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/elk_nginx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/elk_nginx/" class="post-title-link" itemprop="url">ELK解析nginx日志</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-02-18 00:00:00" itemprop="dateCreated datePublished" datetime="2016-02-18T00:00:00+00:00">2016-02-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ELK解析nginx日志</p>
<p>最近使用ELK搭建了一个nginx的日志解析环境，中间遇到一些挫折，好不容易搭建完毕，有必要记录一下。</p>
<h1 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h1><p>nginx配置文件中的日志配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">error_log /var/log/nginx/error.log;</span><br><span class="line">log_format  main  &#x27;$remote_addr [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">access_log /var/log/nginx/access.log  main;</span><br></pre></td></tr></table></figure>

<h1 id="logstash"><a href="#logstash" class="headerlink" title="logstash"></a>logstash</h1><p>由于是测试环境，我这里使用logstash读取nginx日志文件的方式来获取nginx的日志，并且仅读取了nginx的access log，对于error log没有关心。</p>
<p>使用的logstash版本为2.2.0，在log stash程序目录下创建conf文件夹，用于存放解析日志的配置文件，并在其中创建文件test.conf，文件内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">    file &#123;</span><br><span class="line">        path =&gt; [&quot;/var/log/nginx/access.log&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">filter &#123;</span><br><span class="line">    grok &#123;</span><br><span class="line">        match =&gt; &#123;</span><br><span class="line">            &quot;message&quot; =&gt; &quot;%&#123;IPORHOST:clientip&#125; \[%&#123;HTTPDATE:time&#125;\] \&quot;%&#123;WORD:verb&#125; %&#123;URIPATHPARAM:request&#125; HTTP/%&#123;NUMBER:httpversion&#125;\&quot; %&#123;NUMBER:http_status_code&#125; %&#123;NUMBER:bytes&#125; \&quot;(?&lt;http_referer&gt;\S+)\&quot; \&quot;(?&lt;http_user_agent&gt;\S+)\&quot; \&quot;(?&lt;http_x_forwarded_for&gt;\S+)\&quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line">output &#123;</span><br><span class="line">    elasticsearch &#123;</span><br><span class="line">        hosts =&gt; [&quot;10.103.17.4:9200&quot;]</span><br><span class="line">        index =&gt; &quot;logstash-nginx-test-%&#123;+YYYY.MM.dd&#125;&quot;</span><br><span class="line">        workers =&gt; 1</span><br><span class="line">        flush_size =&gt; 1</span><br><span class="line">        idle_flush_time =&gt; 1</span><br><span class="line">        template_overwrite =&gt; true</span><br><span class="line">    &#125;</span><br><span class="line">    stdout&#123;codec =&gt; rubydebug&#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>需要说明的是，filter字段中的grok部分，由于nginx的日志是格式化的，logstash解析日志的思路为通过正则表达式来匹配日志，并将字段保存到相应的变量中。logstash中使用grok插件来解析日志，grok中message部分为对应的grok语法，并不完全等价于正则表达式的语法，在其中增加了变量信息。</p>
<p>具体grok语法不作过多介绍，可以通过logstash的官方文档中来了解。但grok语法中的变量类型如IPORHOST并未找到具体的文档，只能通过在logstash的安装目录下通过<code>grep -nr &quot;IPORHOST&quot; .</code>来搜索具体的含义。</p>
<p>配置文件中的stdout部分用于打印grok解析结果的信息，在调试阶段一定要打开。</p>
<p>可以通过<a target="_blank" rel="noopener" href="http://grokconstructor.appspot.com/do/match">这里</a>来验证grok表达式的语法是否正确，编写grok表达式的时候可以在这里编写和测试。</p>
<p>对于elasticsearch部分不做过多介绍，网上容易找到资料。</p>
<h1 id="kibana"><a href="#kibana" class="headerlink" title="kibana"></a>kibana</h1><p>kibana不做过多介绍，使用可以查看官方文档和自己摸索。</p>
<h1 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h1><p><a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html">logstash中的grok插件介绍</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/aws_net/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/aws_net/" class="post-title-link" itemprop="url">利用aws科学上网</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-02-17 00:00:00" itemprop="dateCreated datePublished" datetime="2016-02-17T00:00:00+00:00">2016-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>曾经使用过多种科学上网方式，​最近尝试了使用aws的免费试用一年的功能搭建shadowsocks，访问google的速度非常不错，比很多收费的服务要好用，amazon真是良心企业！</p>
<p>本文用于记录在aws上搭建服务的步骤及其中的一些注意事项，步骤不会太详细，aws上关于主机的功能需要读者自己在试验的过程中去自己探索。</p>
<h1 id="注册aws账号"><a href="#注册aws账号" class="headerlink" title="注册aws账号"></a>注册aws账号</h1><p>为了能够搭建搭建aws服务，拥有一个amazon账号是必须的，在<a target="_blank" rel="noopener" href="https://aws.amazon.com/cn/free/">aws免费套餐</a>的页面点击『创建免费账号』按钮即可按照步骤创建aws账号。</p>
<p>值得一提的是，注册aws的账号需要一张信用卡。</p>
<h1 id="开启EC2主机实例"><a href="#开启EC2主机实例" class="headerlink" title="开启EC2主机实例"></a>开启EC2主机实例</h1><p>该步骤的目的是开启aws上的主机实例。​</p>
<p>进入aws的控制面板，在左上角的服务中选择EC2，aws提供了多种类型的主机，这里选择EC2即可。</p>
<p>在EC2控制面板界面中需要选择右上角的区域，这个用于选择EC2主机所在的机房，不同机房之间主机是不可以共享的。我这里选择了『美国西部（俄勒冈）』，感觉速度还不错，没有试验过亚洲地区的，新加坡的速度是不是会更好些。后续经过验证，首尔的服务器确实速度更快一些。<br>​<br>下面即可创建EC2的实例了，点击界面上的『启动实例』按钮即可按照步骤创建EC2实例了，创建实例的时候一定要选择免费的EC2主机，否则就会悲剧了。我选择了ubuntu14.04的主机，redhat7.2的主机yum源不太全，没有选择使用。</p>
<p>最终会得到ssh登录用的pem文件，用于ssh远程登录主机。并在界面上启动刚刚创建的实例。</p>
<h1 id="按照shadowsocks"><a href="#按照shadowsocks" class="headerlink" title="按照shadowsocks"></a>按照shadowsocks</h1><p>接下来就是在EC2实例上安装sock5代理工具了。</p>
<p>登录刚刚启动的EC2，需要pem文件。可以通过<code>ssh -i &quot;key.pem&quot; ubuntu@ec2-52-26-2-14.us-west-2.compute.amazonaws.com</code>命令来登录到远程主机，其他工具请自行google。</p>
<p>使用命令<code>pip install shadowsocks</code>来安装shadowssocks，pip命令的安装自行解决。</p>
<p>在ubuntu的home目录下执行<code>mkdir shadowsocks</code>创建保存配置文件的文件夹，并创建配置文件config.json，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</span><br><span class="line">    &quot;server_port&quot;:10001,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;password&quot;:&quot;xxx&quot;,</span><br><span class="line">    &quot;timeout&quot;:600,</span><br><span class="line">    &quot;method&quot;:&quot;bf-cfb&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要说明的是最好配置一下server_port选项，更改shadowsocks的默认端口号。method选项用于控制加密方式，我这里更改为了bf-cfb。</p>
<p>执行<code>nohup ssserver -c config.json &amp;</code>命令即可启动shadowsocks服务。</p>
<p>由于对外增加了10001端口号，aws的默认安全策略为仅对外提供22端口，需要在EC2主机的安全策略中增加外放访问tcp端口10001的权限。</p>
<h1 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h1><p>为了安装方便，我简单写了个脚本如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">yum -y install epel-release</span><br><span class="line">#yum update -y</span><br><span class="line">yum install python2-pip -y</span><br><span class="line">pip install shadowsocks</span><br><span class="line">mkdir ~/shadowsocks</span><br><span class="line">echo &#x27;&#123;</span><br><span class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</span><br><span class="line">    &quot;server_port&quot;:10001,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;password&quot;:&quot;xxx&quot;,</span><br><span class="line">    &quot;timeout&quot;:600,</span><br><span class="line">    &quot;method&quot;:&quot;aes-256-cfb&quot;</span><br><span class="line">&#125;&#x27; &gt; ~/shadowsocks/config.json</span><br><span class="line">systemctl disable firewalld.service</span><br><span class="line">systemctl stop firewalld.service</span><br><span class="line">nohup ssserver -c ~/shadowsocks/config.json &amp;</span><br></pre></td></tr></table></figure>

<p>在某些云主机的CentOS7系统发现无法使用<code>yum install python2-pip</code>进行安装，原因是有些源被禁用了，可以使用<code>yum repolist disabled</code>来查看被禁用的源，其中会包含epel源。可以使用<code>yum install python2-pip -y --enablerepo=epel</code>的方式来安装。</p>
<h1 id="安装shadowsocks客户端"><a href="#安装shadowsocks客户端" class="headerlink" title="安装shadowsocks客户端"></a>安装shadowsocks客户端</h1><p>这里是支持的<a target="_blank" rel="noopener" href="https://shadowsocks.com/client.html">客户端列表</a>，​我这里仅使用的mac客户端ShadowsocksX，支持Auto Proxy Mode和Global Mode两种方式，其中Auto方式会自动下载使用sock5代理的列表，非常方便。</p>
<h1 id="kcptun"><a href="#kcptun" class="headerlink" title="kcptun"></a>kcptun</h1><p>为了加快访问速度，推荐使用kcp + shadowsocks</p>
<p>kcp的服务端配置如下，即启用20001端口，该端口会将流量导入到127.0.0.1:10001端口，即本机的shadowsocks端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~ &amp;&amp; mkdir kcptun &amp;&amp; cd kcptun</span><br><span class="line">wget https://github.com/xtaci/kcptun/releases/download/v20190109/kcptun-linux-amd64-20190109.tar.gz</span><br><span class="line">tar zvxf kcptun-linux-amd64-20190109.tar.gz</span><br><span class="line">nohup ./server_linux_amd64 -l :20001 -t 127.0.0.1:10001 -key xxx -mode fast2 --log ~/kcptun/20001.log &amp;</span><br></pre></td></tr></table></figure>

<p>配置了kcptun的shadowsocks客户端仅需要配置代理为远程的kcpdun端口即可，不再需要指定shadowsocks的端口，相当于shadowsocks是透明的。</p>
<h1 id="监控"><a href="#监控" class="headerlink" title="监控"></a>监控</h1><p>为了避免aws产生额外的费用，一定要设置一下费用报警，否则被扣费了就麻烦了。</p>
<p>另外，可定期查看下aws的费用。试用期为一年，一年后一定要记得停掉aws服务。</p>
<p>最后，祝你玩的愉快！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/2015_summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2015_summary/" class="post-title-link" itemprop="url">2015年年终总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-02-02 00:00:00" itemprop="dateCreated datePublished" datetime="2016-02-02T00:00:00+00:00">2016-02-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>按照惯例，年终总结依旧是按照农历算，农历乙未年的年终总结。</p>
<p>2015年的夏天对我而言是个转折点，终于实现了我工作以来一直想北漂的梦想，受够了各种束缚，受够了带同事的各种无奈，受够了跟同事没有话题的工作，受够了天天雾霾比北京不知严重多少倍却没有一点声音，受够了满城市找不到一家互联网公司，受够了满城市找不到一个技术会议，受够了于为了工作而工作的同事们共事，受够了天天受到官本位思想的侵蚀。</p>
<p>上半年在济南工作生活，下半年在北京工作生活。</p>
<p>似乎一直以来我的一些人生大事都是在夏天发生的。</p>
<h1 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h1><p>在济南的工作没什么好总结的，我已经在济南工作多年，似乎也没有太大的变化。</p>
<p>由于互联网公司和传统行业软件公司存在较大的差异，来到一点资讯后大约适应了两个月才完全适应。到现在，让我回想之前的工作状态，感觉好陌生，好遥远。</p>
<p>我的岗位为运维开发，叫做基础平台的研发更合适些。由于之前没有运维方面的工作经验，对运维开发这样的职位没有清晰的认识。对运维的需求也是在工作中逐步去摸索的。</p>
<p>之前在济南工作的时候，由于从事的是传统软件行业，对技术的使用比较保守，公司中很少会采用很新的技术，比如storm、kafka等。很多行业我个人利用业余时间倒是学习了很多互联网中会用到的技术，但是由于缺乏实践机会，时间一长就忘记了。</p>
<p>另外由于处理业务类型不同，使用的技术往往也不一样。比如haproxy这种反向代理软件在非互联网行业中其实用到比较少，因为非互联网行业面向的群体往往是政府和企业类的，不是使用互联网的广大用户群体，因此反向代理软件很少有永无之地。我之前待过的几家有些技术背景的非互联网公司往往会自己开发一些适合公司自己业务的类库或者技术架构，很多技术含量也是蛮高的，只是不为外界所知，组件无法公用，更没有开源的。</p>
<p>当然了，随着互联网行业的发展，传统的软件企业所使用的技术也在更新，也在采用互联网企业使用的技术。</p>
<p>因此，来到了互联网行业对我而言最重要的就是掌握互联网行业中会用到的技术，除了工作过程中会使用一些新技术之外，晚上下班之后也会将时间充分利用上，学习一些工作中会用到的技术。由于要学的技术实在太多了，至于先学什么后学什么，我采取了“用到什么就学什么，广撒网，后深入”的原则，这样既能达到不太影响工作，又可以达到一定广度，等到广度够了再深入了解各个技术。</p>
<p>由于自己的各种问题，也造成过几次系统的线上的故障，靠谱程度还有待提高。</p>
<p>在济南的环境下从来没有见过@福波和@凯荣为了工作这般拼得的同事，虽然他们这种拼得方式我学不来，但至少要从精神上拼一下。</p>
<p>工作的原因，正在使用的编程也变得更多，工作中会用到C++、Java、Python、Golang、前端技术等，不同的语言使用于不同的场景下。</p>
<p>工作上并没有太大的成就，主要是因为需要学习的东西太多，需需要了解，各种技术需要学习，一些开源的大数据处理技术和存在的坑也需要学习。相信随着学习的不断深入，2016年工作能小有成就。</p>
<h1 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h1><p>由于我学习新知识很多时候还是看技术类的书籍，比较喜欢系统一点的学习，纸质书是我的最爱。今年买过不少的技术书籍，特别是下半年以来，至少有20本技术书的样子。之前都会系统的讲书籍看完，下半年买的技术书籍基本都是看上一半或找个技术重点就扔到一边去了。主要是因为没有了足够的时间来系统的学习整本书的内容，更多的时候是对症下药而已。</p>
<p>学习的方向上逐渐转为务实，为工作所用，解决工作之所需，不像之前学的很多东西都是纸上谈兵，缺少实践的机会。</p>
<h1 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h1><p>上半年生活在济南，下半年生活在北京。</p>
<p>在济南的生活相对惬意，加班相对少些，虽然是单双周轮休的生活，但周末仍然是有时间出去转转的。</p>
<p>来北京后，很多时候变成了工作在北京，周末回济南的生活，有时候两周回去一次，有时候一周回去一次，一般周一早上坐最早的高铁回北京。这样的生活相对单调，也确实非常辛苦，基本被工作和学习占去了绝大多数时间，剩下的时间非常有限。可以说工作就是我的生活，我的生活就是工作。</p>
<p>由于很多时间都是远离家的，自己为家庭付出的确实非常少，这点深表遗憾。</p>
<h2 id="运动"><a href="#运动" class="headerlink" title="运动"></a>运动</h2><p>之前上班的时候每天可以骑一个多小时的自行车来运动，而且坡度也比较大。后来，运动对我而言就相当匮乏了，没有活动的次数都非常有限，运动这一点做的相当不好。</p>
<p>今年从夏天开始学习游泳，终于将游泳学会了，而且游泳的次数也是很多的，虽然仅仅熟练的是蛙泳。公司每周三下午有个活动时间，有一段时间每周三下午都会去游泳的，正好此时学会了游泳。</p>
<p>偶然的一次机会，同学邀请打了一次台球，竟对台球感兴趣起来。</p>
<p>北京对我而言还是个陌生的地方，偶尔周末有时间，会去一些地方转转。</p>
<h2 id="健康"><a href="#健康" class="headerlink" title="健康"></a>健康</h2><p>今年下半年开始，职业症状逐渐明显，每天坐得时间一长，腰疼就来了，而且有愈演愈烈之势。后来尝试了站着办公，本来以为每天只要站着办公腰疼就不要紧了，试验后才发现站久了也是会腰疼的。目前每天基本都是站着办公了，只有站累了的情况下才会坐下来办公。</p>
<p>来到北京后睡的床垫不是太舒服，后来干脆更改为了睡硬板床，早上起来后确实能明显感觉到睡硬板床轻松的多。</p>
<p>颈椎也不是太好，虽然感觉到时候没有那么多，但至少没有那么健康了。</p>
<p>做按摩的时候才发现自己的腰肌劳损挺严重了，也许是按摩师故意说的严重，至少按摩时疼的我直叫，也能感觉到按摩时腰部的肌肉硬块。听到按摩师的一句话挺伤感的，『你为了工作也是够拼的，把腰伤成这样』。</p>
<h2 id="汽车"><a href="#汽车" class="headerlink" title="汽车"></a>汽车</h2><p>一向比较排斥汽车的我也在今年的三月份拿到了驾照，并且一度产生了年底购买汽车的想法，曾经也是痴迷过一段时间的汽车节目，在做饭和骑着自行车去上班的路上听汽车广播，对常见的车型都有所了解，还去过春季车展，进过4S店，自己对车的了解也是与日俱增。曾经想过目标车型为标致2008，后来更换为马六，后来更换为昂科塞拉。曾经痴迷到在马路上见到不认识的车型就打开汽车之家的app来查看详情的地步。</p>
<p>但后来来北京工作后，之前做饭和骑自行车上班的时光都变成了在公司上班，也就没有了时间来听汽车广播，渐渐的对汽车的兴趣在逐渐下降，直到现在再也不关注任何和汽车相关的信息。</p>
<p>通过此来看，兴趣是可以培养的，但培养起来的兴趣，一旦放下了，兴趣就会逐渐淡掉，直到恢复到最初的状态。</p>
<h2 id="旅游"><a href="#旅游" class="headerlink" title="旅游"></a>旅游</h2><p>说来惭愧，2015年没有任何的旅行计划。我唯一的一次旅行是公司校园招聘时在哈尔滨稍微转了下。曾多少次家人建议出去旅行，都被我否决了。理由要么是不愿跟团，要么时间不够，要么自己不愿去，要么考虑钱的问题。</p>
<h2 id="游戏"><a href="#游戏" class="headerlink" title="游戏"></a>游戏</h2><p>最近几年每到周末是必然会晚上几盘dota的，主要是用来放松，另外也有点玩游戏的瘾。我之所以一直没有戒掉玩游戏，是因为我心里清楚到了一定的年龄段对dota自然不就感兴趣了。只是没想到来的这么快，近几个月对游戏玩的越来越少，有时候一周都不会晚上一次了，而且也没有特别想玩的冲动了。</p>
<p>也许是因为玩游戏需要久坐，而久坐容易腰痛，也许是因为我现在已经达到了特定的年龄段，总之，都在说明，我在变老，精力确实没有之前旺盛了。</p>
<h1 id="展望"><a href="#展望" class="headerlink" title="展望"></a>展望</h1><ul>
<li>深入学习各种技术，技术更上多层楼。</li>
<li>至少要旅行一次，期望的目的地是日本或韩国，如果实在不行就国内。</li>
<li>期望能学会自由泳，蝶泳估计没戏。</li>
<li>多加强台球的练习。</li>
<li>熟悉下北京，多转转北京，去过的地方还非常非常的少。</li>
<li>如果有时间的话，多学一些锻炼智力的游戏，比如魔方。</li>
<li>工作中提高些效率，多一些生活。</li>
<li>多读英文技术文档。</li>
<li>多参加一些技术交流活动或其他活动。</li>
<li>…</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/mydog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404频道">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404频道">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/mydog/" class="post-title-link" itemprop="url">『狗』的故事</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-01-23 00:00:00" itemprop="dateCreated datePublished" datetime="2016-01-23T00:00:00+00:00">2016-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-06 13:25:06" itemprop="dateModified" datetime="2024-03-06T13:25:06+00:00">2024-03-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本文讲述的是我家狗的普通一生，我家的狗即没有名贵的种族，也没有喜人的外貌，就是农村家中最常见的看家狗。</p>
<p><img src="http://kuring.qiniudn.com/gougou2.JPG" alt="image"></p>
<p>狗的一生中连个正儿八经的名字都没有，父母平日里呼唤狗都是我们那方言中通用的『嗷（一声）嗷(三声)嗷（一声）』（我们那方言对家里的牲口都有一种特殊的呼唤方式），而我通常会通过舌头跟上颚发出的声音来呼唤。以至于在写本文时，我不知道该如何称呼了，只能约定俗成为『狗』。</p>
<p>『狗』在家中的作用为看家护院的作用，在村中养狗的目的大抵如此，狗的作用也仅仅是传统意义上的一条狗。村民们还没有清闲到靠养狗来娱乐的地步，何况邻里邻外的都认识，随便找个人都能聊上个把小时，靠拉呱聊天来娱乐比遛狗更丰富直接。</p>
<p>自打我记事起，家里共养过三只狗，第一只养了至少五年的样子，最终已经记不清楚为何而失去了，或是因为出去走丢了，亦或是因为误食了东西而死去。第三只狗是只有种族的狗，仅仅是中间的过客，确实家人的最爱，有个优雅的名字『点点』，仅此一点就能将此『狗』秒杀N条街，事实也是如此。</p>
<p>家中也养过一些其他的动物，猪、猫、鸡等。猪等到长肥了也就卖掉了，也就四五个月的样子。小时候家里养过母猪，估计也得有个五年以上，但母猪除了吃和睡之外，似乎也没啥了。猫养过多只，确实跟有些猫是有感情的，但大都比较短暂，猫经常跑出去就回不来了。有些鸡在家里也养过四五年，但鸡给我留下的印象中除了吃和下蛋之外，就剩下美味的鸡汤了。唯独『狗』在家中的时间最长，在家中的地位也最高，给家里的贡献也是最大的，给我留下的印象也是颇为深刻。</p>
<p>『狗』大概是我在刚上初中那会，父亲从集市上花了15或者30元钱抑或60元买的。刚买来的时候记得还不满月的样子，特别的可爱，白灰色毛居多，背上有个大大的灰黑色大圆点，不正不斜圆心就在脊梁骨的位置，而且圆是非常的标准的圆，头和尾巴是黄色的毛。由于小，不会造成什么破坏，就直接放在屋子总天天跑，我们吃饭时，它就在下面转啊转，等待着给点馒头或者菜来吃，一见到有东西吃，那尾巴就摇啊摇，摇啊摇。有时候在屋子里碍事了，我就用手揪住它背上的肉皮，扔到一边去，不一会又会回来，然后又让我给揪到一边去，这样揪来揪去的好好玩，听大人们说，这样狗是不疼的。</p>
<p>揪着揪着『狗』就这样被我揪大了，大了之后自然要发挥指责了，总不能天天让家里白白养着，凡事必然有其存在价值，它的价值就是看家护院。这样一干可就是一辈子，它的一辈子就在家里不大的院子里面绕着铁链转，转啊转，直到再也没有力气转下去。自从被拴上铁链的时刻开始，直到生命的最后一刻，再也没有进过曾经在饭桌底下绕啊绕找食物的屋子，饭桌下再也容不下它。</p>
<p>『狗』的看家还是非常尽职尽责，当然了，要不怎么是狗呢。只要是家里来的是陌生人，都会咬个不停，甚至是我爷爷来我家，都会咬个不停。要是觉得听起来太吵了，只要对它喊一声「狗」就会消停很多，跟家人的默契配合的相当不错。</p>
<p>『狗』的记性也是相当不错的，记得上高中时，一个月只能回一次家，每次回家狗都会认识，从来不会当成陌生人狂咬。后来，上了大学，成了半年回一次家了，刚进家门狗就开始叫，也就是脚踏进院子没多久，狗就不叫了，已经认出我也曾经是这里的主人。每次回家都会跟『狗』玩上半天，喂点吃的，挠挠肚子，看着它围着我转。</p>
<p>虽然对陌生人总是咬个不停，但是当人走到旁边时却不会上去咬人，对它凶点甚至还会吓得跑到狗窝里去，完全不是疯狗那样会咬人。但也确实咬过一次人，记得那是上高一那会，姨夫在我家喝多了，走到它旁边，它还在不停的咬，姨夫由于喝的多，对其踹了几脚，抑或身上酒味过重，这下『狗』可不干了，照着姨夫的脚脖子就咬了一口。这是已知的仅有的一次咬人经历。</p>
<p>『狗』是母狗，大概一岁多的时候生过三只狗，其中两只已经夭折了，另外一只目前在我爷爷家里养着。家里来陌生人时，狗都会从狗窝猛然间钻出来，仿佛早发现一会陌生人就能领到奖赏一般。两只小狗的死都是它猛然间出来时将正在吃奶的小狗用铁链给带出来摔死的，挺可怜的。不知是不是脑子缺根筋，看家的本领远比看护自己孩子来的高超，就好比在休产假的妈妈，却天天想着工作，自此之后再也没生过小狗。</p>
<p>『狗』的一声是用铁链禁锢的一生，成年后99%的时光都是用铁链拴着的，比互联网公司的服务可靠性都好的多。偶尔铁链会松掉，它仍然不知道自己的地盘之外仍然可以活动，直到偶然间走出了自己的活动范围，才发现原来自己的地盘外也可以肆意走动了，不过美好的时光不会太长，因为等着家人发现了，禁锢的铁链又跑到自己的脖子里了。有时家人发现的不及时，发现它又回到了原地了，也许它发现原来曾经向往的陌生地方也不过如此，远没有自己的地盘来的安全可靠和温馨。</p>
<p><img src="http://kuring.qiniudn.com/gougou1.JPG" alt="image"></p>
<p>记得有一次冬天大雾，能见度非常低，『狗』跑出了家门，一路向北，由于雾太大，迷失了方向。我跑出去在家附近找了半个小时未果，爷爷骑着自行车出去打听到别人看见过，父亲终于在离家二里地外的地方找到了，也是虚惊一场。</p>
<p>『狗』对吃得从来不挑，只要有吃的就行。记得之前家里还喂猪的时候，它就在旁边等着猪们吃完后再去吃猪剩下的，每次都会把猪槽舔的溜滑，比可以刷过的还干净。后来家里不喂猪了，就在喂鸡的时候一块喂一下。夏天吃完西瓜后，把西瓜皮扔过去，狗也可以啃得仅剩下一层薄薄的皮。偶尔忘记喂了，『狗』就会zhengzheng的叫，家人自然也能领悟『狗』的意图。</p>
<p>大约刚开始工作那会，姑家的狗『点点』由于没时间照顾在我家里养了半年，『点点』是姐姐给取的名字，长得一副小巧可爱样，在城市的笼子中靠吃狗粮长大。在我们那喂狗几乎是不用狗粮的，估计也买不到，因为没市场。『点点』自然是不能跟『狗』吃一样的，每天都会味一些狗粮，后来家人就买了些过期的方便面和馒头搀和着来喂，而『狗』的主食依旧是吃着跟鸡一样的凉水活玉米面。『点点』白天都在笼子里，只有放出来的时候才会找个地方拉屎撒尿，自然比随地大小便的『狗』更讨人喜欢。晚上『点点』是放在院子里的，院子里的任何角落都是『点点』的活动范围，这点也是『狗』可望不可及的。白天『点点』的笼子是放在大门下的，逢人从门口经过都能看到可人的样子，自然也会吸引很多人的目光。</p>
<p><img src="http://kuring.qiniudn.com/goudiandian.jpg" alt="image"></p>
<p>也就是从『点点』刚来我家的时候，发现有时候从它身旁经过，它都没有任何反应了，因为『狗』的耳朵不好用了。人老了耳朵会聋，狗亦如此。有时候陌生人都进到家里了，发现『狗』仍然在狗窝里或外面太阳下睡觉，即使耳朵是贴在地面上的。狗天生骄傲的就是耳朵，试想一名工程师如果不能用双手敲代码，那怎么称之为码农。</p>
<p>自从『狗』聋了后，明显感觉到『狗』的情绪变得低沉了，也许是因为耳朵不好用了，也许是进入晚年了，也许是因为『点点』的缘故，虽贵为正室，却不再受宠幸。直到半年后的『点点』走后，也一直没有缓过来。</p>
<p>近几年，我每次回家都能感受到『狗』是一年不如一年，最后一次见到是在2015年的十一，那时它很多时候都是趴在窝里睡觉的，除了看家，也没啥本事，既然看家技能已失，那就只能睡觉了。</p>
<p>2016.1.22傍晚听到了『狗』去世的消息，脑海中自然也是联想关于『狗』的往事，历历在目，眼角泪花直流。没有任何仪式，『狗』悄悄的离开了奉献了自己一生的岗位，摆脱了束缚了自己一辈子的锁链，黯然离开了自己的主人。</p>
<p>当天天气极度寒冷，应该是一年中最冷的天气了，家中下起了大雪，也许是老天送给『狗』的葬礼，雪花仿佛跟『狗』的灵魂一般纯洁。</p>
<p>算下来从2000年左右到现在该有16岁的样子了，这16年是我人生中最年轻的时光，我从懵懂的少年已变成了社会中的青年，却是『狗』的一生。</p>
<p>下图是2016.1.22上午时的照片，已经生命垂危，生命在倒计时。</p>
<p><img src="http://kuring.qiniudn.com/gougou3.jpg" alt="image"></p>
<hr>
<p>一个月前，父亲又弄了条小狗，凑巧的是，小狗的模样跟『狗』长的颇为相似，毛色也一致，甚至连背上也有一个灰黑色的圆点。虽没当面见过，但看小狗的照片不禁联想到『狗』的小时候仿佛是狗的小时候，这也许是『狗』的生命的延续。</p>
<p><img src="http://kuring.qiniudn.com/gouxiaogou.jpg" alt="image"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/13/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/15/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder"></span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  




<script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"kuring/kuring.github.io","repo_id":"MDEwOlJlcG9zaXRvcnkyODM4MzQ0NTk=","category":"Announcements","category_id":"DIC_kwDOEOr4W84CdeTU","mapping":"pathname","reactions_enabled":1,"emit_metadata":1,"theme":"light","lang":"zh-CN","crossorigin":"anonymous","input_position":"bottom","loading":"lazy"}</script>

<script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.page.comments) return;

  NexT.utils.loadComments('.giscus-container')
    .then(() => NexT.utils.getScript('https://giscus.app/client.js', {
      attributes: {
        async                   : true,
        crossOrigin             : 'anonymous',
        'data-repo'             : CONFIG.giscus.repo,
        'data-repo-id'          : CONFIG.giscus.repo_id,
        'data-category'         : CONFIG.giscus.category,
        'data-category-id'      : CONFIG.giscus.category_id,
        'data-mapping'          : CONFIG.giscus.mapping,
        'data-reactions-enabled': CONFIG.giscus.reactions_enabled,
        'data-emit-metadata'    : CONFIG.giscus.emit_metadata,
        'data-theme'            : CONFIG.giscus.theme,
        'data-lang'             : CONFIG.giscus.lang,
        'data-input-position'   : CONFIG.giscus.input_position,
        'data-loading'          : CONFIG.giscus.loading
      },
      parentNode: document.querySelector('.giscus-container')
    }));
});
</script>

</body>
</html>
