<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"kuring.me","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":true,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="404é¢‘é“">
<meta property="og:url" content="http://kuring.me/index.html">
<meta property="og:site_name" content="404é¢‘é“">
<meta property="og:locale">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://kuring.me/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-Hans","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>404é¢‘é“</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">404é¢‘é“</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å­¦ä¹ ç¬”è®°</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">243</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/kuring" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;kuring" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/gzh-coze/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/gzh-coze/" class="post-title-link" itemprop="url">å¾®ä¿¡å…¬ä¼—å·é€šè¿‡æ‰£å­æ¥å…¥å¤§æ¨¡å‹</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-06-19 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-19T00:00:00+00:00">2024-06-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>åœ¨å­—èŠ‚çš„ AI å‘å¸ƒå¹³å°<a target="_blank" rel="noopener" href="https://www.coze.cn/">æ‰£å­</a>ä¸­æä¾›äº†åˆ›å»ºæœºå™¨äººçš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥å¯¹æ¥å¾®ä¿¡å…¬ä¼—å·ï¼Œä½¿ç”¨åœ¨å¾®ä¿¡å…¬ä¼—å·ä¸­å›å¤æ¶ˆæ¯ï¼Œç”±å¤§æ¨¡å‹ç›´æ¥å›å¤çš„æ•ˆæœã€‚</p>
<h1 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h1><p>æ•´ä½“æ“ä½œæ­¥éª¤éå¸¸ç®€å•ï¼Œéœ€è¦ç”³è¯·ä¸€ä¸ª Coze çš„è´¦å·å’Œå¼€é€šå¾®ä¿¡å…¬ä¼—å·çš„å¼€å‘è€…åŠŸèƒ½ã€‚</p>
<p>å¾®ä¿¡å…¬ä¼—å·çš„å¼€å‘è€…åŠŸèƒ½åœ¨è¿™é‡Œé…ç½®ï¼š<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/20240619211112.png" alt="image.png"></p>
<p>ç‚¹å‡»<code>åˆ›å»º Bot</code> æŒ‰é’®ï¼Œè¾“å…¥ Bot åç§°åç‚¹å‡»<code>ç¡®è®¤</code>ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/20240619210355.png" alt="image.png|570"></p>
<p>åœ¨æœºå™¨äººè®¾ç½®é¡µé¢ï¼Œå¯ä»¥é…ç½®æ¨¡å‹ã€é€‰æ‹©è‡ªå·±è®­ç»ƒçš„çŸ¥è¯†åº“ç­‰æ“ä½œã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/20240619210909.png" alt="image.png"></p>
<p>è®¾ç½®å®Œæˆåï¼Œç‚¹å‡»<code>å‘å¸ƒ</code>ï¼Œé€‰æ‹©<code>å¾®ä¿¡å…¬ä¼—å·ï¼ˆè®¢é˜…å·ï¼‰</code>é…ç½®åŠŸèƒ½ï¼Œè®¾ç½®å¯¹åº”çš„å¾®ä¿¡å…¬ä¼—å·çš„ AppIDã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/20240619211019.png" alt="image.png"></p>
<h1 id="ä½“éªŒ"><a href="#ä½“éªŒ" class="headerlink" title="ä½“éªŒ"></a>ä½“éªŒ</h1><p>è®¿é—®å…¬ä¼—å·ç›´æ¥è¾“å…¥å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°è‡ªåŠ¨å›å¤å†…å®¹ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/IMG_3856.PNG.JPG" alt="IMG_3856.PNG.JPG"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/mi-gpt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/mi-gpt/" class="post-title-link" itemprop="url">ä½¿ç”¨ mi-gpt å°†å°çˆ±éŸ³ç®±æ¥å…¥å¤§æ¨¡å‹</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-06-13 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-13T00:00:00+00:00">2024-06-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>æ— æ„é—´å‘ç°äº†å¼€æºé¡¹ç›® <a target="_blank" rel="noopener" href="https://github.com/idootop/mi-gpt">mi-gpt</a>ï¼Œè¯¥é¡¹ç›®å¯ä»¥å°†å®¶é‡Œçš„å°çˆ±éŸ³ç®±æ¥å…¥åˆ° GPT ä¸­ï¼Œå¢å¼ºå°çˆ±éŸ³ç®±çš„åŠŸèƒ½ã€‚åœ¨è·Ÿå°çˆ±éŸ³ç®±å¯¹è¯çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥æ ¹æ®ç‰¹å®šçš„æç¤ºè¯èµ° GPT æ¥å›ç­”ï¼Œè€Œä¸æ˜¯ç”¨å°çˆ±éŸ³ç®±åŸç”Ÿçš„å›å¤ã€‚</p>
<p>å¿…å¤‡æ¡ä»¶ï¼š</p>
<ol>
<li>å¿…é¡»æœ‰ä¸€ä¸ªå°ç±³éŸ³ç®±ã€‚</li>
<li>å¿…é¡»è¦æœ‰å¯ä»¥é•¿æœŸè¿è¡Œçš„æœåŠ¡å™¨ï¼Œå¯ä»¥æ˜¯æ ‘è“æ´¾ç­‰è®¾å¤‡ã€‚</li>
<li>è¦æœ‰ä¸€ä¸ª OpenAI çš„è´¦å·ï¼Œä¹Ÿå¯ä»¥ç”¨å…¼å®¹ ChatGPT API çš„å›½å†…å¤§æ¨¡å‹ã€‚</li>
</ol>
<h1 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h1><p>éƒ¨ç½²æ¯”è¾ƒç®€å•ï¼Œä¸‹é¢ä¸ºæˆ‘çš„éƒ¨ç½²è¿‡ç¨‹ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚æ›´è¯¦ç»†çš„ä¿¡æ¯å¤§å®¶å¯ä»¥ç›´æ¥å‚è€ƒ github é¡¹ç›®ä¸­çš„<a target="_blank" rel="noopener" href="https://github.com/idootop/mi-gpt/tree/main/docs">ç›¸å…³æ–‡æ¡£</a>ã€‚</p>
<h2 id="åˆ›å»ºé…ç½®æ–‡ä»¶-migpt-jsï¼š"><a href="#åˆ›å»ºé…ç½®æ–‡ä»¶-migpt-jsï¼š" class="headerlink" title="åˆ›å»ºé…ç½®æ–‡ä»¶ .migpt.jsï¼š"></a>åˆ›å»ºé…ç½®æ–‡ä»¶ <code>.migpt.js</code>ï¼š</h2><p>å‚è€ƒé¡¹ç›®ä¸­çš„æ–‡ä»¶ <a target="_blank" rel="noopener" href="https://github.com/idootop/mi-gpt/blob/main/.migpt.example.js">.migpt.example.js</a>å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">// å°çˆ±éŸ³ç®±æ‰®æ¼”è§’è‰²çš„ç®€ä»‹</span><br><span class="line">const botProfile = `</span><br><span class="line">æ€§åˆ«ï¼šå¥³</span><br><span class="line">æ€§æ ¼ï¼šä¹–å·§å¯çˆ±</span><br><span class="line">çˆ±å¥½ï¼šå–œæ¬¢ææ€ªï¼Œçˆ±åƒé†‹ã€‚</span><br><span class="line">`;</span><br><span class="line"></span><br><span class="line">// å°çˆ±éŸ³ç®±ä¸»äººï¼ˆä½ ï¼‰çš„ç®€ä»‹</span><br><span class="line">const masterProfile = `</span><br><span class="line">æ€§åˆ«ï¼šç”·</span><br><span class="line">æ€§æ ¼ï¼šå–„è‰¯æ­£ç›´</span><br><span class="line">å…¶ä»–ï¼šæ€»æ˜¯èˆå·±ä¸ºäººï¼Œæ˜¯å‚»å¦çš„ä¸»äººã€‚</span><br><span class="line">`;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  bot: &#123;</span><br><span class="line">    name: &quot;å‚»å¦&quot;,</span><br><span class="line">    profile: botProfile,</span><br><span class="line">  &#125;,</span><br><span class="line">  master: &#123;</span><br><span class="line">    name: &quot;é™†å°åƒ&quot;,</span><br><span class="line">    profile: masterProfile,</span><br><span class="line">  &#125;,</span><br><span class="line">  speaker: &#123;</span><br><span class="line">    // å°ç±³ ID</span><br><span class="line">    userId: &quot;12345&quot;, // æ³¨æ„ï¼šä¸æ˜¯æ‰‹æœºå·æˆ–é‚®ç®±ï¼Œè¯·åœ¨ã€Œä¸ªäººä¿¡æ¯ã€-ã€Œå°ç±³ IDã€æŸ¥çœ‹</span><br><span class="line">    // è´¦å·å¯†ç </span><br><span class="line">    password: &quot;xxx&quot;,</span><br><span class="line">    // å°çˆ±éŸ³ç®± ID æˆ–åœ¨ç±³å®¶ä¸­è®¾ç½®çš„åç§°</span><br><span class="line">    did: &quot;Redmiå°çˆ±è§¦å±éŸ³ç®±8&quot;,</span><br><span class="line">    // å½“æ¶ˆæ¯ä»¥ä¸‹é¢çš„å…³é”®è¯å¼€å¤´æ—¶ï¼Œä¼šè°ƒç”¨ AI æ¥å›å¤æ¶ˆæ¯</span><br><span class="line">    callAIKeywords: [&quot;è¯·&quot;, &quot;ä½ &quot;, &quot;å‚»å¦&quot;],</span><br><span class="line">    // å½“æ¶ˆæ¯ä»¥ä¸‹é¢çš„å…³é”®è¯å¼€å¤´æ—¶ï¼Œä¼šè¿›å…¥ AI å”¤é†’çŠ¶æ€</span><br><span class="line">    wakeUpKeywords: [&quot;æ‰“å¼€&quot;, &quot;è¿›å…¥&quot;, &quot;å¬å”¤&quot;],</span><br><span class="line">    // å½“æ¶ˆæ¯ä»¥ä¸‹é¢çš„å…³é”®è¯å¼€å¤´æ—¶ï¼Œä¼šé€€å‡º AI å”¤é†’çŠ¶æ€</span><br><span class="line">    exitKeywords: [&quot;å…³é—­&quot;, &quot;é€€å‡º&quot;, &quot;å†è§&quot;],</span><br><span class="line">    </span><br><span class="line">    // è¿›å…¥ AI æ¨¡å¼çš„æ¬¢è¿è¯­</span><br><span class="line">    onEnterAI: [&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯å‚»å¦ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ &quot;],</span><br><span class="line">    </span><br><span class="line">    // é€€å‡º AI æ¨¡å¼çš„æç¤ºè¯­</span><br><span class="line">    onExitAI: [&quot;å‚»å¦å·²é€€å‡º&quot;],</span><br><span class="line">    </span><br><span class="line">    // AI å¼€å§‹å›ç­”æ—¶çš„æç¤ºè¯­</span><br><span class="line">    onAIAsking: [&quot;è®©æˆ‘å…ˆæƒ³æƒ³&quot;, &quot;è¯·ç¨ç­‰&quot;],</span><br><span class="line">    </span><br><span class="line">    // AI ç»“æŸå›ç­”æ—¶çš„æç¤ºè¯­</span><br><span class="line">    onAIReplied: [&quot;æˆ‘è¯´å®Œäº†&quot;, &quot;è¿˜æœ‰å…¶ä»–é—®é¢˜å—&quot;],</span><br><span class="line">    </span><br><span class="line">    // AI å›ç­”å¼‚å¸¸æ—¶çš„æç¤ºè¯­</span><br><span class="line">    onAIError: [&quot;å•Šå“¦ï¼Œå‡ºé”™äº†ï¼Œè¯·ç¨åå†è¯•å§ï¼&quot;],</span><br><span class="line">    </span><br><span class="line">    // æ— å“åº”ä¸€æ®µæ—¶é—´åï¼Œå¤šä¹…è‡ªåŠ¨é€€å‡ºå”¤é†’æ¨¡å¼ï¼ˆé»˜è®¤ 30 ç§’ï¼‰</span><br><span class="line">    exitKeepAliveAfter: 30,</span><br><span class="line">    </span><br><span class="line">    // TTS æŒ‡ä»¤ï¼Œè¯·åˆ° https://home.miot-spec.com æŸ¥è¯¢å…·ä½“æŒ‡ä»¤</span><br><span class="line">    ttsCommand: [3, 1],</span><br><span class="line">    </span><br><span class="line">    // è®¾å¤‡å”¤é†’æŒ‡ä»¤ï¼Œè¯·åˆ° https://home.miot-spec.com æŸ¥è¯¢å…·ä½“æŒ‡ä»¤</span><br><span class="line">    wakeUpCommand: [3, 2],</span><br><span class="line">    </span><br><span class="line">    // æ˜¯å¦å¯ç”¨æµå¼å“åº”ï¼Œéƒ¨åˆ†å°çˆ±éŸ³ç®±å‹å·ä¸æ”¯æŒæŸ¥è¯¢æ’­æ”¾çŠ¶æ€ï¼Œæ­¤æ—¶éœ€è¦å…³é—­æµå¼å“åº”</span><br><span class="line">    streamResponse: false,</span><br><span class="line">    </span><br><span class="line">    // æŸ¥è¯¢æ˜¯å¦åœ¨æ’­æ”¾ä¸­æŒ‡ä»¤ï¼Œè¯·åˆ° https://home.miot-spec.com æŸ¥è¯¢å…·ä½“æŒ‡ä»¤</span><br><span class="line">    playingCommand: [2, 1, 1], // é»˜è®¤æ— éœ€é…ç½®æ­¤å‚æ•°ï¼Œæ’­æ”¾å‡ºç°é—®é¢˜æ—¶å†å°è¯•å¼€å¯</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å¿…é¡»è¦ä¿®æ”¹çš„å†…å®¹æ¶‰åŠåˆ°å¦‚ä¸‹å­—æ®µï¼Œå…¶ä»–å­—æ®µå¯ä»¥æ ¹æ®å«ä¹‰æ¥å®šä¹‰ï¼š</p>
<ol>
<li>speaker.userIdï¼šå°ç±³çš„ç”¨æˆ· IDã€‚</li>
<li>speaker.passwordï¼šå°ç±³çš„è´¦å·å¯†ç ã€‚</li>
<li>speaker.didï¼šå°çˆ±éŸ³ç®±çš„ ID æˆ–è€…å°çˆ±éŸ³ç®±åœ¨ç±³å®¶çš„è®¾å¤‡åå­—ã€‚</li>
<li>ttsCommandï¼šéœ€è¦è®¾ç½®ã€‚å¦‚æœè®¾ç½®ä¸æ­£å¸¸ï¼Œä¼šå¯¼è‡´å°çˆ±éŸ³ç®±æ— æ³•æ’­æ”¾ GPT å›å¤å†…å®¹çš„æƒ…å†µã€‚</li>
<li>wakeUpCommandï¼šéœ€è¦è®¾ç½®ã€‚</li>
<li>streamResponseï¼šåœ¨æŸäº›éŸ³ç®±è®¾å¤‡ä¸Šéœ€è¦å…³é—­ã€‚æˆ‘çš„è®¾å¤‡å› ä¸ºæ— æ³•è¯»å®Œå®Œæ•´çš„å¥å­ï¼Œé€‰æ‹©äº†å…³é—­è¯¥åŠŸèƒ½ï¼Œç›¸å…³å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/idootop/mi-gpt/blob/main/docs/faq.md#q%E5%B0%8F%E7%88%B1%E9%9F%B3%E7%AE%B1%E6%B2%A1%E6%9C%89%E8%AF%BB%E5%AE%8C%E6%95%B4%E4%B8%AA%E5%8F%A5%E5%AD%90%E6%80%BB%E6%98%AF%E6%88%9B%E7%84%B6%E8%80%8C%E6%AD%A2">å°çˆ±éŸ³ç®±æ²¡æœ‰è¯»å®Œæ•´ä¸ªå¥å­ï¼Œæ€»æ˜¯æˆ›ç„¶è€Œæ­¢</a>ã€‚</li>
</ol>
<p>ttsCommand å’Œ wakeUpCommand éœ€è¦åœ¨ <a target="_blank" rel="noopener" href="https://home.miot-spec.com/">https://home.miot-spec.com</a> é¡µé¢æœç´¢å¯¹åº”çš„éŸ³ç®±å‹å·<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/20240612234942.png" alt="image.png"></p>
<p>ç‚¹å‡»è§„æ ¼åä»»é€‰ä¸€ä¸ªï¼Œé€‰æ‹© <code>Intelligent Speaker</code>ï¼Œå…¶ä¸­çš„ <code>[3, 1]</code> å¯¹åº”çš„ä¸º ttsCommandï¼Œ<code>[3, 2]</code> å¯¹åº”çš„ä¸º wakeUpCommandã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/20240612235825.png" alt="image.png"></p>
<h2 id="åˆ›å»ºé…ç½®æ–‡ä»¶-env"><a href="#åˆ›å»ºé…ç½®æ–‡ä»¶-env" class="headerlink" title="åˆ›å»ºé…ç½®æ–‡ä»¶ .env"></a>åˆ›å»ºé…ç½®æ–‡ä»¶ <code>.env</code></h2><p>è¯¥æ–‡ä»¶ä¸­éœ€è¦é…ç½® OPENAI çš„è´¦å·ä¿¡æ¯ï¼Œæˆ‘è¿™é‡Œç›´æ¥é‡‡ç”¨äº†é˜¿é‡Œäº‘çš„é€šä¹‰åƒé—®å¤§æ¨¡å‹æœåŠ¡ï¼Œ<a target="_blank" rel="noopener" href="https://help.aliyun.com/zh/dashscope/developer-reference/compatibility-of-openai-with-dashscope/">API æ˜¯å®Œå…¨å…¼å®¹çš„</a>ã€‚</p>
<p>å‚è€ƒæ–‡æ¡£ã€Š<a target="_blank" rel="noopener" href="https://help.aliyun.com/zh/dashscope/developer-reference/activate-dashscope-and-create-an-api-key">å¼€é€šDashScopeå¹¶åˆ›å»ºAPI-KEY</a>ã€‹ é˜¿é‡Œäº‘ä¸Šå¼€é€šå¤§æ¨¡å‹æœåŠ¡ï¼Œè·å–åˆ° API-KEY<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/20240611230914.png" alt="image.png"></p>
<p>å‚è€ƒé¡¹ç›®ä¸­çš„æ–‡ä»¶<a target="_blank" rel="noopener" href="https://github.com/idootop/mi-gpt/blob/main/.env.example">.env.example</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># OpenAIï¼ˆä¹Ÿæ”¯æŒé€šä¹‰åƒé—®ã€MoonShotã€DeepSeek ç­‰æ¨¡å‹ï¼‰</span><br><span class="line">OPENAI_MODEL=qwen-turbo</span><br><span class="line">OPENAI_API_KEY=è·å–åˆ°çš„API_KEY</span><br><span class="line">OPENAI_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1</span><br><span class="line"></span><br><span class="line"># Azure OpenAI Serviceï¼ˆå¯é€‰ï¼‰</span><br><span class="line"># OPENAI_API_VERSION=2024-04-01-preview</span><br><span class="line"># AZURE_OPENAI_API_KEY=ä½ çš„å¯†é’¥</span><br><span class="line"># AZURE_OPENAI_ENDPOINT=https://ä½ çš„èµ„æºå.openai.azure.com</span><br><span class="line"># AZURE_OPENAI_DEPLOYMENT=ä½ çš„æ¨¡å‹éƒ¨ç½²åï¼Œæ¯”å¦‚ï¼šgpt-35-turbo-instruct</span><br><span class="line"></span><br><span class="line"># æç¤ºéŸ³æ•ˆï¼ˆå¯é€‰ï¼Œä¸€èˆ¬ä¸ç”¨å¡«ï¼Œä½ ä¹Ÿå¯ä»¥æ¢ä¸Šè‡ªå·±çš„æç¤ºéŸ³é“¾æ¥è¯•è¯•çœ‹æ•ˆæœï¼‰</span><br><span class="line"># AUDIO_SILENT=é™éŸ³éŸ³é¢‘é“¾æ¥ï¼Œç¤ºä¾‹ï¼šhttps://example.com/slient.wav</span><br><span class="line"># AUDIO_BEEP=é»˜è®¤æç¤ºéŸ³é“¾æ¥ï¼ŒåŒä¸Š</span><br><span class="line"># AUDIO_ACTIVE=å”¤é†’æç¤ºéŸ³é“¾æ¥ï¼ŒåŒä¸Š</span><br><span class="line"># AUDIO_ERROR=å‡ºé”™äº†æç¤ºéŸ³é“¾æ¥ï¼ŒåŒä¸Š</span><br><span class="line"></span><br><span class="line"># Doubao TTSï¼ˆå¯é€‰ï¼Œç”¨äºè°ƒç”¨ç¬¬ä¸‰æ–¹ TTS æœåŠ¡ï¼Œæ¯”å¦‚ï¼šè±†åŒ…ï¼‰</span><br><span class="line"># TTS_DOUBAO=è±†åŒ… TTS æ¥å£</span><br><span class="line"># SPEAKERS_DOUBAO=è±†åŒ… TTS éŸ³è‰²åˆ—è¡¨æ¥å£</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦ä¿®æ”¹å¦‚ä¸‹ä¸¤ä¸ªå€¼ï¼š</p>
<ol>
<li>OPENAI_API_KEYï¼šå³ä¸ºä¸Šæ–‡è·å–åˆ°é˜¿é‡Œäº‘<a target="_blank" rel="noopener" href="https://help.aliyun.com/zh/dashscope/">æ¨¡å‹æœåŠ¡çµç§¯</a>çš„ API-KEYã€‚</li>
<li>OPENAI_MODELï¼šæ”¯æŒçš„æ¨¡å‹ï¼Œå¯ä»¥åœ¨ã€Š<a target="_blank" rel="noopener" href="https://help.aliyun.com/zh/dashscope/developer-reference/compatibility-of-openai-with-dashscope/#7f9c78ae99pwz">æ”¯æŒçš„æ¨¡å‹åˆ—è¡¨</a>ã€‹ä¸­æŸ¥è¯¢æ¨¡å‹åˆ—è¡¨ã€‚</li>
</ol>
<h2 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h2><p>æä¾›äº†ä¸¤ç§æ–¹å¼ï¼šdocker å’Œ å®¿ä¸»æœº Node.js æ–¹å¼è¿è¡Œï¼Œæˆ‘è‡ªç„¶ä¼šé€‰æ‹©æ›´åŠ ç®€æ´çš„ docker æ–¹å¼ã€‚</p>
<p>æ‰§è¡Œ <code>docker run -d --name mi-gpt --env-file $(pwd)/.env -v $(pwd)/.migpt.js:/app/.migpt.js idootop/mi-gpt:3.1.0</code> å³å¯æœ¬åœ°è¿è¡Œã€‚</p>
<h1 id="åŠŸèƒ½æ¼”ç¤º"><a href="#åŠŸèƒ½æ¼”ç¤º" class="headerlink" title="åŠŸèƒ½æ¼”ç¤º"></a>åŠŸèƒ½æ¼”ç¤º</h1><p>æé—®å°çˆ±åŒå­¦ï¼šâ€œè¯·é—®ä¸€ä¸‹å¤ªé˜³çš„é‡é‡æ˜¯å¤šå°‘â€ï¼Œå°çˆ±åŒå­¦å¯ä»¥é¡ºåˆ©çš„å›ç­”å‡ºç­”æ¡ˆã€‚</p>
<p>é€šè¿‡ <code>docker logs mi-gpt -f</code> å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡ºæ—¥å¿—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2024/06/12 16:15:38 Speaker ğŸ”¥ è¯·é—®ä¸€ä¸‹å¤ªé˜³çš„é‡é‡æ˜¯å¤šå°‘</span><br><span class="line"></span><br><span class="line">2024/06/12 16:15:38 Speaker ğŸ”Š è®©æˆ‘å…ˆæƒ³æƒ³</span><br><span class="line"></span><br><span class="line">2024/06/12 16:15:41 Open AI âœ… Answer: å‚»å¦: å“¦ï¼Œå¤ªé˜³çš„é‡é‡å¯å¤§äº†ï¼Œå®ƒæ˜¯ä¸ªæ’æ˜Ÿï¼Œæ¯”æˆ‘ä»¬çš„åœ°çƒé‡å¾—å¤šã€‚ç§‘å­¦å®¶ä»¬ç”¨çš„æ˜¯è´¨é‡è€Œä¸æ˜¯é‡é‡æ¥è¡¡é‡ï¼Œå¤ªé˜³çš„è´¨é‡å¤§çº¦æ˜¯åœ°çƒçš„333,000å€ï¼ŒçœŸæ˜¯ä¸ªè¶…çº§å¤§å—å¤´ï¼Œæƒ³æƒ³å¦‚æœå®ƒèƒ½å˜æˆæ£‰èŠ±ç³–ï¼Œé‚£å¾—å¤šè½¯å¤šäº®å•Šï¼ä¸è¿‡ï¼Œå¤ªé˜³å¯¹æˆ‘ä»¬æ¥è¯´å¤ªé¥è¿œäº†ï¼Œå®ƒçš„é‡é‡å’±ä»¬è¿˜æ˜¯åˆ«å»æŠ±äº†ï¼Œå“ˆå“ˆã€‚</span><br><span class="line"></span><br><span class="line">2024/06/12 16:15:41 Speaker ğŸ”Š å‚»å¦: å“¦ï¼Œå¤ªé˜³çš„é‡é‡å¯å¤§äº†ï¼Œå®ƒæ˜¯ä¸ªæ’æ˜Ÿï¼Œæ¯”æˆ‘ä»¬çš„åœ°çƒé‡å¾—å¤šã€‚ç§‘å­¦å®¶ä»¬ç”¨çš„æ˜¯è´¨é‡è€Œä¸æ˜¯é‡é‡æ¥è¡¡é‡ï¼Œå¤ªé˜³çš„è´¨é‡å¤§çº¦æ˜¯åœ°çƒçš„333,000å€ï¼ŒçœŸæ˜¯ä¸ªè¶…çº§å¤§å—å¤´ï¼Œæƒ³æƒ³å¦‚æœå®ƒèƒ½å˜æˆæ£‰èŠ±ç³–ï¼Œé‚£å¾—å¤šè½¯å¤šäº®å•Šï¼ä¸è¿‡ï¼Œå¤ªé˜³å¯¹æˆ‘ä»¬æ¥è¯´å¤ªé¥è¿œäº†ï¼Œå®ƒçš„é‡é‡å’±ä»¬è¿˜æ˜¯åˆ«å»æŠ±äº†ï¼Œå“ˆå“ˆ</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/k8s/k8s-authenticate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/k8s/k8s-authenticate/" class="post-title-link" itemprop="url">k8s ä¸­çš„ç”¨æˆ·è®¤è¯æ–¹å¼</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-04-22 00:00:00" itemprop="dateCreated datePublished" datetime="2024-04-22T00:00:00+00:00">2024-04-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>åœ¨ k8s ä¸­åŒ…å«ä¸¤ç±»ç”¨æˆ·ï¼š</p>
<ol>
<li>ServiceAccountã€‚åˆç§°æœåŠ¡è´¦å·ï¼Œåœ¨è¿è¡Œ pod æ—¶å¿…é¡»ç»‘å®š ServiceAccountï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™ä½¿ç”¨å½“å‰ namespace ä¸‹çš„ ServiceAccount defaultã€‚æ˜¯é’ˆå¯¹ç¨‹åºè€Œè¨€ï¼Œç”¨äº pod ä¸­çš„ç¨‹åºè®¿é—® kube-apiserverã€‚</li>
<li>æ™®é€šç”¨æˆ·ã€‚åœ¨ k8s ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨å•ç‹¬çš„å¯¹è±¡æ¥å­˜å‚¨ï¼Œè€Œæ˜¯é€šè¿‡äº†åˆ†å‘è¯ä¹¦ã€å¤–éƒ¨ç”¨æˆ·è®¤è¯ç³»ç»Ÿç­‰æ–¹å¼å®ç°ï¼Œæ˜¯é’ˆå¯¹ç”¨æˆ·è€Œè¨€ã€‚</li>
</ol>
<h1 id="1-X509-è¯ä¹¦è®¤è¯"><a href="#1-X509-è¯ä¹¦è®¤è¯" class="headerlink" title="1. X509 è¯ä¹¦è®¤è¯"></a>1. X509 è¯ä¹¦è®¤è¯</h1><p>ä½¿ç”¨åœºæ™¯ï¼šä½¿ç”¨ kubectl è®¿é—® k8s é›†ç¾¤å³é€šè¿‡ X509 è¯ä¹¦è®¤è¯æ–¹å¼ï¼Œkubeconfig æœ¬è´¨ä¸Šæ˜¯ä¸ªè¯ä¹¦æ–‡ä»¶ã€‚</p>
<p>å®¢æˆ·ç«¯ä½¿ç”¨è¯ä¹¦ä¸­çš„ Common Name ä½œä¸ºè¯·æ±‚çš„ç”¨æˆ·åï¼Œorganization ä½œä¸ºç”¨æˆ·ç»„çš„æˆå‘˜ä¿¡æ¯ã€‚</p>
<p>è¯ä¹¦çš„ç­¾å‘å¯ä»¥ä½¿ç”¨ opensslã€cfssl ç­‰å·¥å…·æ¥ç­¾å‘ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ k8s è‡ªå¸¦çš„ CertificateSigningRequest å¯¹è±¡æ¥å®ç°ç­¾å‘ã€‚</p>
<h2 id="1-1-CertificateSigningRequest-ç­¾å‘è¯ä¹¦"><a href="#1-1-CertificateSigningRequest-ç­¾å‘è¯ä¹¦" class="headerlink" title="1.1. CertificateSigningRequest ç­¾å‘è¯ä¹¦"></a>1.1. CertificateSigningRequest ç­¾å‘è¯ä¹¦</h2><p>åˆ›å»ºç§é’¥ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out myuser.key 2048</span><br><span class="line">openssl req -new -key myuser.key -out myuser.csr -subj &quot;/CN=myuser&quot;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºå¦‚ä¸‹çš„ CertificateSigningRequest å¯¹è±¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF | kubectl apply -f -</span><br><span class="line">apiVersion: certificates.k8s.io/v1</span><br><span class="line">kind: CertificateSigningRequest</span><br><span class="line">metadata:</span><br><span class="line">  name: myuser</span><br><span class="line">spec:</span><br><span class="line">  # value ä½¿ç”¨å‘½ä»¤ cat myuser.csr | base64 | tr -d &quot;\n&quot; è·å–</span><br><span class="line">  request: xxx</span><br><span class="line">  # å›ºå®šå€¼</span><br><span class="line">  signerName: kubernetes.io/kube-apiserver-client</span><br><span class="line">  # è¿‡æœŸæ—¶é—´</span><br><span class="line">  expirationSeconds: 86400  # one day</span><br><span class="line">  usages:</span><br><span class="line">  - client auth</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ csr å¤„äº Pending çŠ¶æ€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get csr</span><br><span class="line">NAME     AGE   SIGNERNAME                            REQUESTOR          REQUESTEDDURATION   CONDITION</span><br><span class="line">myuser   12s   kubernetes.io/kube-apiserver-client   kubernetes-admin   24h                 Pending</span><br></pre></td></tr></table></figure>

<p>æ‰¹å‡†ç»™è¯ä¹¦ç­¾å‘è¯·æ±‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl certificate approve myuser</span><br></pre></td></tr></table></figure>

<p>ç­¾å‘å®Œæˆåçš„è¯ä¹¦ä¼šå­˜æ”¾åˆ° status.certificate å­—æ®µä¸­ï¼Œè‡³æ­¤è¯ä¹¦ç­¾å‘å®Œæˆã€‚</p>
<h1 id="2-ServiceAccount"><a href="#2-ServiceAccount" class="headerlink" title="2. ServiceAccount"></a>2. ServiceAccount</h1><p>ä½¿ç”¨åœºæ™¯ï¼šè¯¥æ–¹å¼ä½¿ç”¨è¾ƒä¸ºå¸¸è§ï¼Œç”¨äº pod ä¸­è®¿é—® k8s apiserverã€‚</p>
<p>åŸç†ï¼špod å¯ä»¥é€šè¿‡ spec.serviceAccountName å­—æ®µæ¥æŒ‡å®šè¦ä½¿ç”¨çš„ ServiceAccountï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šåˆ™ä½¿ç”¨ namespace ä¸‹é»˜è®¤çš„ default ServiceAccountã€‚kube-controller-manager ä¸­çš„ ServiceAccount æ§åˆ¶å™¨ä¼šåœ¨æ‹‰èµ·çš„ pod ä¸­è‡ªåŠ¨æ³¨å…¥å¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">spec:</span><br><span class="line">  volumeMounts: </span><br><span class="line">  - mountPath: /var/run/secrets/kubernetes.io/serviceaccount</span><br><span class="line">    name: kube-api-access-j6vpz</span><br><span class="line">    readOnly: true</span><br><span class="line">  volumes:</span><br><span class="line">  - name: kube-api-access-j6vpz</span><br><span class="line">    projected:</span><br><span class="line">      defaultMode: 420</span><br><span class="line">      sources:</span><br><span class="line">      - serviceAccountToken:</span><br><span class="line">          expirationSeconds: 3607</span><br><span class="line">          path: token</span><br><span class="line">      - configMap:</span><br><span class="line">          items:</span><br><span class="line">          - key: ca.crt</span><br><span class="line">            path: ca.crt</span><br><span class="line">          name: kube-root-ca.crt</span><br><span class="line">      - downwardAPI:</span><br><span class="line">          items:</span><br><span class="line">          - fieldRef:</span><br><span class="line">              apiVersion: v1</span><br><span class="line">              fieldPath: metadata.namespace</span><br><span class="line">            path: namespace</span><br></pre></td></tr></table></figure>

<p>å³å°†ä¿¡æ¯æ³¨å…¥åˆ° pod çš„ &#x2F;var&#x2F;run&#x2F;secrets&#x2F;kubernetes.io&#x2F;serviceaccount ç›®å½•ä¸‹ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/var/run/secrets/kubernetes.io/serviceaccount</span><br><span class="line">|-- ca.crt -&gt; ..data/ca.crt</span><br><span class="line">|-- namespace -&gt; ..data/namespace</span><br><span class="line">`-- token -&gt; ..data/token</span><br></pre></td></tr></table></figure>

<p>token ä¸º JWT è®¤è¯ï¼Œå¯¹å…¶æ ¼å¼è§£å¯†åå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;RS256&quot;,</span><br><span class="line">  &quot;kid&quot;: &quot;u7rF5JCtJRNiMzSUOFAYvDpCwPqUII-N-OtxR59cnQ0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;iss&quot;: &quot;kubernetes/serviceaccount&quot;,</span><br><span class="line">  &quot;kubernetes.io/serviceaccount/namespace&quot;: &quot;default&quot;,</span><br><span class="line">  &quot;kubernetes.io/serviceaccount/secret.name&quot;: &quot;ingress-token-s9gtm&quot;,</span><br><span class="line">  &quot;kubernetes.io/serviceaccount/service-account.name&quot;: &quot;ingress&quot;,</span><br><span class="line">  &quot;kubernetes.io/serviceaccount/service-account.uid&quot;: &quot;19ce4f11-7105-43ce-b189-f3d71a2ffc74&quot;,</span><br><span class="line">  &quot;sub&quot;: &quot;system:serviceaccount:default:ingress&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-1-Secret-å­˜æ”¾-token"><a href="#2-1-Secret-å­˜æ”¾-token" class="headerlink" title="2.1. Secret å­˜æ”¾ token"></a>2.1. Secret å­˜æ”¾ token</h2><p>åœ¨ 1.22 ç‰ˆæœ¬åŠä¹‹å‰ç‰ˆæœ¬ä¸­ï¼Œtoken ä»¥ Secret çš„å½¢å¼å­˜åœ¨äº pod æ‰€åœ¨çš„ namespace ä¸‹ï¼Œä¸” token ä¸ä¼šè¿‡æœŸã€‚Secret çš„åå­—å­˜åœ¨äº ServiceAccount çš„ spec ä¸­ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">secrets:</span><br><span class="line">- name: nginx-token-scjvn</span><br></pre></td></tr></table></figure>

<p>è€Œ Secret é€šè¿‡ Annotation <code>kubernetes.io/service-account.name</code> æŒ‡å®šäº†å…³è”çš„ ServiceAccountã€‚</p>
<p>åœ¨åç»­ç‰ˆæœ¬ä¸­ï¼Œä¸ºäº†å…¼å®¹å½“å‰æ–¹æ¡ˆï¼Œå¦‚æœ ServiceAccount å…³è”äº† Secretï¼Œåˆ™è®¤ä¸ºä»ç„¶ä½¿ç”¨ Secret ä¸­å­˜æ”¾ token çš„æ–¹å¼ã€‚å¦‚æœ Secret å·²ç»å¾ˆé•¿æ—¶é—´æ²¡æœ‰ä½¿ç”¨ï¼Œåˆ™è‡ªåŠ¨å›æ”¶ Secretã€‚</p>
<p>å¦‚æœè¦æ‰‹å·¥åˆ›å»ºä¸€ä¸ª token Secretï¼Œå¯ä»¥åˆ›å»ºå¦‚ä¸‹çš„ Secretï¼Œk8s è‡ªåŠ¨ä¼šä¸º Secret äº§ç”Ÿ tokenï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  name: build-robot-secret</span><br><span class="line">  annotations:</span><br><span class="line">    # å¸¦æœ‰ annotation</span><br><span class="line">    kubernetes.io/service-account.name: build-robot</span><br><span class="line">type: kubernetes.io/service-account-token</span><br></pre></td></tr></table></figure>

<h2 id="2-2-TokenRequest-API-äº§ç”Ÿ-token"><a href="#2-2-TokenRequest-API-äº§ç”Ÿ-token" class="headerlink" title="2.2. TokenRequest API äº§ç”Ÿ token"></a>2.2. TokenRequest API äº§ç”Ÿ token</h2><p>åœ¨ 1.22 ä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼Œkubelet ä½¿ç”¨ TokenRequest API è·å–æœ‰æ—¶é—´é™åˆ¶çš„ä¸´æ—¶ tokenï¼Œè¯¥ token</p>
<p>ä¼šåœ¨ pod åˆ é™¤æˆ–è€… token ç”Ÿå‘½å‘¨æœŸï¼ˆé»˜è®¤ä¸º 1hï¼‰ç»“æŸåå¤±æ•ˆã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ <code>kubectl create token default</code> æ¥ä¸º ServiceAccount default åˆ›å»º tokenï¼Œè¯¥å‘½ä»¤å®é™…ä¸Šå‘ kube-apiserver å‘é€äº†è¯·æ±‚ <code>/api/v1/namespaces/default/serviceaccounts/default/token</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;kind&quot;: &quot;TokenRequest&quot;,</span><br><span class="line">    &quot;apiVersion&quot;: &quot;authentication.k8s.io/v1&quot;,</span><br><span class="line">    &quot;metadata&quot;:</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;creationTimestamp&quot;: null</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;spec&quot;:</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;audiences&quot;: null,</span><br><span class="line">        &quot;expirationSeconds&quot;: null,</span><br><span class="line">        &quot;boundObjectRef&quot;: null</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;status&quot;:</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;token&quot;: &quot;&quot;,</span><br><span class="line">        &quot;expirationTimestamp&quot;: null</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>kube-apiserver æ”¯æŒå¦‚ä¸‹å‚æ•°ï¼š</p>
<ol>
<li>â€“service-account-key-fileï¼šç”¨æ¥éªŒè¯æœåŠ¡è´¦å·çš„ tokenã€‚</li>
<li>â€“service-account-issuerï¼šServiceAccount token çš„ç­¾å‘æœºæ„ã€‚</li>
<li>â€“service-account-signing-key-fileï¼šServiceAccount token çš„ç­¾å‘ç§é’¥ã€‚</li>
</ol>
<h1 id="3-ç”¨æˆ·ä¼ªè£…"><a href="#3-ç”¨æˆ·ä¼ªè£…" class="headerlink" title="3. ç”¨æˆ·ä¼ªè£…"></a>3. ç”¨æˆ·ä¼ªè£…</h1><p>ä¸€ä¸ªç”¨æˆ·é€šè¿‡ Http Header Impersonation- çš„æ–¹å¼æ¥æ‰®æ¼”å¦å¤–ä¸€ä¸ªç”¨æˆ·çš„èº«ä»½ã€‚</p>
<p>åœºæ™¯ï¼šè·¨ k8s é›†ç¾¤è®¿é—®çš„ç½‘å…³æœåŠ¡</p>
<p>æ”¯æŒçš„ Http Header å¦‚ä¸‹ï¼š</p>
<ol>
<li>Impersonate-Userï¼šè¦ä¼ªè£…çš„ç”¨æˆ·åã€‚</li>
<li>Impersonate-Groupï¼šè¦ä¼ªè£…çš„ç»„åã€‚è¯¥ Header å¯ä»¥ä¸ºå¤šä¸ªï¼Œå³æ”¯æŒå¤šä¸ªç»„ã€‚</li>
</ol>
<h1 id="4-bootstrap-token"><a href="#4-bootstrap-token" class="headerlink" title="4. bootstrap token"></a>4. bootstrap token</h1><p>ä½¿ç”¨ kube-apiserver å‚æ•° <code>--enable-bootstrap-token-auth=true</code> å¯ç”¨åŠŸèƒ½ï¼Œå¼•å¯¼ token ä»¥ Secret çš„å½¢å¼å­˜æ”¾åœ¨ kube-system ä¸‹ã€‚</p>
<p>è¯¥åŠŸèƒ½ä»…ç”¨äºèŠ‚ç‚¹åˆå§‹åŒ–æ—¶åŠ å…¥åˆ° k8s é›†ç¾¤ä¸­ã€‚</p>
<h1 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/authentication/">ç”¨æˆ·è®¤è¯</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/k8s-apiserver-request-limit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/k8s-apiserver-request-limit/" class="post-title-link" itemprop="url">k8s apiserver çš„é™æµ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-04-07 15:34:37" itemprop="dateCreated datePublished" datetime="2024-04-07T15:34:37+00:00">2024-04-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="client-ç«¯é™æµ"><a href="#client-ç«¯é™æµ" class="headerlink" title="client ç«¯é™æµ"></a>client ç«¯é™æµ</h1><p>åœ¨ client-go ä¸­ä¼šé»˜è®¤å¯¹å®¢æˆ·ç«¯è¿›è¡Œé™æµï¼Œå¹¶å‘åº¦ä¸º 5ã€‚å¯ä»¥é€šè¿‡ä¿®æ”¹ rest.Conifg æ¥ä¿®æ”¹å¹¶å‘åº¦ã€‚</p>
<h1 id="MaxInFlightLimit-é™æµ"><a href="#MaxInFlightLimit-é™æµ" class="headerlink" title="MaxInFlightLimit é™æµ"></a>MaxInFlightLimit é™æµ</h1><p>é€šè¿‡å¦‚ä¸‹å‚æ•°æ¥æ§åˆ¶ï¼š</p>
<ul>
<li>â€“max-requests-inflightï¼šä»£è¡¨åªè¯»è¯·æ±‚çš„æœ€å¤§å¹¶å‘é‡</li>
<li>â€“max-mutating-requests-inflightï¼šä»£è¡¨å†™è¯·æ±‚çš„æœ€å¤§å¹¶å‘é‡</li>
</ul>
<p>è¯¥å®ç°ä¸ºå•ä¸ª kube-apiserver å±‚é¢çš„ï¼Œå¯ä»¥é’ˆå¯¹æ‰€æœ‰çš„è¯·æ±‚ã€‚</p>
<h1 id="EventRateLimit"><a href="#EventRateLimit" class="headerlink" title="EventRateLimit"></a>EventRateLimit</h1><p>ç”¨æ¥å¯¹ Event ç±»å‹çš„å¯¹è±¡è¿›è¡Œé™åˆ¶ï¼Œå¯ä»¥é€šè¿‡ kube-apiserver çš„å‚æ•° â€“admission-control-config-file æ¥æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apiserver.config.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">AdmissionConfiguration</span></span><br><span class="line"><span class="attr">plugins:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">EventRateLimit</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">eventconfig.yaml</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ EventRateLimit ä¸ºå¯¹ Event çš„é™åˆ¶ï¼Œeventconfig.yaml æ–‡ä»¶ä¸ºè¯¦ç»†çš„å¯¹ Event çš„é™æµç­–ç•¥ï¼Œå¯ä»¥ç²¾ç¡®åˆ° Namespace å’Œ User ä¿¡æ¯ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">eventratelimit.admission.k8s.io/v1alpha1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Configuration</span></span><br><span class="line"><span class="attr">limits:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">Namespace</span></span><br><span class="line">    <span class="attr">qps:</span> <span class="number">50</span></span><br><span class="line">    <span class="attr">burst:</span> <span class="number">100</span></span><br><span class="line">    <span class="attr">cacheSize:</span> <span class="number">2000</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">User</span></span><br><span class="line">    <span class="attr">qps:</span> <span class="number">10</span></span><br><span class="line">    <span class="attr">burst:</span> <span class="number">50</span></span><br></pre></td></tr></table></figure>
<h1 id="API-ä¼˜å…ˆçº§å’Œå…¬å¹³æ€§"><a href="#API-ä¼˜å…ˆçº§å’Œå…¬å¹³æ€§" class="headerlink" title="API ä¼˜å…ˆçº§å’Œå…¬å¹³æ€§"></a>API ä¼˜å…ˆçº§å’Œå…¬å¹³æ€§</h1><p>ç‰ˆæœ¬çŠ¶æ€ï¼š</p>
<ol>
<li>alphaï¼š1.18</li>
</ol>
<p>é€šè¿‡ kube-apiserver çš„å‚æ•° <code>--enable-priority-fairness</code> æ¥æ§åˆ¶æ˜¯å¦å¼€å¯ APF ç‰¹æ€§ã€‚</p>
<h1 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://qingwave.github.io/k8s-rate-limit/">kubernetes apiserveré™æµæ–¹æ¡ˆ</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/concepts/cluster-administration/flow-control/">API ä¼˜å…ˆçº§å’Œå…¬å¹³æ€§</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/k8s-numa/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/k8s-numa/" class="post-title-link" itemprop="url">k8s ä¸­çš„ numa äº²å’Œæ€§</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-03-22 20:08:26" itemprop="dateCreated datePublished" datetime="2024-03-22T20:08:26+00:00">2024-03-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œk8s å¯¹äº pod åœ¨å•ä¸ªèŠ‚ç‚¹çš„èµ„æºåˆ†é…å¹¶ä¸ä¼šè€ƒè™‘åˆ° NUMA æ¶æ„ã€‚æ¯”å¦‚ cpu é»˜è®¤ä¼šé‡‡ç”¨ cgroup CFS æ¥åšèµ„æºçš„åˆ†é…ï¼Œå¹¶æœªè€ƒè™‘åˆ° NUMA æ¶æ„ã€‚ä¸ºäº†æå‡ pod çš„æ€§èƒ½ï¼Œéœ€è¦ pod åœ¨åˆ†é…èµ„æºæ—¶æ„ŸçŸ¥ NUMA æ¶æ„ã€‚<br />ä¸ºæ­¤ï¼Œk8s åœ¨ kubelet ä¸­é€šè¿‡ CPU Managerã€Memory Managerã€Device Managerã€Topology Manager ç­‰ç‰¹æ€§å¯¹ NUMA åšäº†æ”¯æŒï¼Œæ”¯æŒçš„ pod QoS ç±»å‹è¦æ±‚ä¸º Granteed podã€‚<br />å„ç‰¹æ€§çš„æ”¯æŒç‰ˆæœ¬æƒ…å†µå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>alpha</th>
<th>beta</th>
<th>stable</th>
</tr>
</thead>
<tbody><tr>
<td>CPU Manager</td>
<td></td>
<td>1.12</td>
<td>1.26</td>
</tr>
<tr>
<td>Memory Manager</td>
<td>1.21</td>
<td>1.22</td>
<td>-</td>
</tr>
<tr>
<td>Topology Manager</td>
<td>1.16</td>
<td>1.18</td>
<td>-</td>
</tr>
</tbody></table>
<h1 id="CPU-Manager"><a href="#CPU-Manager" class="headerlink" title="CPU Manager"></a>CPU Manager</h1><p>åœ¨ k8s ä¸­ä½¿ç”¨ cgroup çš„ CFS é…é¢æ¥æ‰§è¡Œ pod çš„ CPU çº¦æŸï¼Œåœ¨ CFS çš„æ¨¡å¼ä¸‹ï¼Œpod å¯èƒ½ä¼šè¿è¡Œåœ¨ä¸åŒçš„æ ¸ä¸Šï¼Œä¼šå¯¼è‡´ pod çš„ç¼“å­˜å¤±æ•ˆçš„é—®é¢˜ã€‚å¯¹äºæ€§èƒ½è¦æ±‚éå¸¸é«˜çš„ podï¼Œä¸ºäº†æå‡æ€§èƒ½ï¼Œå¯ä»¥é€šè¿‡ cgroup ä¸­çš„ cpuset ç»‘æ ¸çš„ç‰¹æ€§æ¥æå‡ pod çš„æ€§èƒ½ã€‚</p>
<p>åœ¨ k8s ä¸­ä»…é’ˆå¯¹å¦‚ä¸‹çš„ pod ç±»å‹åšäº†ç»‘æ ¸æ“ä½œï¼š</p>
<ol>
<li>å¿…é¡»ä¸º guaranteed pod ç±»å‹ã€‚å³ pod éœ€è¦æ»¡è¶³å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š<ol>
<li>pod ä¸­çš„æ¯ä¸ªå®¹å™¨éƒ½å¿…é¡»æŒ‡å®šcpu å’Œ å†…å­˜çš„ request å’Œ limitã€‚</li>
<li>pod ä¸­çš„æ¯ä¸ªå®¹å™¨çš„ cpu å’Œå†…å­˜çš„ request å’Œ limit å¿…é¡»ç›¸ç­‰ã€‚</li>
</ol>
</li>
<li>pod çš„ cpu request å’Œ limit å¿…é¡»ä¸ºæ•´æ•°ã€‚</li>
</ol>
<h2 id="kubelet-çš„å‚æ•°é…ç½®"><a href="#kubelet-çš„å‚æ•°é…ç½®" class="headerlink" title="kubelet çš„å‚æ•°é…ç½®"></a>kubelet çš„å‚æ•°é…ç½®</h2><p>åœ¨ k8s ä¸­ä»…é€šè¿‡ kubelet æ¥æ”¯æŒ pod çš„ç»‘æ ¸æ“ä½œï¼Œè·Ÿå…¶ä»–ç»„ä»¶æ— å…³ã€‚<br />kubelet é€šè¿‡å‚æ•° <code>--cpu-manager-policy</code> æˆ–è€…åœ¨ kubelet çš„é…ç½®æ–‡ä»¶ä¸­å‚æ•°<code>cpuManagerPolicy</code> æ¥é…ç½®ï¼Œæ”¯æŒå¦‚ä¸‹å€¼ï¼š</p>
<ol>
<li>noneï¼šé»˜è®¤ç­–ç•¥ã€‚å³ä¸æ‰§è¡Œç»‘æ ¸æ“ä½œã€‚</li>
<li>staticï¼šå…è®¸ä¸ºèŠ‚ç‚¹ä¸Šçš„æŸäº›ç‰¹å¾çš„ pod èµ‹äºˆå¢å¼ºçš„ cpu äº²å’Œæ€§å’Œç‹¬å æ€§ã€‚</li>
</ol>
<p>kubelet é€šè¿‡å‚æ•° <code>--cpu-manager-reconcile-period</code> æ¥æŒ‡å®šå†…å­˜ä¸­çš„ cpu åˆ†é…è·Ÿ cgroupfs ä¸€è‡´ã€‚<br />kubelet é€šè¿‡å‚æ•° <code>--cpu-manager-policy-options</code>æ¥å¾®è°ƒã€‚è¯¥ç‰¹æ€§é€šè¿‡ç‰¹æ€§é—¨æ§ CPUManagerPolicyOptions æ¥æ§åˆ¶ã€‚</p>
<h2 id="æ¨¡å¼ä¹‹é—´åˆ‡æ¢"><a href="#æ¨¡å¼ä¹‹é—´åˆ‡æ¢" class="headerlink" title="æ¨¡å¼ä¹‹é—´åˆ‡æ¢"></a>æ¨¡å¼ä¹‹é—´åˆ‡æ¢</h2><p>é»˜è®¤çš„ kubelet <code>cpuManagerPolicy</code> é…ç½®ä¸º noneï¼Œç­–ç•¥é…ç½®ä½äºæ–‡ä»¶ <code>/var/lib/kubelet/cpu_manager_state</code>ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;policyName&quot;</span><span class="punctuation">:</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span><span class="attr">&quot;defaultCpuSet&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;checksum&quot;</span><span class="punctuation">:</span><span class="number">1353318690</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ kubelet çš„<code>cpuManagerPolicy</code> ä¸º staticï¼Œå°†æ¨¡å¼ä» none åˆ‡æ¢ä¸º staticï¼Œé‡å¯ kubeletã€‚å‘ç° kubelet ä¼šå¯åŠ¨å¤±è´¥ï¼Œkubelet å¹¶ä¸èƒ½æ”¯æŒä»…ä¿®æ”¹å‚æ•°å°±åˆ‡æ¢æ¨¡å¼ï¼ŒæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mar 06 15:00:02 iZt4nd5yyw9vfuxn3q2g3tZ kubelet[102800]: E0306 15:00:02.463939  102800 cpu_manager.go:223] &quot;Could not initialize checkpoint manager, please drain node and remove policy state file&quot; err=&quot;could not restore state from checkpoint: configured policy \&quot;static\&quot; differs from state checkpoint policy \&quot;none\&quot;, please drain this node and delete the CPU manager checkpoint file \&quot;/var/lib/kubelet/cpu_manager_state\&quot; before restarting Kubelet&quot;</span><br><span class="line">Mar 06 15:00:02 iZt4nd5yyw9vfuxn3q2g3tZ kubelet[102800]: E0306 15:00:02.463972  102800 kubelet.go:1392] &quot;Failed to start ContainerManager&quot; err=&quot;start cpu manager error: could not restore state from checkpoint: configured policy \&quot;static\&quot; differs from state checkpoint policy \&quot;none\&quot;, please drain this node and delete the CPU manager checkpoint file \&quot;/var/lib/kubelet/cpu_manager_state\&quot; before restarting Kubelet&quot;</span><br></pre></td></tr></table></figure>
<p>å°†æ–‡ä»¶ <code>/var/lib/kubelet/cpu_manager_state</code> åˆ é™¤åï¼Œkubelet å³å¯å¯åŠ¨æˆåŠŸï¼Œæ–°åˆ›å»ºçš„ <code>/var/lib/kubelet/cpu_manager_state</code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;policyName&quot;:&quot;static&quot;,&quot;defaultCpuSet&quot;:&quot;0-3&quot;,&quot;checksum&quot;:611748604&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å·²ç»å­˜åœ¨äº†ç»‘æ ¸çš„ podã€‚</p>
<p>å¦‚æœèŠ‚ç‚¹ä¸Šå·²ç»å­˜åœ¨ç¬¦åˆç»‘æ ¸æ¡ä»¶çš„ podï¼Œåœ¨ä¿®æ”¹é…ç½®å¹¶é‡å¯ kubelet åå³å¯ç»‘æ ¸ç”Ÿæ•ˆã€‚</p>
<h2 id="ç»‘æ ¸å®è·µ"><a href="#ç»‘æ ¸å®è·µ" class="headerlink" title="ç»‘æ ¸å®è·µ"></a>ç»‘æ ¸å®è·µ</h2><p>é…ç½® kubelet çš„<code>cpuManagerPolicy</code>å€¼ä¸º staticï¼Œåˆ›å»º guaranteed podï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx-deployment</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">        <span class="attr">resources:</span></span><br><span class="line">          <span class="attr">limits:</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;200Mi&quot;</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;2&quot;</span></span><br><span class="line">          <span class="attr">requests:</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;200Mi&quot;</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;2&quot;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ pod è°ƒåº¦çš„èŠ‚ç‚¹ä¸Šï¼Œè¿›å…¥åˆ° &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset&#x2F;kubepods.slice ç›®å½•ä¸‹ï¼Œè·Ÿç»‘æ ¸ç›¸å…³çš„è®¾ç½®å‡åœ¨è¯¥ç›®å½•ä¸‹ï¼Œè¯¥ç›®å½•çš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ ll /sys/fs/cgroup/cpuset/kubepods.slice</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cgroup.clone_children</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cgroup.procs</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.cpu_exclusive</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.cpus</span><br><span class="line">-r--r--r--  1 root root 0 Mar  6 10:31 cpuset.effective_cpus</span><br><span class="line">-r--r--r--  1 root root 0 Mar  6 10:31 cpuset.effective_mems</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.mem_exclusive</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.mem_hardwall</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.memory_migrate</span><br><span class="line">-r--r--r--  1 root root 0 Mar  6 10:31 cpuset.memory_pressure</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.memory_spread_page</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.memory_spread_slab</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.mems</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.sched_load_balance</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 cpuset.sched_relax_domain_level</span><br><span class="line">drwxr-xr-x  2 root root 0 Mar  6 10:31 kubepods-besteffort.slice</span><br><span class="line">drwxr-xr-x 10 root root 0 Mar  6 10:31 kubepods-burstable.slice</span><br><span class="line">drwxr-xr-x  4 root root 0 Mar  6 15:09 kubepods-pod4dc3ad18_5bad_4728_9f79_59f2378de46e.slice</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 notify_on_release</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 pool_size</span><br><span class="line">-rw-r--r--  1 root root 0 Mar  6 10:31 tasks</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ kubepods-besteffort.slice å’Œ kubepods-burstable.slice åˆ†åˆ«å¯¹åº”çš„ besteffort å’Œ burstable ç±»å‹çš„ pod é…ç½®ï¼Œå› ä¸ºè¿™ä¸¤ç§ç±»å‹çš„ pod å¹¶ä¸æ‰§è¡Œç»‘æ ¸æ“ä½œï¼Œæ‰€æœ‰çš„å­ç›®å½•ä¸‹çš„ cpuset.cpus æ–‡ä»¶å‡ç»‘å®šçš„ cpu æ ¸ã€‚<br />kubepods-pod4dc3ad18_5bad_4728_9f79_59f2378de46e.slice ç›®å½•ä¸ºè¦ç»‘æ ¸çš„ pod ç›®å½•ï¼Œå…¶ä¸­ 4dc3ad18_5bad_4728_9f79_59f2378de46e æ ¹æ® pod çš„ uid è½¬æ¢è€Œæ¥ï¼Œpod çš„ <code>metadata.uid</code> å­—æ®µçš„å€¼ä¸º 4dc3ad18-5bad-4728-9f79-59f2378de46eï¼Œå³ç›®å½•ç»“æ„ä¸­å°†<code>-</code>è½¬æ¢ä¸º<code>_</code>ã€‚<br />ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ ll /sys/fs/cgroup/cpuset/kubepods.slice/kubepods-pod4dc3ad18_5bad_4728_9f79_59f2378de46e.slice</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cgroup.clone_children</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cgroup.procs</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.cpu_exclusive</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.cpus</span><br><span class="line">-r--r--r-- 1 root root 0 Mar  6 15:09 cpuset.effective_cpus</span><br><span class="line">-r--r--r-- 1 root root 0 Mar  6 15:09 cpuset.effective_mems</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.mem_exclusive</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.mem_hardwall</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.memory_migrate</span><br><span class="line">-r--r--r-- 1 root root 0 Mar  6 15:09 cpuset.memory_pressure</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.memory_spread_page</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.memory_spread_slab</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.mems</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.sched_load_balance</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 cpuset.sched_relax_domain_level</span><br><span class="line">drwxr-xr-x 2 root root 0 Mar  6 15:09 cri-containerd-75f8e4b4185f673869604d300629ec2de934cf253244bf91c577f9fc0ba0f14a.scope</span><br><span class="line">drwxr-xr-x 2 root root 0 Mar  6 15:09 cri-containerd-cce0a338829921419407fcdc726d1a4bd5d4489da712b49a4834a020131ce718.scope</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 notify_on_release</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 pool_size</span><br><span class="line">-rw-r--r-- 1 root root 0 Mar  6 15:09 tasks</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ cri-containerd-75f8e4b4185f673869604d300629ec2de934cf253244bf91c577f9fc0ba0f14a.scope å’Œ cri-containerd-cce0a338829921419407fcdc726d1a4bd5d4489da712b49a4834a020131ce718.scope ä¸º pod çš„ä¸¤ä¸ªå®¹å™¨ï¼Œå…¶ä¸­ä¸€ä¸ªä¸º pause å®¹å™¨ï¼Œå¦å¤–ä¸€ä¸ªä¸º nginx å®¹å™¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ crictl pods | grep nginx-deploy</span><br><span class="line">cce0a33882992       6 hours ago         Ready               nginx-deployment-67778646bb-mgcpg                          default             0                   (default)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ç¬¬ä¸€åˆ—çš„ cce0a33882992 ä¸º pod idï¼Œcri-containerd-cce0a338829921419407fcdc726d1a4bd5d4489da712b49a4834a020131ce718.scope å¯¹åº”çš„ä¸º pause å®¹å™¨ï¼ŒæŸ¥çœ‹è¯¥ç›®å½•ä¸‹çš„ cpuset.cpus æ–‡ä»¶ï¼Œç»‘å®šäº†æ‰€æœ‰çš„æ ¸ï¼Œå¹¶æœªåšç»‘æ ¸æ“ä½œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ crictl ps | grep nginx-deploy</span><br><span class="line">75f8e4b4185f6       e4720093a3c13       6 hours ago         Running             nginx                      0                   cce0a33882992       nginx-deployment-67778646bb-mgcpg</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ç¬¬ä¸€åˆ—çš„ 75f8e4b4185f6 ä¸º container idï¼Œcri-containerd-75f8e4b4185f673869604d300629ec2de934cf253244bf91c577f9fc0ba0f14a.scope å¯¹åº”çš„ä¸º nginx å®¹å™¨ã€‚æŸ¥çœ‹ &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset&#x2F;kubepods.slice&#x2F;kubepods-pod4dc3ad18_5bad_4728_9f79_59f2378de46e.slice&#x2F;cri-containerd-75f8e4b4185f673869604d300629ec2de934cf253244bf91c577f9fc0ba0f14a.scope&#x2F;cpuset.cpus å¯¹åº”çš„å€¼ä¸º<code>2-3</code>ï¼Œè¯´æ˜ç»‘æ ¸æˆåŠŸã€‚</p>
<p><code>/var/lib/kubelet/cpu_manager_state</code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œè·Ÿ cgroup cpuset å®é™…é…ç½®å¯ä»¥å®Œå…¨å¯¹åº”ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;policyName&quot;:&quot;static&quot;,&quot;defaultCpuSet&quot;:&quot;0-1&quot;,&quot;entries&quot;:&#123;&quot;4dc3ad18-5bad-4728-9f79-59f2378de46e&quot;:&#123;&quot;nginx&quot;:&quot;2-3&quot;&#125;&#125;,&quot;checksum&quot;:3689800814&#125;</span><br></pre></td></tr></table></figure>

<h2 id="kubelet-å†…éƒ¨å®ç°"><a href="#kubelet-å†…éƒ¨å®ç°" class="headerlink" title="kubelet å†…éƒ¨å®ç°"></a>kubelet å†…éƒ¨å®ç°</h2><p>åœ¨ kubelet å†…éƒ¨ï¼Œé‡‡ç”¨ <a target="_blank" rel="noopener" href="https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/cm/cpumanager/cpu_manager.go">cpu manager</a> æ¨¡å¼å®ç°ç»‘æ ¸åŠŸèƒ½ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>åªèƒ½ by èŠ‚ç‚¹é…ç½®ï¼Œä¸èƒ½æŒ‰ç…§ pod æ¥çµæ´»çš„é…ç½®ã€‚</li>
<li>æ— æ³•é€‚ç”¨äºæ‰€æœ‰ç±»å‹çš„ podï¼Œpod å¿…é¡»ä¸º Guaranteed æ—¶æ‰å…è®¸å¼€å¯ã€‚</li>
<li>ä¿®å¤é…ç½®è¾ƒä¸ºéº»çƒ¦ï¼Œä¸€æ—¦é…ç½®å˜æ›´åï¼Œéœ€è¦åˆ é™¤æ–‡ä»¶ <code>/var/lib/kubelet/cpu_manager_state</code> åæ‰å¯ç”Ÿæ•ˆï¼Œè€Œä¸”å¯¹ç°æœ‰çš„ pod å‡æœ‰å½±å“ã€‚</li>
</ol>
<h1 id="Memory-Manager"><a href="#Memory-Manager" class="headerlink" title="Memory Manager"></a>Memory Manager</h1><h2 id="kubelet-ä¸­å‚æ•°é…ç½®"><a href="#kubelet-ä¸­å‚æ•°é…ç½®" class="headerlink" title="kubelet ä¸­å‚æ•°é…ç½®"></a>kubelet ä¸­å‚æ•°é…ç½®</h2><p>k8s 1.21 ç‰ˆæœ¬å¼•å…¥ï¼Œéœ€è¦ä½¿ç”¨ featuregate å¼€å¯ï¼Œå‚æ•° <code>--feature-gates=MemoryManager=true</code>ã€‚åœ¨k8s 1.22 ç‰ˆæœ¬ä¸º beta ç‰ˆæœ¬ï¼Œé»˜è®¤å¼€å¯ã€‚</p>
<p>kubelet é€šè¿‡å‚æ•° <code>--memory-manager-policy</code> æ¥é…ç½®å†…å­˜ç®¡ç†ç­–ç•¥ï¼Œæ”¯æŒå¦‚ä¸‹å€¼ï¼š</p>
<ol>
<li>noneï¼šé»˜è®¤ç­–ç•¥ï¼Œä¸æ‰§è¡Œä»»ä½•å†…å­˜åˆ†é…çš„ç­–ç•¥ã€‚</li>
<li>staticï¼šä»…é’ˆå¯¹ Guaranteed pod ç”Ÿæ•ˆï¼Œå¯¹äº Guaranteed podï¼Œä¼šè¿”å›è·Ÿ NUMA ç›¸å…³çš„ topology hint ä¿¡æ¯ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œä¼šä¿®æ”¹ cgroup cpuset.mems çš„é…ç½®ä¸ºå¯¹åº”çš„ cpu coreã€‚</li>
</ol>
<p>kubelet å°†å·²ç»åˆ†é…çš„ pod çš„å†…å­˜ç»‘å®šä¿¡æ¯ä½äºæ–‡ä»¶ <code>/var/lib/kubelet/memory_manager_state</code> ä¸­ï¼Œæ–‡ä»¶æ ¼å¼ä¸º jsonã€‚</p>
<h1 id="Topology-Manager"><a href="#Topology-Manager" class="headerlink" title="Topology Manager"></a>Topology Manager</h1><p>Topology Manager ç‰¹æ€§ç†è§£èµ·æ¥æ¯”è¾ƒæŠ½è±¡ã€‚ä¸¾ä¸ªä¾‹å­è¯´æ˜ï¼šä¸Šè¿°çš„ CPU Manager å’Œ Memory Manager çš„ç‰¹æ€§ï¼Œåœ¨ kubelet çš„å®ç°ä¸­æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ cpu å’Œå†…å­˜è¢«åˆ†é…åˆ°äº†ä¸åŒçš„ numa èŠ‚ç‚¹ä¸Šï¼ŒCPU Manager é€šè¿‡ cgroup çš„ cpuset.cpus æ¥æ§åˆ¶å®¹å™¨è¦ç»‘å®šçš„ cpuï¼Œè€Œ Memory Manager åˆ™é€šè¿‡ cgroup çš„ cpuset.mems æ¥æ§åˆ¶å®¹å™¨è¦ä½¿ç”¨çš„ NUMA node å†…å­˜ã€‚å¦‚æœä¸¤è€…çš„ä¿¡æ¯ä¸åŒ¹é…ï¼Œåˆ™ä¼šå¯¼è‡´è·¨ NUMA Node çš„å†…å­˜è®¿é—®ï¼Œä»è€Œä¼šå¯¹äºæ€§èƒ½è¦æ±‚é«˜çš„åº”ç”¨äº§ç”Ÿå½±å“ã€‚<br />Topology Manager æ˜¯ kubelet ä¸­çš„ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œé€šè¿‡ Hint Providers æ¥å‘é€å’Œæ¥æ”¶å„ä¸ªæ¨¡å—çš„ NUMA æ‹“æ‰‘ä¿¡æ¯ï¼Œæ¯”å¦‚æ¥æ”¶ CPU Manager å’Œ Memory Manager çš„ NUMA Nodeä»¥åŠ NUMA Node åˆ†é…çš„ä¼˜å…ˆçº§ã€‚</p>
<h2 id="kubelet-çš„å‚æ•°é…ç½®-1"><a href="#kubelet-çš„å‚æ•°é…ç½®-1" class="headerlink" title="kubelet çš„å‚æ•°é…ç½®"></a>kubelet çš„å‚æ•°é…ç½®</h2><p>kubelet é€šè¿‡å‚æ•°<code>--topology-manager-scope</code>æ¥æŒ‡å®šä½œç”¨åŸŸï¼š</p>
<ol>
<li>containerï¼šé»˜è®¤å€¼ï¼ŒæŒ‰ç…§å®¹å™¨çº§åˆ«åˆ†é…åˆ°å…±åŒçš„ NUMA node é›†åˆä¸Šã€‚</li>
<li>podï¼šå°† pod å†…çš„æ‰€æœ‰ container åˆ†é…åˆ°å…±åŒçš„ NUMA node é›†åˆä¸Šã€‚</li>
</ol>
<p>kubelet é€šè¿‡å‚æ•° <code>--topology-manager-policy</code> æ¥è®¾ç½® NUMA çš„åˆ†é…ç­–ç•¥ï¼š</p>
<ol>
<li>noneï¼šé»˜è®¤å€¼ï¼Œä¸æ‰§è¡Œä»»ä½•çš„æ‹“æ‰‘å¯¹é½ã€‚</li>
</ol>
<ul>
<li>best-effortï¼šä¼˜å…ˆé€‰æ‹©é¦–é€‰äº²å’Œæ€§çš„ NUMA nodeï¼Œå¦‚æœäº²å’Œæ€§ä¸æ»¡è¶³ï¼Œpod ä»ç„¶å¯ä»¥è°ƒåº¦æˆåŠŸã€‚</li>
<li>restrictedï¼šé€‰æ‹©é¦–é€‰äº²å’Œæ€§çš„ NUMA nodeï¼Œå¦‚æœäº²å’Œæ€§ä¸æ»¡è¶³ï¼Œpod è°ƒåº¦å¤±è´¥ã€‚</li>
<li>single-numa-nodeï¼šé€šè¿‡ Hint Provider è¿”å›çš„ç»“æœï¼Œåˆ¤æ–­å• NUMA èŠ‚ç‚¹çš„äº²å’Œæ€§æ˜¯å¦ï¼Œå¦‚æœä¸æ»¡è¶³ï¼Œåˆ™ pod è°ƒåº¦å¤±è´¥ã€‚</li>
</ul>
<h2 id="kubelet-ä¸­çš„å®ç°"><a href="#kubelet-ä¸­çš„å®ç°" class="headerlink" title="kubelet ä¸­çš„å®ç°"></a>kubelet ä¸­çš„å®ç°</h2><p>åœ¨ kubelet ä¸­å®šä¹‰äº†æ¥å£ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TopologyHint is a struct containing the NUMANodeAffinity for a Container</span></span><br><span class="line"><span class="keyword">type</span> TopologyHint <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="comment">// è®°å½•äº† NUMA Node æ»¡è¶³èµ„æºè¯·æ±‚çš„ä½æ©ç </span></span><br><span class="line">	NUMANodeAffinity bitmask.BitMask</span><br><span class="line">	<span class="comment">// Preferred is set to true when the NUMANodeAffinity encodes a preferred</span></span><br><span class="line">	<span class="comment">// allocation for the Container. It is set to false otherwise.</span></span><br><span class="line">    <span class="comment">// äº²å’Œæ€§çš„ç»“æœæ˜¯å¦ä¸ºé¦–é€‰çš„</span></span><br><span class="line">	Preferred <span class="type">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HintProvider is an interface for components that want to collaborate to</span></span><br><span class="line"><span class="comment">// achieve globally optimal concrete resource alignment with respect to</span></span><br><span class="line"><span class="comment">// NUMA locality.</span></span><br><span class="line"><span class="keyword">type</span> HintProvider <span class="keyword">interface</span> &#123;</span><br><span class="line">    <span class="comment">// GetTopologyHints returns a map of resource names to a list of possible</span></span><br><span class="line">    <span class="comment">// concrete resource allocations in terms of NUMA locality hints. Each hint</span></span><br><span class="line">    <span class="comment">// is optionally marked &quot;preferred&quot; and indicates the set of NUMA nodes</span></span><br><span class="line">    <span class="comment">// involved in the hypothetical allocation. The topology manager calls</span></span><br><span class="line">    <span class="comment">// this function for each hint provider, and merges the hints to produce</span></span><br><span class="line">    <span class="comment">// a consensus &quot;best&quot; hint. The hint providers may subsequently query the</span></span><br><span class="line">    <span class="comment">// topology manager to influence actual resource assignment.</span></span><br><span class="line">    GetTopologyHints(pod *v1.Pod, container *v1.Container) <span class="keyword">map</span>[<span class="type">string</span>][]TopologyHint</span><br><span class="line">    <span class="comment">// GetPodTopologyHints returns a map of resource names to a list of possible</span></span><br><span class="line">    <span class="comment">// concrete resource allocations per Pod in terms of NUMA locality hints.</span></span><br><span class="line">    GetPodTopologyHints(pod *v1.Pod) <span class="keyword">map</span>[<span class="type">string</span>][]TopologyHint</span><br><span class="line">    <span class="comment">// Allocate triggers resource allocation to occur on the HintProvider after</span></span><br><span class="line">    <span class="comment">// all hints have been gathered and the aggregated Hint is available via a</span></span><br><span class="line">    <span class="comment">// call to Store.GetAffinity().</span></span><br><span class="line">    Allocate(pod *v1.Pod, container *v1.Container) <span class="type">error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CPU Managerã€Memory Manager å’Œ Device Manager å‡å®ç°äº†è¯¥æ¥å£ã€‚åœ¨ Topology Manager ä¸­æ ¹æ®å„ä¸ª Manager è¿”å›çš„ TopologyHint æ•°æ®ï¼Œä»è€Œå†³å®šæœ€ç»ˆçš„ NUMA Node åˆ†é…ï¼Œå¹¶è°ƒç”¨å„ä¸ª Manager çš„ Allocate æ¥åšæœ€ç»ˆçš„ NUMA Node åˆ†é…ã€‚</p>
<h1 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://www.alibabacloud.com/help/zh/ack/ack-managed-and-ack-dedicated/user-guide/topology-aware-cpu-scheduling">ACK CPUæ‹“æ‰‘æ„ŸçŸ¥è°ƒåº¦</a></li>
<li><a target="_blank" rel="noopener" href="https://v1-25.docs.kubernetes.io/zh-cn/docs/tasks/administer-cluster/cpu-management-policies/">æ§åˆ¶èŠ‚ç‚¹ä¸Šçš„ CPU ç®¡ç†ç­–ç•¥</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/quality-service-pod/">é…ç½® Pod çš„æœåŠ¡è´¨é‡</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/784148">Kubeletä¹‹Topology Manageråˆ†æ</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/kubeconfig/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/kubeconfig/" class="post-title-link" itemprop="url">kubeconfig</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-03-22 19:58:22" itemprop="dateCreated datePublished" datetime="2024-03-22T19:58:22+00:00">2024-03-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="kubeconfig-æ–‡ä»¶ç»“æ„"><a href="#kubeconfig-æ–‡ä»¶ç»“æ„" class="headerlink" title="kubeconfig æ–‡ä»¶ç»“æ„"></a>kubeconfig æ–‡ä»¶ç»“æ„</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Config</span></span><br><span class="line"><span class="attr">clusters:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">cluster:</span></span><br><span class="line">    <span class="attr">certificate-authority-data:</span> <span class="string">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvakNDQWVhZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJME1ETXlNVEE0TXpZMU1Wb1hEVE0wTURNeE9UQTRNelkxTVZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTFBaCjZUcUFNMVhiRkxIbnVvd1ZNT1FHeWQ2SzVBcGdwcmhYSlBvclVKdStoazBKd3BQQlNRZGNSdnJjYy9wNTNDbnQKTTBXWVN4dThTd1Z6a0dHajh0cHNSNjRkMWMxdFk1djYzYnlkVXN5M3JwME1OWUt1ckJPNEY2aVFLK01oL3R6UAp4eUdZei9BUnhheDdXNysvWEV6Y2FsdFp5T1JZZk9ISUR5ZjN5R3V2T1htYmw5ZEJmRHFBMFlSMGxOTFFlUEcrCm5lZkVGb1dUQncxUytiZEl0MDBRZnl3MVlvRXpkOFd6UDRBTzFlV3AxK0tJdFhLaUxyaWFBbjkzNTJhbnVIT2YKQ3h0U0NCbEwwRThCL3dGKzhTd0RQbDlUYkNhZU1nTUJpY2hsQzlYSjNrV2k2cElOVnVEeEpRUy82cnlwQWhLbgpHK21RWlJIdmhsUk1wTjhEbDBzQ0F3RUFBYU5aTUZjd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZLay8zWDh0Q1dhZEpKN011SjNRNE5DL2xHd3pNQlVHQTFVZEVRUU8KTUF5Q0NtdDFZbVZ5Ym1WMFpYTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBSDR1K05zbE9ORWJVZXB1M0JaRQozL1hnQitFNDZVZ3N2d2R6UzhEWXF3YzBWQ28vUFc0RUNreW9IUkJINHJkdTVpaTBhVUhjZUxpNjhZQjlvQ3hpCmlkbHp3bUNGV1g1dEtGMUJTRFJ1YSt5MjVrOGZuSGtodm5IVG9CQ2c5ZlMzdFBOekNUdEtMSUhyVFpQVDhWU3IKdVYyZkdOcXMyT2djWjc4TmY4M2pnVVBXbFVPZkVsTDBrYjNYVHo5M29DdnF0RS9tRi9VOWhmOUdiRU5Lai9BSAovUHA4QWNmellkVGxGNTBva09temVFdnJnalZmaXFKMitGd2I5Lys1SUljSWFMR3IwZjVUMUVINzdxVEdEWElWCncwWGlKYmVTL1JTYTYrZFM0b1dRMS82Ryt1SUdRQWx0eTRSTXdqbG4rMTMvdStPelowTHErNzBlQTdUSm5mU0MKRVhBPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span></span><br><span class="line">    <span class="attr">server:</span> <span class="string">https://127.0.0.1:55282</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kind-kind</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">cluster:</span></span><br><span class="line">    <span class="attr">certificate-authority-data:</span> <span class="string">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURsRENDQW55Z0F3SUJBZ0lVQVFVeTNtWi80eWZmbEhjTi9WblNIcUYwL0NRd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1lqRUxNQWtHQTFVRUJoTUNWVk14Q3pBSkJnTlZCQWdUQWtOQk1SSXdFQVlEVlFRSEV3bFRkVzV1ZVhaaApiR1V4RURBT0JnTlZCQW9UQjB0MVltVmFiMjh4Q3pBSkJnTlZCQXNUQWtOQk1STXdFUVlEVlFRREV3cExkV0psCmNtNWxkR1Z6TUI0WERUSTBNRE15TVRBNE16a3dNRm9YRFRJNU1ETXlNREE0TXprd01Gb3dZakVMTUFrR0ExVUUKQmhNQ1ZWTXhDekFKQmdOVkJBZ1RBa05CTVJJd0VBWURWUVFIRXdsVGRXNXVlWFpoYkdVeEVEQU9CZ05WQkFvVApCMHQxWW1WYWIyOHhDekFKQmdOVkJBc1RBa05CTVJNd0VRWURWUVFERXdwTGRXSmxjbTVsZEdWek1JSUJJakFOCkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXlNNGo2d1NSdTUrcFpwckk1WkhxdmYycXpJdTUKSlZkYzRFUEp3cGY5eU9LN1FPZFM1SHJRUzVNK3ZEMFMzOUNJVFVYY2YxZUNJZy83SEt4TmVFbVk0TVdCMVlBWQpZOVRjMkZlR3JMMVBFR0lwNER6TnRRMkhvcWFxU2pJd0d0bnh3RjV5OGRRUGJkQ3JOdllDRVl5QlR2S0VtUXVoClFmdDhJR1NmaWJ0M3gwa2ZaaUFqZTJ5SDJabFNyMnBRSzRWWFdWUU5UV0hOQnlMS29Lb05Yazl2UTQ4dHhYbVUKcFRDWUxjcGdZSC9tU0lpY1FOcDQwRjRaOUUraGFjdTVkYVFVakIzZzQxWEVvYXBzL2xSa3d0bVFlV1gwVjR2VQp3cUlCS0doZmJ3dmluUjAvTmJGOVVLVldaVlpVL2R0NHR6TXQxVHg4L2tmcExmL0xnNXdoOThUSkJ3SURBUUFCCm8wSXdRREFPQmdOVkhROEJBZjhFQkFNQ0FRWXdEd1lEVlIwVEFRSC9CQVV3QXdFQi96QWRCZ05WSFE0RUZnUVUKWXp4aGFlN2V3TXNIeEJ5YnQ4U0Ntb01zVGg0d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFFWk5uUjI5SDVjRwpJSFBKdDlNMk5YZGt1NzFuU2VZb2s3SFBVdnJ6V0JOdFJjMUJPZkJRc25zb0RRcDQ1SmQxUnZsOEdLRHJjOCtICm5yaXZGQXpPZFRPQlhib3RMcFdGc0U1WU5VcGlUbWU2aW9pUVRVTnQ2WCtLd29CV00xNUwyWlJBYXdQQ0FBZ0sKeWRRU2lZaHVZMS93ekltWW1LenczRjVYb1BJcHVjTjhNam1MM3ZPNlFPaW51OFQrcW9wbWlmRFMraUVzRjcwSApwaW9mVXFJR3Zmbm5uVFFTWnFrRFAybXZ2VHFqT1lCbjU1dHRsL2JYQzh2ZHlwakNGVWRGOXNjUFM5R28ycTRuClkySUUvdHIvUFhaODUvUVVsdVQ2UEd5VUMycDNhZmNhdXRBbC9hQUZvM1ltK3BNbW03WUhad2JjcUp6U3BmRXIKbnJaekRNZFNGS2c9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K</span></span><br><span class="line">    <span class="attr">server:</span> <span class="string">https://127.0.0.1:6443</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">zoo</span></span><br><span class="line"><span class="attr">contexts:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">context:</span></span><br><span class="line">    <span class="attr">cluster:</span> <span class="string">kind-kind</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">kind-kind</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kind-kind</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">context:</span></span><br><span class="line">    <span class="attr">cluster:</span> <span class="string">zoo</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">zoo-admin</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">zoo</span></span><br><span class="line"><span class="attr">current-context:</span> <span class="string">kind-kind</span></span><br><span class="line"><span class="attr">preferences:</span> &#123;&#125;</span><br><span class="line"><span class="attr">users:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">kind-kind</span></span><br><span class="line">  <span class="attr">user:</span></span><br><span class="line">    <span class="attr">client-certificate-data:</span> <span class="string">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURJVENDQWdtZ0F3SUJBZ0lJSkNhSHFyUUl0b0l3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TkRBek1qRXdPRE0yTlRGYUZ3MHlOVEF6TWpFd09ETTJOVEphTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXFNS1VOcStyTGNPTkxDWmMKTjA4SjBpYzhBdnhjdmlZNG40SVN1UFFleVViYUhLTVpRNnJpNjA4SlZoNUZxc3B3N3BoWTkrYVBMTHJQaG9uWApCQWhQdmVSSVVxeDdaTkJhODNuVUIrTXIrOXIrazAwTk1yNDBTdkg5aGpnTXVZUjFvN051OWRzN1k3U0pOcXVsCnlwOVN6YzUwUTNBbzh1cHBTRFlFRW5Hd3I0VVBidlp0ZTVlQXo2T2hDYy9hazZuZGlFcU9hMkdJRzhlUmEyWTkKM2hBQjl6V3YvVldGTkxFNXh2Mm5oS3JDQVl6TzBrVmJwTkNlSmkxRGFvNTIzQURWajhGQjRFbDFVNCtvTmM2Vwo5VHdRbDFIUklxZXJ6MUFMTFl1THhadGFFY2IwYW04N2dTcEtyaXcrYWVBL3h6L29tQ1BLY1IrQTBSTkpBcVdWCnduTzhDUUlEQVFBQm8xWXdWREFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RBWURWUjBUQVFIL0JBSXdBREFmQmdOVkhTTUVHREFXZ0JTcFA5MS9MUWxtblNTZXpMaWQwT0RRdjVScwpNekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBbjVCalc3VEZvYlBxWk5obS82cEJPVUdGUmVncHFKYVcrUFN1CktUVU5qNXdDU1ZjTWg3V2RmQWtBSGxrYzQ5YWZlaHpWZmVwUXJEUEpOam96eCsxOGc2ZmtNalJRdEhRaW9yYSsKck82UklBYnVJR0pqTXBKVGNGL25OMkY4amFzdFlrdkZ1cjNtdlVldzhsWmtEZEdYMFFaU0J2Y0xqVGdvZURmSQpLTmhjMGVaQ2QrMStGeVJYajZwaUs4Y3pBWlkvTTVsVHJSZTVQUmJSaHpMeVo0Wm1nMHZjOUZjZFcxbThVZ2hDCkVOWkZCVDA0WTl2bHRGTHJaSG9IRlFERlNKRUxTSnl5VG95dTVnYVh6OElZUm41Y0k0b1RPZXlKN2JvQ3hvdzEKa3VXbWdxbVZHdjZwUWJqRm0zaTBTZXFRMkQ5bU1SaDhsYW0vMlhiaVlyWlBjQUlaRnc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span></span><br><span class="line">    <span class="attr">client-key-data:</span> <span class="string">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBcU1LVU5xK3JMY09OTENaY04wOEowaWM4QXZ4Y3ZpWTRuNElTdVBRZXlVYmFIS01aClE2cmk2MDhKVmg1RnFzcHc3cGhZOSthUExMclBob25YQkFoUHZlUklVcXg3Wk5CYTgzblVCK01yKzlyK2swME4KTXI0MFN2SDloamdNdVlSMW83TnU5ZHM3WTdTSk5xdWx5cDlTemM1MFEzQW84dXBwU0RZRUVuR3dyNFVQYnZadAplNWVBejZPaENjL2FrNm5kaUVxT2EyR0lHOGVSYTJZOTNoQUI5eld2L1ZXRk5MRTV4djJuaEtyQ0FZek8wa1ZiCnBOQ2VKaTFEYW81MjNBRFZqOEZCNEVsMVU0K29OYzZXOVR3UWwxSFJJcWVyejFBTExZdUx4WnRhRWNiMGFtODcKZ1NwS3JpdythZUEveHovb21DUEtjUitBMFJOSkFxV1Z3bk84Q1FJREFRQUJBb0lCQUJzQWR5S0EzUXpIZXpFVApPaklIVFhUNG5odUVNWHFqTnZBZXFjdzZFeXIxVVRTL3krME56SjBGMm1LVEdXYUlXYVZ6YnRqTFpTRXRDc05tCkRxY3doVUhHNHVPSGdYN1I3NXVCWkxHV1laVThwdnIrbXh3Qlh2Q1c0NCswTENVSzBwL010L1pTaTZBYVpOSUEKaU5od3daajRiWlhVdmxpUHRTUytyOHdic0wrRWNqTGFtZVhlQWNpTDByNTVzZzA5akxhSENkNnhQZ29FYlFPawpKR25kZ1JsSTFSZis5RGdON0toRkdQMkEvOGJEMytONERZT3pRcm8zWE1ZcG9kNyt3ODlkclFnOG9ob2pRQkd5CjZrR0tNeXdsaktNRmxuV3c4bmYwbDU4VzVibWo2enp3RzZPcDQra21wVStyc3pqR0JEdDQ1QnlQNUhTbEFEelMKYzNudFArRUNnWUVBeUhGc1l0aHZ4Vk1sVWdzZTViRzVWYXdwUGNjU3JuY0p3SXU4U1AvaExYUi9POUsvZVhwTAo2OUhtemNMSW1Dd1J1cWwzdUEvQlhYR1hpNlh5SWMvK3k0bzZyUEhoZk4wS2x5cFVOTXd4Ri9FY0t2VklmeE1ECjM2Uks5eVdvem5zVUFVVkw5L0dPK2ViK0dLOGtQRHYyVFdwTEVIVDFjVFc4aHNNV3JvTENLclVDZ1lFQTE0a1IKT2FWejBEbHFLUXlNSU0zVkk4Kzc4TUNOTzdUTFVOait4SWRyV2lGLzlCOG8wSVp3dG5GREo1OHE3dWZNcHhpTAptZEtwRENHcGhIWmhRQzYxWEhBNXEyVFIzamxhK1ArdnpTRVNxeWIvWWhrelk3dDdZY0xMSFBValRiWXpmV2I0Cjl6TjdTNkF6NWM2aGs1Nzd3RmxTODE2KzlWK2pBVW5MaWdkZzNJVUNnWUVBb1BlbFNRUHpUbzNsREt2dGxoeFIKYitHZ0JRS1htQS8wZnZJNHRJNzRzRjQ3eHprSmwyNkZCYzQ5QWNTSS90dDFLV2Zxd3ArMGMyeERmVnc0eExxYQpMYTdHVEJpN01tRDRua2paOHNTQU1HL3FaUDB4eVFybU0zVm0xbThoengrOEF3RTVidFpJTVp3MU5uR0FNZmNkClp6SVRNaFlhL1YxZ0Z3RVlkL0IrS1hrQ2dZRUFxdzA1b1dGQVAxRkJnaUJXR1RhaFg1RmVXeHZGT2t3cVN4aGIKWUVjRW1Id2JtdmNib2huLzI1cVpyQmt5cm5WQndwN0ZNNmV1eDFUenZvOWdjTnBnem1LMk1lS0tkKzFXMkdPNgo5blczNWlMRjdPbUpFaTVaSmVXODRsZGQxQyswUDJKNFZWOERDNnF4WlVFT2xDUkpNWWJ5UVBqQlhlU3ZiYmRPCkZGWDB0aTBDZ1lBZDNXTjl2SlN5UUxDUDlHdHA0dVRJQXpYRlFGbkJiY2ZKVzdaL2hnUXlZUWlWa0p6K3pQSCsKclU5RWE3ZTVyTlg0MmtuK2E1cXpudXZEeE5aMDhjRjYwdFBBajR2T1UrTkZyb2FyU29xL3lreTJMTnR2LzJ0OApocXJQblk0dE04dFpON2w5NktHSklJdzlVUXcyR2NpS3JXSXkvT0NQR2lERGthakhGS2lndlE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">zoo-admin</span></span><br><span class="line">  <span class="attr">user:</span></span><br><span class="line">    <span class="attr">client-certificate-data:</span> <span class="string">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQyRENDQXNDZ0F3SUJBZ0lVYlBFdGx4LzRTYm9TckRvZTd1djllS1YrckZNd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1lqRUxNQWtHQTFVRUJoTUNWVk14Q3pBSkJnTlZCQWdUQWtOQk1SSXdFQVlEVlFRSEV3bFRkVzV1ZVhaaApiR1V4RURBT0JnTlZCQW9UQjB0MVltVmFiMjh4Q3pBSkJnTlZCQXNUQWtOQk1STXdFUVlEVlFRREV3cExkV0psCmNtNWxkR1Z6TUI0WERUSTBNRE15TVRBNE16a3dNRm9YRFRJMU1ETXlNVEE0TXprd01Gb3dhVEVMTUFrR0ExVUUKQmhNQ1ZWTXhDekFKQmdOVkJBZ1RBa05CTVJJd0VBWURWUVFIRXdsVGRXNXVlWFpoYkdVeEZ6QVZCZ05WQkFvVApEbk41YzNSbGJUcHRZWE4wWlhKek1SQXdEZ1lEVlFRTEV3ZExkV0psV205dk1RNHdEQVlEVlFRREV3VmhaRzFwCmJqQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQU1PYnpoeDBOTW5ubTdHbmFjb2sKWHJ1RmxrRVBXc01la2xLNnBtbWFDRUVVUTNocHdsUWw2Z09UekpwaUVYVGZMZU1Uc29ZZ1NtNGFySWdjdVlTcwo3cDdzdWhhUi9RN1g3SUZjMXJEMzFtODB5amZEVUhYZi9jSWhDVmp0NDhLY1JLL2QrK2NzZkU5eHpEdlVBdDVxCmxmNFNvMy9YSnJyYzdtdURiUXdYdDgvaGQ4RnVZYUFWN2YraXVMMW5DRTB3b01IaFNPSkpEWC9TQ1pMakxTS2wKYU9aM2lOL0dDRXo4cldPUmVBbGUwQzRwazRwc0xmN1h6UlJpcnFTT21lQ3JTZzJoNlU1OS8xTHN5dXVqeTVFWQpxT3RsZ0R0Z3l5RDhBRWZhanM5R0NNRnFFOStHZWR6NkpuRmFlUlpOZThlVWNhVU1GWFVSWjYxb0pqT2UraUZ4CjU3TUNBd0VBQWFOL01IMHdEZ1lEVlIwUEFRSC9CQVFEQWdXZ01CMEdBMVVkSlFRV01CUUdDQ3NHQVFVRkJ3TUIKQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjBHQTFVZERnUVdCQlRPL0JxUE9HcVU1V0JYSW9wQgoxajdxYVBvTkh6QWZCZ05WSFNNRUdEQVdnQlJqUEdGcDd0N0F5d2ZFSEp1M3hJS2FneXhPSGpBTkJna3Foa2lHCjl3MEJBUXNGQUFPQ0FRRUF0SVRaN0FUVVhManB6UWtQVGM0RVFKYi9IZlJTcklOV3pSMlpRcVI1Q2J1dXEzR08KUktDZFphenVrakJjMCtXVkhGcVo4SEtNNUR2YThKbzZCUXgycXoxZ0ptVE1oYUdRMFlyNWFFcmxFZWJCWUcwVgpLMGh4LzJuMmNmMkt3N3VBOWdkeUJKSVFJbnY2RFJPUmt6VVNuQXJEd21TNitUNXdKK0lTUGlPdHVGRnQzazRyClZsZ1N3bjE5WHRSRnJ4OEI4dWRkSlZ4VEloN3FPa09hbURQaFJrTGJKNFdOUk5hYlpVMFVxdmxUQzVnQkhnS2QKSm1FaVQybHNoUENjS2lRZWsrTVNzNU9mNG9ZQml0TXM0eW1iendXb1hVaGcvVnRTbTdtT2MzUmo2ZGhrQXl2NwozQTJoZW1xUENKQ1JwbndzUDlpd0VrWUE0SlFZMG53aEUrd1h2Zz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K</span></span><br><span class="line">    <span class="attr">client-key-data:</span> <span class="string">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBdzV2T0hIUTB5ZWVic2FkcHlpUmV1NFdXUVE5YXd4NlNVcnFtYVpvSVFSUkRlR25DClZDWHFBNVBNbW1JUmROOHQ0eE95aGlCS2JocXNpQnk1aEt6dW51eTZGcEg5RHRmc2dWeldzUGZXYnpUS044TlEKZGQvOXdpRUpXTzNqd3B4RXI5Mzc1eXg4VDNITU85UUMzbXFWL2hLamY5Y211dHp1YTROdERCZTN6K0Yzd1c1aApvQlh0LzZLNHZXY0lUVENnd2VGSTRra05mOUlKa3VNdElxVm81bmVJMzhZSVRQeXRZNUY0Q1Y3UUxpbVRpbXd0Ci90Zk5GR0t1cEk2WjRLdEtEYUhwVG4zL1V1eks2NlBMa1JpbzYyV0FPMkRMSVB3QVI5cU96MFlJd1dvVDM0WjUKM1BvbWNWcDVGazE3eDVSeHBRd1ZkUkZucldnbU01NzZJWEhuc3dJREFRQUJBb0lCQUhMZ0ZYTndhM0FIck0vdwpXWmgxTTQwOUxyaVdvOTdqSFZ1b2NnS2lpeVp0R0JLblNaRFJrMVQyZjdwS3phV3RTKzJIcTloSkxtenJEVmdDClJwRThYZ2JIVDZIaHFwUUZDc2dPRmFkb1pXNTV1aWgxYzlORjhHa0pyY3VrS1pZbzM4M0l1QjlUYU0zZkx1b1QKNEh0dWJSZ0JLalB4enJUKytxWDVVUmxBOUpvSDc2c1hUb1JkYXF5YzR6VXMwcm9LNmVTb3dZeE8ydVN5TmtQcQpkai9reFJ4WTV2djYveHpPOHhVU1dUWndwVit2VUgvbVJiU1hjSjJrKzRvTDB5VmJSLzFpVStPYmpkSWU4UXNOCkhHMjBNSk9zRS9LTVVuVUlSeGxqRGlaM1o4WjVabXIrTUVTV3daOWRkUWlJbm80dSt6UkVaRTcvbnlwQ2lTY0UKOHlBNG9FRUNnWUVBOVpHbHRLdG8yaHRzZXBuWnNwdFVFdEorbXo2a001bEI2SHdpVVd3Q05ZSXpUQzRra2J2MwpXSzVMYXFpaXEwUk5zOHZSbmNXSHlwMHFidTlyOHNUellRUVVvc0luVStReGlLMUd0Uk81cVV4TE9SZzZlSjViClNCM0JoNnVQdVMyUU9qSlNKbU9uWldkUHFrRXJqSW9LWWZhT00wUGIxaUVlUzBWVUVyVWZaVGNDZ1lFQXkrcmgKeDlzM0FnMVk0bkVpVThsbGpDNlZQYk8yQ3pRM3ViWXJlcjhobVFTYkRsQjBHMEhOVE01YWNaSFdNVUdnWWVlagpUbFJCcVQvbFZtOXV3NFBxc1Ezejl4QnB0YmZDVUpqeEVucnJWQkdpeElNeHlGMU85WTh2WVRkZENLa3VVVVE5CnEybnpuNzNMNGdDRDlMcW4yYlFpaEFucHdTamcySytFQ2V4RlQyVUNnWUVBdWJIM2tsV0VKbHBTZjZ0VG1lSW4KZzB3MWZRT3plMmxMRTVpN0FzTWdNSUpTZENyNGNGT3BTU0FUMjRYRjdLanI4U2dSVExNUWFrREswN1NzOXBuRQpTUHFpK0NqRlFJVHdpQ0F2dGNKQ3hTanlRU3gzR3JyMDMrWFFjTjFsQTJ6WEFZc0g0QXUvaThqQnowY1V2V090ClVrTDFhUUxKZkhUeXlZeVZkTWdPQTZVQ2dZQndDcUY5dDFRVkc1SlA4UXVFYis4TXcvZWFUR2prNVE4TlNpdS8KcU03a0RhVElpNm9QNCtyU25ic1NGYWhUcmhSYVZ2VGlyK2JZQU5TWTFtZE1vK25LMkxqSWNrc3kza0cxR1NPMApITGU2bkdvTGdXNVVBZmpGY2FQOXpYYWZzSjFUWjZSZXo3dGRkT0pXVGlReXpuQTFiUVZkK1RobnVuYzRkOCtiCnlDY1pCUUtCZ0ZWcFZacDdjWUxHYlE1dERkL0orZ1BhcFo0TWFYSzluWDFTaktlalhjcVFFSUc3NEYrdkxzdEwKZCs4R3N0VkRzdy8vQ0VNcW9pYXZ1MkVlQ0VQZzF3ZHpDU3pWa2IrZ1FRZXA0cE1LZEhaai9YaysvNVVXTUJzOApkNnNwMWxrTTRqSGhjYkFLU056VTUrTG1NRnk0MzBPZlI2dmxVTFZjNVlaR2hSU0ZCdzdDCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==</span></span><br></pre></td></tr></table></figure>

<h2 id="cluster-å­—æ®µ"><a href="#cluster-å­—æ®µ" class="headerlink" title="cluster å­—æ®µ"></a>cluster å­—æ®µ</h2><p>certificate-authority-data å­—æ®µï¼šæœåŠ¡ç«¯çš„ ca è¯ä¹¦ï¼Œç”¨æ¥éªŒè¯ kube-apiserver è¯ä¹¦çš„æ­£ç¡®æ€§ã€‚<br />å½“ä½¿ç”¨ kubectl å‘é€è¯·æ±‚åˆ° kube-apiserver æ—¶ï¼Œkube-apiserver ä¼šè¿”å›é€šè¿‡å‚æ•° <code>--tls-cert-file</code> é…ç½®çš„è¯ä¹¦æ–‡ä»¶ï¼Œkubectl é€šè¿‡ kubeconfig ä¸­çš„ certificate-authority-data å­—æ®µæ¥æ ¡éªŒ kube-apiserver è¿”å›è¯ä¹¦çš„æœ‰æ•ˆæ€§ã€‚<br />å½“ kubectl æŒ‡å®šäº†å‚æ•° <code>--insecure-skip-tls-verify=true</code>ï¼Œå³å¯è·³è¿‡å¯¹ kube-apiserver è¯ä¹¦çš„æ ¡éªŒã€‚</p>
<h2 id="users"><a href="#users" class="headerlink" title="users"></a>users</h2><ul>
<li>nameï¼šç”¨æˆ·åç§°</li>
<li>client-certificate-dataï¼škubectl è¿æ¥ kube-apiserver æ—¶ä½¿ç”¨çš„å®¢æˆ·ç«¯è¯ä¹¦ï¼Œä¼šå‘é€ç»™ kube-apiserverã€‚å†…å®¹ç»è¿‡ base64 ç¼–ç ã€‚</li>
<li>client-key-dataï¼šå®¢æˆ·ç«¯ç§é’¥ä¿¡æ¯ã€‚å†…å®¹ç»è¿‡ base64 ç¼–ç ã€‚</li>
</ul>
<p>client-certificate-data å¯¹åº”çš„ä¸ºç”¨æˆ·çš„å…¬é’¥ä¿¡æ¯ï¼Œä½¿ç”¨å‘½ä»¤ <code>echo &#39;xx&#39; | base64 -d &gt; /tmp/client.crt; openssl x509 -in /tmp/client.crt -noout -text</code>å¯å¯¹è¯ä¹¦çš„å†…å®¹è¿›è¡Œè§£å¯†ã€‚è§£å¯†å®Œæˆåçš„è¯ä¹¦å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Certificate:</span></span><br><span class="line">    <span class="attr">Data:</span></span><br><span class="line">        <span class="attr">Version:</span> <span class="number">3</span> <span class="string">(0x2)</span></span><br><span class="line">        <span class="attr">Serial Number:</span> <span class="number">2604918601715070594</span> <span class="string">(0x242687aab408b682)</span></span><br><span class="line">        <span class="attr">Signature Algorithm:</span> <span class="string">sha256WithRSAEncryption</span></span><br><span class="line">        <span class="attr">Issuer:</span> <span class="string">CN</span> <span class="string">=</span> <span class="string">kubernetes</span></span><br><span class="line">        <span class="string">Validity</span></span><br><span class="line">            <span class="attr">Not Before:</span> <span class="string">Mar</span> <span class="number">21</span> <span class="number">08</span><span class="string">:36:51</span> <span class="number">2024 </span><span class="string">GMT</span></span><br><span class="line">            <span class="attr">Not After :</span> <span class="string">Mar</span> <span class="number">21</span> <span class="number">08</span><span class="string">:36:52</span> <span class="number">2025 </span><span class="string">GMT</span></span><br><span class="line">        <span class="attr">Subject:</span> <span class="string">O</span> <span class="string">=</span> <span class="string">system:masters,</span> <span class="string">CN</span> <span class="string">=</span> <span class="string">kubernetes-admin</span></span><br><span class="line">        <span class="attr">Subject Public Key Info:</span></span><br><span class="line">            <span class="attr">Public Key Algorithm:</span> <span class="string">rsaEncryption</span></span><br><span class="line">                <span class="attr">Public-Key:</span> <span class="string">(2048</span> <span class="string">bit)</span></span><br><span class="line">                <span class="attr">Modulus:</span></span><br><span class="line">                    <span class="attr">00:a8:c2:94:36:af:ab:2d:c3:8d:2c:26:5c:37:4f:</span></span><br><span class="line">                    <span class="attr">09:d2:27:3c:02:fc:5c:be:26:38:9f:82:12:b8:f4:</span></span><br><span class="line">                    <span class="attr">1e:c9:46:da:1c:a3:19:43:aa:e2:eb:4f:09:56:1e:</span></span><br><span class="line">                    <span class="attr">45:aa:ca:70:ee:98:58:f7:e6:8f:2c:ba:cf:86:89:</span></span><br><span class="line">                    <span class="attr">d7:04:08:4f:bd:e4:48:52:ac:7b:64:d0:5a:f3:79:</span></span><br><span class="line">                    <span class="attr">d4:07:e3:2b:fb:da:fe:93:4d:0d:32:be:34:4a:f1:</span></span><br><span class="line">                    <span class="attr">fd:86:38:0c:b9:84:75:a3:b3:6e:f5:db:3b:63:b4:</span></span><br><span class="line">                    <span class="attr">89:36:ab:a5:ca:9f:52:cd:ce:74:43:70:28:f2:ea:</span></span><br><span class="line">                    <span class="attr">69:48:36:04:12:71:b0:af:85:0f:6e:f6:6d:7b:97:</span></span><br><span class="line">                    <span class="attr">80:cf:a3:a1:09:cf:da:93:a9:dd:88:4a:8e:6b:61:</span></span><br><span class="line">                    <span class="attr">88:1b:c7:91:6b:66:3d:de:10:01:f7:35:af:fd:55:</span></span><br><span class="line">                    <span class="attr">85:34:b1:39:c6:fd:a7:84:aa:c2:01:8c:ce:d2:45:</span></span><br><span class="line">                    <span class="attr">5b:a4:d0:9e:26:2d:43:6a:8e:76:dc:00:d5:8f:c1:</span></span><br><span class="line">                    <span class="attr">41:e0:49:75:53:8f:a8:35:ce:96:f5:3c:10:97:51:</span></span><br><span class="line">                    <span class="attr">d1:22:a7:ab:cf:50:0b:2d:8b:8b:c5:9b:5a:11:c6:</span></span><br><span class="line">                    <span class="attr">f4:6a:6f:3b:81:2a:4a:ae:2c:3e:69:e0:3f:c7:3f:</span></span><br><span class="line">                    <span class="attr">e8:98:23:ca:71:1f:80:d1:13:49:02:a5:95:c2:73:</span></span><br><span class="line">                    <span class="string">bc:09</span></span><br><span class="line">                <span class="attr">Exponent:</span> <span class="number">65537</span> <span class="string">(0x10001)</span></span><br><span class="line">        <span class="attr">X509v3 extensions:</span></span><br><span class="line">            <span class="attr">X509v3 Key Usage:</span> <span class="string">critical</span></span><br><span class="line">                <span class="string">Digital</span> <span class="string">Signature,</span> <span class="string">Key</span> <span class="string">Encipherment</span></span><br><span class="line">            <span class="attr">X509v3 Extended Key Usage:</span></span><br><span class="line">                <span class="string">TLS</span> <span class="string">Web</span> <span class="string">Client</span> <span class="string">Authentication</span></span><br><span class="line">            <span class="attr">X509v3 Basic Constraints:</span> <span class="string">critical</span></span><br><span class="line">                <span class="string">CA:FALSE</span></span><br><span class="line">            <span class="attr">X509v3 Authority Key Identifier:</span></span><br><span class="line">                <span class="string">A9:3F:DD:7F:2D:09:66:9D:24:9E:CC:B8:9D:D0:E0:D0:BF:94:6C:33</span></span><br><span class="line">    <span class="attr">Signature Algorithm:</span> <span class="string">sha256WithRSAEncryption</span></span><br><span class="line">    <span class="attr">Signature Value:</span></span><br><span class="line">        <span class="attr">9f:90:63:5b:b4:c5:a1:b3:ea:64:d8:66:ff:aa:41:39:41:85:</span></span><br><span class="line">        <span class="attr">45:e8:29:a8:96:96:f8:f4:ae:29:35:0d:8f:9c:02:49:57:0c:</span></span><br><span class="line">        <span class="attr">87:b5:9d:7c:09:00:1e:59:1c:e3:d6:9f:7a:1c:d5:7d:ea:50:</span></span><br><span class="line">        <span class="attr">ac:33:c9:36:3a:33:c7:ed:7c:83:a7:e4:32:34:50:b4:74:22:</span></span><br><span class="line">        <span class="attr">a2:b6:be:ac:ee:91:20:06:ee:20:62:63:32:92:53:70:5f:e7:</span></span><br><span class="line">        <span class="attr">37:61:7c:8d:ab:2d:62:4b:c5:ba:bd:e6:bd:47:b0:f2:56:64:</span></span><br><span class="line">        <span class="attr">0d:d1:97:d1:06:52:06:f7:0b:8d:38:28:78:37:c8:28:d8:5c:</span></span><br><span class="line">        <span class="attr">d1:e6:42:77:ed:7e:17:24:57:8f:aa:62:2b:c7:33:01:96:3f:</span></span><br><span class="line">        <span class="attr">33:99:53:ad:17:b9:3d:16:d1:87:32:f2:67:86:66:83:4b:dc:</span></span><br><span class="line">        <span class="attr">f4:57:1d:5b:59:bc:52:08:42:10:d6:45:05:3d:38:63:db:e5:</span></span><br><span class="line">        <span class="attr">b4:52:eb:64:7a:07:15:00:c5:48:91:0b:48:9c:b2:4e:8c:ae:</span></span><br><span class="line">        <span class="attr">e6:06:97:cf:c2:18:46:7e:5c:23:8a:13:39:ec:89:ed:ba:02:</span></span><br><span class="line">        <span class="attr">c6:8c:35:92:e5:a6:82:a9:95:1a:fe:a9:41:b8:c5:9b:78:b4:</span></span><br><span class="line">        <span class="attr">49:ea:90:d8:3f:66:31:18:7c:95:a9:bf:d9:76:e2:62:b6:4f:</span></span><br><span class="line">        <span class="number">70</span><span class="string">:02:19:17</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„ Subject ä¸­çš„ O å¯¹åº”çš„ k8s ä¸­çš„ Groupï¼ŒCN å¯¹åº”çš„ k8s ä¸­çš„ Userã€‚kube-apiserver ä¼šé€šè¿‡è¯ä¹¦çš„ O å’Œ CN è·å–åˆ° User å’Œ Group ä¿¡æ¯ã€‚åœ¨ k8s ç³»ç»Ÿä¸­ï¼Œå®é™…ä¸Šå¹¶æ²¡æœ‰å­˜å‚¨ Group å’Œ User ä¿¡æ¯ï¼Œè€Œæ˜¯å®Œå…¨ä¾èµ–è¯¥è¯ä¹¦ä¸­çš„ä¿¡æ¯ã€‚</p>
<h1 id="kubeconfig-æ–‡ä»¶ç”Ÿæˆ"><a href="#kubeconfig-æ–‡ä»¶ç”Ÿæˆ" class="headerlink" title="kubeconfig æ–‡ä»¶ç”Ÿæˆ"></a>kubeconfig æ–‡ä»¶ç”Ÿæˆ</h1><p>kubeconfig æ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸ªè¯ä¹¦ï¼ŒåŒ…å«äº† caã€è¯ä¹¦å…¬é’¥å’Œè¯ä¹¦ç§é’¥ï¼Œåœ¨æœ‰äº†è¯ä¹¦åå¯ä»¥é€šè¿‡ kubectl å‘½ä»¤ç”Ÿæˆæ–°çš„ kubeconfig æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl --kubeconfig ~/.kube/111111.kubeconfig config set-cluster hello --certificate-authority=/tmp/ca.pem --embed-certs=true --server=https://127.0.0.1:6443</span><br><span class="line">kubectl --kubeconfig ~/.kube/111111.kubeconfig config set-credentials hello-admin --client-certificate=/tmp/tls.crt --client-key=/tmp/tls.key --embed-certs=true</span><br><span class="line">kubectl --kubeconfig ~/.kube/111111.kubeconfig config set-context hello --cluster=hello --user=hello-admin</span><br><span class="line">kubectl --kubeconfig ~/.kube/111111.kubeconfig config use-context hello</span><br></pre></td></tr></table></figure>

<h1 id="ä½¿ç”¨-curl-å‘½ä»¤ç›´æ¥è®¿é—®-kube-apiserver"><a href="#ä½¿ç”¨-curl-å‘½ä»¤ç›´æ¥è®¿é—®-kube-apiserver" class="headerlink" title="ä½¿ç”¨ curl å‘½ä»¤ç›´æ¥è®¿é—® kube-apiserver"></a>ä½¿ç”¨ curl å‘½ä»¤ç›´æ¥è®¿é—® kube-apiserver</h1><p>ç”±äº kube-apiserver å¼€å¯äº†åŒå‘è®¤è¯ï¼Œä½¿ç”¨ curl å‘½ä»¤è®¿é—® kube-apiserver æ—¶ï¼Œcurl éœ€è¦æŒ‡å®šè¯ä¹¦ä¿¡æ¯ï¼Œè¯ä¹¦ä¿¡æ¯å¯ä»¥ä½¿ç”¨ kubeconfig ä¸­çš„è¯ä¹¦ä¿¡æ¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">WORK_DIR=/tmp</span><br><span class="line">KUBECONFIG=~/.kube/config</span><br><span class="line">CONTEXT=kind-kind</span><br><span class="line">server=`yq eval &#x27;.clusters.[]|select(.name==&quot;&#x27;$CONTEXT&#x27;&quot;)|.cluster.server&#x27; $KUBECONFIG`</span><br><span class="line">yq eval &#x27;.users.[]|select(.name==&quot;&#x27;$CONTEXT&#x27;&quot;)|.user.client-certificate-data&#x27; $KUBECONFIG | base64 --decode &gt; $&#123;WORK_DIR&#125;/client.crt</span><br><span class="line">yq eval &#x27;.users.[]|select(.name==&quot;&#x27;$CONTEXT&#x27;&quot;)|.user.client-key-data&#x27; ~/.kube/config | base64 --decode &gt; $&#123;WORK_DIR&#125;/client.key</span><br><span class="line">yq eval &#x27;.clusters.[]|select(.name==&quot;&#x27;$CONTEXT&#x27;&quot;)|.cluster.certificate-authority-data&#x27; $KUBECONFIG | base64 --decode &gt; $&#123;WORK_DIR&#125;/ca.crt</span><br><span class="line">curl --cert $&#123;WORK_DIR&#125;/client.crt --key $&#123;WORK_DIR&#125;/client.key --cacert $&#123;WORK_DIR&#125;/ca.crt &quot;$server/apis/apiextensions.k8s.io/v1/customresourcedefinitions?limit=500&amp;resourceVersion=0&quot;</span><br></pre></td></tr></table></figure>

<h1 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/orchidzjl/p/17306985.html">kubeconfigæ–‡ä»¶å…¨è§£æ</a></li>
<li><a target="_blank" rel="noopener" href="https://zhangguanzhang.github.io/2018/10/27/create-kubeconfig/#/role-%E5%8F%82%E8%80%83">ç”Ÿæˆkubeconfigå¸¸è§„çš„ä¸¤ç§æ–¹æ³•</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/hexo-giscus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/hexo-giscus/" class="post-title-link" itemprop="url">Hexo ä½¿ç”¨ giscus è¯„è®ºç³»ç»Ÿ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-02-24 11:18:00" itemprop="dateCreated datePublished" datetime="2024-02-24T11:18:00+00:00">2024-02-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="è®¾ç½®è¯„è®ºç³»ç»Ÿ"><a href="#è®¾ç½®è¯„è®ºç³»ç»Ÿ" class="headerlink" title="è®¾ç½®è¯„è®ºç³»ç»Ÿ"></a>è®¾ç½®è¯„è®ºç³»ç»Ÿ</h1><p>æˆ‘çš„åšå®¢ç³»ç»Ÿ Hexo ä¹‹å‰ä½¿ç”¨ Gitment ä½œä¸ºè¯„è®ºï¼šã€Š<a href="/post/gitment">hexoæ·»åŠ gitmentè¯„è®ºç³»ç»Ÿ</a>ã€‹ï¼Œåæ¥å¹´ä¹…å¤±ä¿®ï¼Œäº†è§£äº†ä¸‹åŸºäº Github Discussions çš„ giscus ç”¨çš„æ¯”è¾ƒå¤šï¼Œæˆ‘ä¹Ÿé‡‡ç”¨è¯¥æ–¹æ¡ˆã€‚</p>
<p>åœ¨é…ç½® giscus ä¹‹é—´éœ€è¦æ»¡è¶³å¦‚ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š</p>
<ol>
<li>è¯¥ä»“åº“æ˜¯å…¬å¼€çš„ï¼Œå¦åˆ™è®¿å®¢å°†æ— æ³•æŸ¥çœ‹ discussionã€‚</li>
<li>giscus app å·²å®‰è£…ï¼Œå¦åˆ™è®¿å®¢å°†æ— æ³•è¯„è®ºå’Œå›åº”ã€‚</li>
<li>Discussions åŠŸèƒ½å·²åœ¨ä½ çš„ä»“åº“ä¸­å¯ç”¨ã€‚</li>
</ol>
<h1 id="åœ¨-Github-ä»“åº“ä¸­å®‰è£…-gitcus"><a href="#åœ¨-Github-ä»“åº“ä¸­å®‰è£…-gitcus" class="headerlink" title="åœ¨ Github ä»“åº“ä¸­å®‰è£… gitcus"></a>åœ¨ Github ä»“åº“ä¸­å®‰è£… gitcus</h1><p>æˆ‘è¿™é‡Œç›´æ¥é€‰æ‹©äº†æˆ‘çš„ hexo ä»“åº“ kuring&#x2F;kuring.github.io ä½œä¸ºäº† git ä»“åº“ï¼Œå› ä¸ºè¯¥ä»“åº“æœ¬æ¥çš„ç”¨é€”æœ¬æ¥å°±æ˜¯åšå®¢ç›¸å…³çš„å†…å®¹ï¼Œæƒé™ä¹Ÿæ˜¯ public çš„ã€‚</p>
<p>æ¥ä¸‹æ¥å®‰è£… Github app giscusï¼Œè®¿é—® <a target="_blank" rel="noopener" href="https://github.com/apps/giscus%EF%BC%8C%E5%9C%A8%E5%AE%89%E8%A3%85%E6%97%B6%E4%BB%85%E9%80%89%E6%8B%A9%E9%9C%80%E8%A6%81%E7%9A%84">https://github.com/apps/giscusï¼Œåœ¨å®‰è£…æ—¶ä»…é€‰æ‹©éœ€è¦çš„</a> repo å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦æ‰€æœ‰çš„ repo éƒ½æ”¾å¼€ã€‚</p>
<p><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/giscus-install.png"></p>
<h1 id="åœ¨-Github-ä»“åº“ä¸­æ‰“å¼€-Discussions-åŠŸèƒ½"><a href="#åœ¨-Github-ä»“åº“ä¸­æ‰“å¼€-Discussions-åŠŸèƒ½" class="headerlink" title="åœ¨ Github ä»“åº“ä¸­æ‰“å¼€ Discussions åŠŸèƒ½"></a>åœ¨ Github ä»“åº“ä¸­æ‰“å¼€ Discussions åŠŸèƒ½</h1><p>è¿›å…¥åˆ° Github é¡¹ç›®çš„ Settings -&gt; General -&gt; Features -&gt; Discussions å³å¯æ‰“å¼€è¯¥åŠŸèƒ½ã€‚</p>
<h1 id="è·å–åˆ°-Github-é¡¹ç›®ç›¸å…³çš„-gitcus-é…ç½®"><a href="#è·å–åˆ°-Github-é¡¹ç›®ç›¸å…³çš„-gitcus-é…ç½®" class="headerlink" title="è·å–åˆ° Github é¡¹ç›®ç›¸å…³çš„ gitcus é…ç½®"></a>è·å–åˆ° Github é¡¹ç›®ç›¸å…³çš„ gitcus é…ç½®</h1><p>è®¿é—®é¡µé¢ <a target="_blank" rel="noopener" href="https://giscus.app/zh-CN%EF%BC%8C%E5%9C%A8%60%E9%85%8D%E7%BD%AE%60%E7%AB%A0%E8%8A%82%E4%B8%AD%E8%AE%BE%E7%BD%AE%E7%9B%B8%E5%85%B3%E7%9A%84%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E5%88%B0%E7%B1%BB%E4%BC%BC%E4%B8%8B%E9%9D%A2%E5%86%85%E5%AE%B9%EF%BC%9A">https://giscus.app/zh-CNï¼Œåœ¨`é…ç½®`ç« èŠ‚ä¸­è®¾ç½®ç›¸å…³çš„é…ç½®ï¼Œå¯ä»¥è·å–åˆ°ç±»ä¼¼ä¸‹é¢å†…å®¹ï¼š</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;https://giscus.app/client.js&quot;</span><br><span class="line">        data-repo=&quot;kuring/kuring.github.io&quot;</span><br><span class="line">        data-repo-id=&quot;MDEwOlJlcG9zaXRvcnkyODM4MzQ0NTk=&quot;</span><br><span class="line">        data-category=&quot;Announcements&quot;</span><br><span class="line">        data-category-id=&quot;DIC_kwDOEOr4W84CdeTU&quot;</span><br><span class="line">        data-mapping=&quot;url&quot;</span><br><span class="line">        data-strict=&quot;0&quot;</span><br><span class="line">        data-reactions-enabled=&quot;1&quot;</span><br><span class="line">        data-emit-metadata=&quot;0&quot;</span><br><span class="line">        data-input-position=&quot;bottom&quot;</span><br><span class="line">        data-theme=&quot;preferred_color_scheme&quot;</span><br><span class="line">        data-lang=&quot;zh-CN&quot;</span><br><span class="line">        data-loading=&quot;lazy&quot;</span><br><span class="line">        crossorigin=&quot;anonymous&quot;</span><br><span class="line">        async&gt;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h1 id="åœ¨-Hexo-ä¸­é…ç½®-gitcus"><a href="#åœ¨-Hexo-ä¸­é…ç½®-gitcus" class="headerlink" title="åœ¨ Hexo ä¸­é…ç½® gitcus"></a>åœ¨ Hexo ä¸­é…ç½® gitcus</h1><p>å› ä¸º Hexo æˆ‘ä½¿ç”¨çš„ä¸º Next ä¸»é¢˜ï¼Œæˆ‘ä½¿ç”¨äº† Next çš„æ’ä»¶ <a target="_blank" rel="noopener" href="https://github.com/next-theme/hexo-next-giscus">hexo-next-giscus</a>ã€‚</p>
<p>åœ¨ Git ä»“åº“ç›®å½•ä¸‹æ‰§è¡Œ <code>npm install hexo-next-giscus</code> å³å¯å®‰è£… giscusã€‚</p>
<p>ä¿®æ”¹ Git ä»“åº“ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ï¼Œåœ¨æœ€åé¢å¢åŠ å¦‚ä¸‹çš„å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">giscus:</span><br><span class="line">  enable: false</span><br><span class="line">  repo: # Github repository name</span><br><span class="line">  repo_id: # Github repository id</span><br><span class="line">  category: # Github discussion category</span><br><span class="line">  category_id: # Github discussion category id</span><br><span class="line">  # Available values: pathname | url | title | og:title</span><br><span class="line">  mapping: pathname</span><br><span class="line">  # Available values: 0 | 1</span><br><span class="line">  reactions_enabled: 1</span><br><span class="line">   # Available values: 0 | 1</span><br><span class="line">  emit_metadata: 1</span><br><span class="line">  # Available values: light | dark | dark_high_contrast | transparent_dark | preferred-color-scheme</span><br><span class="line">  theme: light</span><br><span class="line">  # Available values: en | zh-CN</span><br><span class="line">  lang: en</span><br><span class="line">  # Place the comment box above the comments</span><br><span class="line">  input_position: bottom</span><br><span class="line">  # Load the comments lazily</span><br><span class="line">  loading: lazy</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­å¾ˆå¤šçš„å­—æ®µå€¼æ¥è‡ªä¸Šä¸ªç« èŠ‚è·å–åˆ°çš„ json ç»“æœã€‚</p>
<p>è‡³æ­¤ï¼Œå³å®Œæˆäº†æ•´ä¸ª gitcus çš„é…ç½®ã€‚</p>
<h1 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://giscus.app/zh-CN">giscus</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/kuring/kuring.github.io/settings">GitHub Discussions å¿«é€Ÿå…¥é—¨</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/next-theme/hexo-next-giscus">hexo-next-giscus</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/watch-tv-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/watch-tv-2/" class="post-title-link" itemprop="url">å°†æ ‘è“æ´¾ 5 æ‰“é€ æˆ Android TV ç”µè§†ç›’å­æŠ˜è…¾è®° ï¼ˆ2ï¼‰- é¥æ§å™¨çš„é…ç½®</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-02-24 00:41:46" itemprop="dateCreated datePublished" datetime="2024-02-24T00:41:46+00:00">2024-02-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>åœ¨å‰åºæ–‡ç« ä¸­ï¼Œå®ç°äº†å°†æ ‘è“æ´¾ 5 åˆ·æˆäº† Android TV ç”µè§†ç›’å­ï¼ŒåŸºæœ¬çš„åŠŸèƒ½å·²ç»å®Œå¤‡ï¼Œæœ¬æ–‡å°†æ¥ä»‹ç»å¦‚ä½•ä½¿ç”¨é¥æ§å™¨æ¥æ§åˆ¶ Android TVã€‚</p>
<ul>
<li><a href="http://kuring.me/post/watch-tv/">æˆ‘è¦çœ‹ç”µè§† - æŠ•å½±ä»ªå’Œç”µè§†ç›’å­é€‰å‹</a></li>
<li><a href="http://kuring.me/post/pi5-1/">æˆ‘è¦çœ‹ç”µè§† - å°†æ ‘è“æ´¾ 5 æ‰“é€ æˆ Android TV ç”µè§†ç›’å­æŠ˜è…¾è®°ï¼ˆ1ï¼‰</a></li>
</ul>
<p>æ ‘è“æ´¾çš„å®šä½æ˜¯ç”¨ä½œå°å‹è®¡ç®—æœºä½¿ç”¨ï¼Œè€Œä½œä¸ºç”µè§†ç›’å­å´å¿…é¡»è¦å…·å¤‡é¥æ§å™¨æ¥æ§åˆ¶çš„åŠŸèƒ½ã€‚è¦æƒ³é€šè¿‡é¥æ§å™¨æ¥æ§åˆ¶æ ‘è“æ´¾æœ‰å¤šç§æ–¹å¼å¯ä¾›é€‰æ‹©ï¼Œä¸‹é¢åˆ—ä¸€ä¸‹æˆ‘è‡ªå·±å°è¯•è¿‡çš„æ–¹æ¡ˆã€‚</p>
<h1 id="ä½¿ç”¨æ‰‹æœºé¥æ§-Android-TV"><a href="#ä½¿ç”¨æ‰‹æœºé¥æ§-Android-TV" class="headerlink" title="ä½¿ç”¨æ‰‹æœºé¥æ§ Android TV"></a>ä½¿ç”¨æ‰‹æœºé¥æ§ Android TV</h1><p>è¿™æ˜¯æœ€ç®€å•æˆæœ¬æœ€ä½çš„çº¯è½¯æ–¹æ¡ˆï¼Œåªè¦åœ¨æ‰‹æœºä¸Šå®‰è£…è½¯ä»¶å°±å¯ä»¥æ¥æ§åˆ¶ Android TV äº†ï¼Œæ‰‹æœºè·Ÿ Android TV åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹å³å¯ã€‚æˆ‘ä½¿ç”¨åˆ°äº† IOS ä¸Šçš„ App <code>Remote TV</code>ï¼Œè½¯ä»¶å…è´¹ï¼Œä½†æœ‰å¹¿å‘Šã€‚<br /><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-1.png" alt="IMG_2890.PNG"><br />ä½¿ç”¨ä¸ŠåŠŸèƒ½å®Œå¤‡ï¼Œæ¯”å¦‚å¼€å…³ Android TV çš„åŠŸèƒ½ä¹Ÿæ˜¯å®Œå¤‡çš„ã€‚Android TV çš„å…³ç³»æ“ä½œå¹¶éçœŸæ­£çš„å…³æœºï¼Œå®é™…ä¸Šè¿˜æ˜¯åœ¨ä½åŠŸè€—è¿è¡Œï¼Œç½‘ç»œè¿˜æ˜¯å¯ä»¥è¿æ¥çš„ã€‚ä¹Ÿå°±æ„å‘³ç€é€šè¿‡ App å®é™…ä¸Šæ˜¯å¯ä»¥å¼€æœºçš„ã€‚<br />ä¸æ–¹ä¾¿çš„åœ°æ–¹åœ¨äºï¼Œæ¯æ¬¡æ“ä½œéœ€è¦é¢å¤–æ‹¿èµ·æ‰‹æœºæ‰“å¼€ App åæ‰èƒ½æ“ä½œï¼Œæ²¡æœ‰ç¡¬ä»¶çš„é¥æ§å™¨æ¥çš„æ–¹ä¾¿ã€‚</p>
<h1 id="ä½¿ç”¨æŠ•å½±ä»ªçš„é¥æ§å™¨"><a href="#ä½¿ç”¨æŠ•å½±ä»ªçš„é¥æ§å™¨" class="headerlink" title="ä½¿ç”¨æŠ•å½±ä»ªçš„é¥æ§å™¨"></a>ä½¿ç”¨æŠ•å½±ä»ªçš„é¥æ§å™¨</h1><p>æˆ‘ä½¿ç”¨äº†çˆ±æ™®ç”Ÿçš„ TZ2800 æŠ•å½±ä»ªä½œä¸ºæ’­æ”¾è®¾å¤‡ï¼ŒæŠ•å½±ä»ªçš„ HDMI å·²ç»æ”¯æŒäº† HDMI CEC åŠŸèƒ½ã€‚è¿™é‡Œåæ§½ä¸‹ä¼ ç»Ÿä¼ä¸šçˆ±æ™®ç”Ÿï¼Œåœ¨<a target="_blank" rel="noopener" href="https://www.epson.com.cn/Apps/tech_support/SupportProduct.aspx?p=32158">å®˜æ–¹äº§å“é¡µé¢</a>ä¸­å¾ˆéš¾æ‰¾åˆ°å…³äºè¯¥æ¬¾æŠ•å½±ä»ªçš„ HDMI æ˜¯å¦æ”¯æŒ CEC çš„ä»‹ç»ï¼Œæˆ–è€…å­˜åœ¨æŸä¸ªåœ°æ–¹ï¼Œä½†æ€»å½’æˆ‘æ‰¾ä¸åˆ°ã€‚</p>
<p>HDMI CECï¼ˆConsumer Electronics Controlï¼‰ åŠŸèƒ½å¯ä»¥å®ç°é€šè¿‡ HDMI è¿æ¥è®©å¤šä¸ªè®¾å¤‡ä¹‹é—´ç›¸äº’æ§åˆ¶ï¼Œå¯ä»¥å®ç°åŒä¸€ä¸ªé¥æ§å™¨æ¥æ§åˆ¶æŠ•å½±ä»ªå’Œ Android TV çš„åŠŸèƒ½ï¼š</p>
<ol>
<li>å½“å…³é—­æŠ•å½±ä»ªçš„æ—¶å€™ä¹Ÿå¯ä»¥å…³é—­ Android TVã€‚</li>
<li>å½“æ‰“å¼€æŠ•å½±ä»ªçš„æ—¶å€™å¯ä»¥æ‰“å¼€ Android TVã€‚</li>
</ol>
<p>è¦æƒ³ä½¿ç”¨ HDMI CEC åŠŸèƒ½ï¼Œéœ€è¦åœ¨ Android TV ç³»ç»Ÿä¸­å¼€å¯ç›¸å…³çš„åŠŸèƒ½ã€‚<br /><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-2.png" alt="IMG_2893.HEIC"><br />ä¸‹é¢çš„ç•Œé¢ç”¨æ¥é€‰æ‹© HDMI CEC çš„æ”¯æŒæ¥å£ï¼Œåªèƒ½æ”¯æŒä¸€ä¸ª HDMI æ¥å£ã€‚<br /><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-3.png" alt="IMG_2894.HEIC"></p>
<p>ç”±äºè·ŸæŠ•å½±ä»ªå…±ç”¨ä¸€ä¸ªé¥æ§å™¨ï¼ŒåŠŸèƒ½ä¸Šè¿˜æ˜¯æœ‰æ‰€å—é™ã€‚æ¯”å¦‚éŸ³é‡çš„å¤§å°åŠŸèƒ½ï¼Œåªèƒ½æ“ä½œæŠ•å½±ä»ªï¼Œè€Œä¸èƒ½å†è®¾ç½® Android TV çš„éŸ³é‡å¤§å°ã€‚ä½†ç»å¤§å¤šæ•°çš„åŠŸèƒ½å·²ç»å…·å¤‡ã€‚</p>
<h1 id="ä½¿ç”¨è“ç‰™é¥æ§å™¨"><a href="#ä½¿ç”¨è“ç‰™é¥æ§å™¨" class="headerlink" title="ä½¿ç”¨è“ç‰™é¥æ§å™¨"></a>ä½¿ç”¨è“ç‰™é¥æ§å™¨</h1><p>å®¶é‡Œæ­£å·§æœ‰ä¸ªåŠç§»åŠ¨å®½å¸¦é€çš„ç”µè§†ç›’å­ï¼Œè¯¥é¥æ§å™¨ä¸ºè“ç‰™é¥æ§å™¨ã€‚åœ¨é¥æ§å™¨çš„èƒŒé¢æ­£å·§æœ‰è“ç‰™é…å¯¹çš„æ–¹æ³•ã€‚<br /><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-4.png" alt="IMG_2891.HEIC"><br /><br>æ‰“å¼€ Android Tv ç³»ç»Ÿä¸­çš„ <code>è®¾ç½®</code> -&gt; <code>ç³»ç»Ÿ</code> -&gt; <code>é¥æ§å™¨å’Œæ‰‹æŸ„</code> åŠŸèƒ½ã€‚åŒæ—¶æŒ‰ä½èœå•é”®å’Œè¿”å›é”®å³å¯è“ç‰™é…å¯¹ã€‚<br /><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-5.png" alt="IMG_2892.HEIC"><br /><br>è“ç‰™é…å¯¹æˆåŠŸåï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­åŠŸèƒ½æ­£å¸¸ã€‚ä½†å‘ç°ä¸ªè‡´å‘½çš„ç¼ºç‚¹ï¼šè“ç‰™ä¼šè‡ªåŠ¨æ–­å¼€ï¼Œè€Œä¸”æ— æ³•è‡ªåŠ¨è¿æ¥ï¼Œä¸‹æ¬¡åªèƒ½é‡æ–°é…å¯¹ã€‚æˆ‘ä¸å¤ªç¡®å®šæ˜¯å¦ä¸ºé¥æ§å™¨çš„é—®é¢˜ï¼Œä½†å•è¿™ä¸€ç‚¹å·²ç»å¦å®šäº†æˆ‘ä½¿ç”¨è“ç‰™é¥æ§å™¨çš„æ–¹æ¡ˆã€‚</p>
<h1 id="ä½¿æ ‘è“æ´¾è®¾å¤‡æ”¯æŒé¥æ§å™¨æ§åˆ¶"><a href="#ä½¿æ ‘è“æ´¾è®¾å¤‡æ”¯æŒé¥æ§å™¨æ§åˆ¶" class="headerlink" title="ä½¿æ ‘è“æ´¾è®¾å¤‡æ”¯æŒé¥æ§å™¨æ§åˆ¶"></a>ä½¿æ ‘è“æ´¾è®¾å¤‡æ”¯æŒé¥æ§å™¨æ§åˆ¶</h1><p>æ ‘è“æ´¾é€šè¿‡ 24 ä¸ª GPIO å¼•è„šæä¾›äº†å¼ºå¤§çš„æ‰©å±•æ€§ï¼Œå¯ä»¥æ¥å…¥å¤–éƒ¨ç¡¬ä»¶è®¾å¤‡æ¥æ¥æ”¶é¥æ§å™¨çš„ä¿¡å·ã€‚<br />æˆ‘ä»¬æ¥äº†è§£ä¸‹å¸¸è§çš„é¥æ§å™¨çš„å®ç°åŸç†ï¼š</p>
<ol>
<li>çº¢å¤–é¥æ§å™¨ï¼šæœ€ä¸ºæ™®éçš„é¥æ§å™¨ï¼Œä½¿ç”¨çº¢å¤–çº¿å‘å°„ä¿¡å·ï¼Œæ¥æ”¶ç«¯éœ€è¦æœ‰å¯¹åº”çš„çº¢å¤–æ¥æ”¶æ¨¡å—ã€‚åœ¨å‘å°„ä¿¡å·æ—¶éœ€è¦å¯¹å‡†æ¥æ”¶ç«¯ã€‚</li>
<li>æ— çº¿é¥æ§å™¨ï¼šé€šå¸¸é‡‡ç”¨äº† 2.4 GHz æ— çº¿é¢‘æ®µä½œä¸ºä¼ è¾“ä»‹è´¨ï¼Œæ¥æ”¶ç«¯éœ€è¦æœ‰å¯ä»¥åŒ¹é…çš„è®¾å¤‡æ¥æ”¶ä¿¡å·ï¼Œæ¯”å¦‚å¾ˆå¤šæ— çº¿é¼ æ ‡æä¾›äº†ä¸€ä¸ªå¾ˆå°çš„ USB æ¥æ”¶ç«¯ã€‚</li>
<li>è“ç‰™é¥æ§å™¨ï¼šä½¿ç”¨è“ç‰™æŠ€æœ¯é€šè®¯ï¼Œè€Œè“ç‰™æŠ€æœ¯åŒæ ·é‡‡ç”¨äº† 2.4 GHz çš„æ— çº¿é¢‘æ®µï¼Œä½†å¥½å¤„åœ¨äºå¾ˆå¤šçš„è®¾å¤‡éƒ½æ”¯æŒè“ç‰™åè®®ï¼Œä¸éœ€è¦æ¥æ”¶ç«¯å†æœ‰ä¸€ä¸ªå®šåˆ¶åŒ–çš„ç¡¬ä»¶ã€‚</li>
</ol>
<h2 id="æ¥æ”¶çº¢å¤–ä¿¡å·"><a href="#æ¥æ”¶çº¢å¤–ä¿¡å·" class="headerlink" title="æ¥æ”¶çº¢å¤–ä¿¡å·"></a>æ¥æ”¶çº¢å¤–ä¿¡å·</h2><p>æˆ‘å®¶é‡Œæ­£å·§æœ‰å‡ ä¸ªåºŸå¼ƒçš„çº¢å¤–é¥æ§å™¨ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºæ ‘è“æ´¾çš„é¥æ§å™¨æ¥ä½¿ç”¨ã€‚å‰©ä¸‹çš„äº‹æƒ…é¦–å…ˆéœ€è¦æ ‘è“æ´¾é€šè¿‡ GPIO å¼•è„šæ¥æ”¶åˆ°çº¢å¤–ä¿¡å·ã€‚<br />åœ¨ä¸‡èƒ½çš„æ·˜å®ä¸Šï¼ŒèŠ±äº†å‡ å—é’±ä¹°åˆ°äº†çº¢å¤–æ¥æ”¶å™¨å’Œæœé‚¦çº¿ï¼ˆç”¨æ¥è¿æ¥çº¢å¤–æ¥æ”¶å¤´å’Œ GPIO å¼•è„šï¼‰ï¼Œæœé‚¦çº¿éœ€è¦æ³¨æ„ä¸ºæ¯å¯¹æ¯è§„æ ¼ã€‚<br /><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-6.png" alt="image.png"><br /><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-7.png" alt="image.png"></p>
<h2 id="çº¢å¤–æ¥æ”¶å™¨è¿æ¥åˆ°æ ‘è“æ´¾"><a href="#çº¢å¤–æ¥æ”¶å™¨è¿æ¥åˆ°æ ‘è“æ´¾" class="headerlink" title="çº¢å¤–æ¥æ”¶å™¨è¿æ¥åˆ°æ ‘è“æ´¾"></a>çº¢å¤–æ¥æ”¶å™¨è¿æ¥åˆ°æ ‘è“æ´¾</h2><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ ‘è“æ´¾ GPIO å¼•è„šçš„åŠŸèƒ½å¹¶æœªå¼€å¯ã€‚æ‰“å¼€ Android TV ç³»ç»Ÿä¸­çš„ <code>Raspberry Pi settings</code> -&gt; <code>IR</code> -&gt; <code>Infrared remote</code>å¼€å…³ã€‚å¯ä»¥çœ‹åˆ°æ¥æ”¶ä¿¡å·çš„ä¸º GPIO 18 å¼•è„šã€‚<br /><br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-8.png" alt="IMG_2887.HEIC"><br /></p>
<p>åœ¨çº¢å¤–æ¥æ”¶å™¨ä¸ŠåŒ…å«äº†ä¸‰ä¸ªå¼•è„šï¼Œä¾æ¬¡ä¸ºï¼šOUTï¼ˆè¾“å‡ºä¿¡å·ï¼‰ã€GNDï¼ˆæ¥åœ°ä¿¡å·ï¼‰ã€VCCï¼ˆå·¥ä½œç”µå‹ï¼‰ï¼Œå…¶ä¸­çº¢å¤–æ¥æ”¶å™¨çš„ OUT å¼•è„šå¯¹åº”çš„ GPIO 18 å¼•è„šã€‚<br /><br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-9.png" alt="image.png"><br /><br>æ ‘è“æ´¾æä¾›äº† 3.3V å’Œ 5V ä¸¤ç§å·¥ä½œç”µå‹ï¼ŒæŸ¥çœ‹çº¢å¤–ä¿¡å·æ¥æ”¶å™¨çš„å·¥ä½œç”µå‹åœ¨ 2.7V ~ 5.5V ä¹‹é—´ï¼Œæˆ‘ç›´æ¥ä½¿ç”¨äº† GPIO çš„ 5V çš„å¼•è„šã€‚<br /><br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-10.png" alt="image.png"><br />æŸ¥çœ‹æ ‘è“æ´¾çš„å„ä¸ªå¼•è„šçº¿è·¯å›¾ï¼š<br /><br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/tv-2-11.png" alt="æ¥æºï¼šhttps://pinout.vvzero.com/" title="æ¥æºï¼šhttps://pinout.vvzero.com/"><br />å³å¯å¾—åˆ°çº¢å¤–ä¿¡å·æ¥æ”¶å™¨è·Ÿ GPIO å¼•è„šçš„å¯¹åº”å…³ç³»ï¼š</p>
<table>
<thead>
<tr>
<th>çº¢å¤–ä¿¡å·æ¥æ”¶å™¨å¼•è„š</th>
<th>GPIO å¼•è„š</th>
</tr>
</thead>
<tbody><tr>
<td>OUT</td>
<td>18</td>
</tr>
<tr>
<td>GND</td>
<td>9ï¼ˆå°±è¿‘åŸåˆ™ï¼‰</td>
</tr>
<tr>
<td>VCC</td>
<td>2ï¼ˆ4 å’Œ 6 è¢«é£æ‰‡ç”µæºå ç”¨ï¼‰</td>
</tr>
</tbody></table>
<p>åœ¨å°†ç¡¬ä»¶è¿æ¥å¥½åå°±å¯ä»¥å¯åŠ¨æ ‘è“æ´¾äº†ã€‚</p>
<h2 id="é¥æ§å™¨ç¼–ç é…å¯¹"><a href="#é¥æ§å™¨ç¼–ç é…å¯¹" class="headerlink" title="é¥æ§å™¨ç¼–ç é…å¯¹"></a>é¥æ§å™¨ç¼–ç é…å¯¹</h2><p>å®¶é‡Œå¯èƒ½æœ‰å¤šä¸ªçº¢å¤–é¥æ§å™¨ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆçº¢å¤–é¥æ§å™¨ä¹‹é—´ä¸ä¼šå‡ºç°ç›¸äº’å†²çªï¼Œæœ¬æ¥æƒ³æ‰“å¼€ç”µè§†ï¼Œå´æ‰“å¼€äº†ç©ºè°ƒçš„æƒ…å†µå‘¢ï¼ŸåŸå› æ˜¯çº¢å¤–é¥æ§å™¨ä¸Šçš„æ¯ä¸ªæŒ‰é”®éƒ½å¯¹åº”äº†ä¸€ä¸ªç¼–ç ï¼Œè€Œä¸åŒè®¾å¤‡çš„é¥æ§å™¨å¯¹åº”çš„ç¼–ç æ˜¯ä¸åŒçš„ã€‚ç”µè§†é¥æ§å™¨å‘å‡ºçš„å¼€æœºä¿¡å·è™½ç„¶è¢«ç©ºè°ƒæ¥æ”¶åˆ°äº†ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå¯¹è¯¥æŒ‰é”®çš„ç¼–ç åšå¤„ç†ï¼Œç©ºè°ƒä¹Ÿå°±ä¸ä¼šè¢«å¼€æœºã€‚<br />æˆ‘ä»å®¶é‡Œéšä¾¿æ‰¾äº†ä¸€ä¸ªçº¢å¤–é¥æ§å™¨ä¹Ÿå°±ä¸å¯èƒ½ç›´æ¥ç”¨æ¥æ§åˆ¶ Android TV äº†ï¼Œå› æ­¤éœ€è¦è®© Android TV å¯ä»¥è¯†åˆ«åˆ°æˆ‘çš„çº¢å¤–é¥æ§å™¨å¯¹åº”çš„æŒ‰é”®ç¼–ç ã€‚<br />è¦æƒ³è¯†åˆ«åˆ°çº¢å¤–é¥æ§å™¨çš„ç¼–ç ï¼Œéœ€è¦ä½¿ç”¨åˆ° Android TV ç³»ç»Ÿä¸­å‘½ä»¤è¡Œå·¥å…· <code>ir-keytable</code>ï¼Œéœ€è¦ä»¥ ssh çš„æ–¹å¼è¿æ¥ Android TVã€‚Android TV çš„è¿æ¥æ–¹å¼å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰æ–‡ç« ã€Š<a href="http://kuring.me/post/pi5-1/">æˆ‘è¦çœ‹ç”µè§† - å°†æ ‘è“æ´¾ 5 æ‰“é€ æˆ Android TV ç”µè§†ç›’å­æŠ˜è…¾è®°ï¼ˆ1ï¼‰</a>ã€‹ä¸­çš„ SSH ç« èŠ‚éƒ¨åˆ†ã€‚</p>
<p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ <code>ir-keytable -p all -t</code>ï¼Œå¹¶æŒ‰ä¸‹é¥æ§å™¨çš„æŒ‰é”®ï¼Œåœ¨å‘½ä»¤è¡Œä¸­å¯ä»¥è·å–åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">991.988018: lirc protocol(necx): scancode = 0x835590</span><br><span class="line">991.988023: event type EV_MSC(0x04): scancode = 0x835590</span><br><span class="line">991.988023: event type EV_SYN(0x00).</span><br><span class="line"></span><br><span class="line">992.104019: lirc protocol(necx): scancode = 0x835590</span><br><span class="line">992.104025: event type EV_MSC(0x04): scancode = 0x835590</span><br><span class="line">992.104025: event type EV_SYN(0x00).</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ 916.968014 è¡¨ç¤ºçš„äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´æˆ³ã€‚necx è¡¨ç¤ºä½¿ç”¨çš„ä¸º NEC æ‰©å±•åè®®ï¼ŒNEC ä¸ºä¸€ç§å¸¸è§çš„çº¢å¤–ç¼–ç åè®®ã€‚è€Œ scancode å­—æ®µå³ä¸ºæˆ‘ä»¬éœ€è¦è·å–çš„æŒ‰é”®ç¼–ç ã€‚EV_SYN è¡¨ç¤ºä¸€ç»„æ—¶é—´çš„ç»“æŸã€‚<br />åœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼ŒæŒ‰ä¸‹é¥æ§å™¨çš„æŒ‰é”®ä¸€æ¬¡ï¼Œå‘é€å‡ºäº†ä¸¤ä¸ªç›¸åŒä¿¡å·ï¼Œä¹Ÿå°±æ‰“å°å‡ºäº†ä¸¤ä¸ªç›¸åŒæ—¥å¿—å—ã€‚</p>
<p>æ‰“å¼€ Github é¡¹ç›®ï¼š<a target="_blank" rel="noopener" href="https://github.com/lineage-rpi/android_external_ir-keytable/tree/lineage-18.1/rc_keymaps">https://github.com/lineage-rpi/android_external_ir-keytable&#x2F;tree&#x2F;lineage-18.1&#x2F;rc_keymaps</a>ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰å¾ˆå¤šç¼–ç è·Ÿå¯¹åº”é”®ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œå› ä¸ºæˆ‘çš„çº¢å¤–é¥æ§å™¨æ²¡æœ‰æ•°å­—é”®ï¼Œæˆ‘æŒ‘é€‰äº†ä¸€ä¸ªè·Ÿé¥æ§å™¨é”®æ¯”è¾ƒç›¸ä¼¼çš„æ–‡ä»¶è¿›è¡Œé‡æ–°ä¿®æ”¹ï¼Œå°†å…¶ä¸­çš„ç¼–ç ä¿®æ”¹æˆ‘é¥æ§å™¨å¯¹åº”çš„ç¼–ç ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ rc_keymap.txt ä¸­ã€‚æˆ‘çš„æ–‡ä»¶ç±»ä¼¼å¦‚ä¸‹ï¼Œå…¶ä¸­ KEY_PREVIOUSSONG å’Œ KEY_PLAYPAUSE ä¸¤ä¸ªæŒ‰é”®æˆ‘çš„é¥æ§å™¨ä¸Šæ²¡æœ‰ï¼Œæˆ‘è¿™é‡Œæœªåšä¿®æ”¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># table allwinner_ba10_tv_box, type: NEC</span><br><span class="line">0x646dca KEY_UP</span><br><span class="line">0x646d81 KEY_VOLUMEDOWN</span><br><span class="line">0x217 KEY_NEXTSONG</span><br><span class="line">0x646ddc KEY_POWER</span><br><span class="line">0x646dc5 KEY_BACK</span><br><span class="line">0x646dce KEY_OK</span><br><span class="line">0x646dd2 KEY_DOWN</span><br><span class="line">0x646d80 KEY_VOLUMEUP</span><br><span class="line">0x254 KEY_PREVIOUSSONG</span><br><span class="line">0x255 KEY_PLAYPAUSE</span><br><span class="line">0x646d82 KEY_MENU</span><br><span class="line">0x646d88 KEY_HOMEPAGE</span><br><span class="line">0x646dc1 KEY_RIGHT</span><br><span class="line">0x646d99 KEY_LEFT</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬ä¸€è¡Œçœ‹ä¼¼æ˜¯ä¸ªæ³¨é‡Šï¼Œå®é™…ä¸æ˜¯ï¼Œä¸è¦åˆ æ‰ï¼Œä¿ç•™åŸæ–‡ä»¶ä¸­çš„æ ¼å¼ä¸å˜ã€‚</p>
<h2 id="Android-TV-ç³»ç»Ÿå¼€æœºæ—¶åŠ è½½é…ç½®"><a href="#Android-TV-ç³»ç»Ÿå¼€æœºæ—¶åŠ è½½é…ç½®" class="headerlink" title="Android TV ç³»ç»Ÿå¼€æœºæ—¶åŠ è½½é…ç½®"></a>Android TV ç³»ç»Ÿå¼€æœºæ—¶åŠ è½½é…ç½®</h2><p>æœ‰äº†é¥æ§å™¨æŒ‰é”®å’Œç¼–ç ä¹‹é—´çš„æ˜ å°„å…³ç³»åï¼Œéœ€è¦å°†å…¶æ”¾åˆ° Android TV ç³»ç»Ÿçš„ <code>/boot/rc_keymap.txt</code> æ–‡ä»¶ä¸­ï¼Œè®© Android TV å¼€å¯è‡ªåŠ¨åŠ è½½è¯¥é…ç½®ã€‚è¯¥æ–‡ä»¶é»˜è®¤æƒ…å†µä¸‹ä¸å­˜åœ¨éœ€è¦åˆ›å»ºã€‚</p>
<p>åˆ†åŒº &#x2F;boot é»˜è®¤ä¸ºåªè¯»æ¨¡å¼ï¼Œä¸å…è®¸åœ¨å…¶ä¸­å¢åŠ æ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127|:/boot # echo &quot;123&quot; &gt; aa</span><br><span class="line">sh: can&#x27;t create aa: Read-only file system</span><br></pre></td></tr></table></figure>

<p>å°† &#x2F;boot ç›®å½•é‡æ–° mount ä¸ºè¯»å†™æ¨¡å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ mount  | grep &#x27;/boot &#x27;</span><br><span class="line">/dev/block/mmcblk0p1 on /boot type vfat (ro,relatime,fmask=0000,dmask=0000,allow_utime=0022,codepage=437,iocharset=ascii,shortname=mixed,errors=remount-ro)</span><br><span class="line"></span><br><span class="line">$ mount -o remount,rw /boot</span><br><span class="line"></span><br><span class="line">$ mount  | grep &#x27;/boot &#x27;</span><br><span class="line">/dev/block/mmcblk0p1 on /boot type vfat (rw,relatime,fmask=0000,dmask=0000,allow_utime=0022,codepage=437,iocharset=ascii,shortname=mixed,errors=remount-ro)</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºå¹¶å°†é…ç½®å†™å…¥åˆ°æ–‡ä»¶ &#x2F;boot&#x2F;rc_keymap.txt ä¸­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /boot/rc_keymap.txt</span><br><span class="line"># table allwinner_ba10_tv_box, type: NEC</span><br><span class="line">0x646dca KEY_UP</span><br><span class="line">0x646d81 KEY_VOLUMEDOWN</span><br><span class="line">0x217 KEY_NEXTSONG</span><br><span class="line">0x646ddc KEY_POWER</span><br><span class="line">0x646dc5 KEY_BACK</span><br><span class="line">0x646dce KEY_OK</span><br><span class="line">0x646dd2 KEY_DOWN</span><br><span class="line">0x646d80 KEY_VOLUMEUP</span><br><span class="line">0x254 KEY_PREVIOUSSONG</span><br><span class="line">0x255 KEY_PLAYPAUSE</span><br><span class="line">0x646d82 KEY_MENU</span><br><span class="line">0x646d88 KEY_HOMEPAGE</span><br><span class="line">0x646dc1 KEY_RIGHT</span><br><span class="line">0x646d99 KEY_LEFT</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p>é‡æ–°å°† &#x2F;boot åˆ†åŒºæŒ‚è½½ä¸ºåªè¯»æ¨¡å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -o remount,ro /boot</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œå®Œåï¼Œé‡æ–°å¯åŠ¨ç³»ç»Ÿã€‚åœ¨é¡ºåˆ©çš„æƒ…å†µä¸‹ï¼Œå³å¯ä»¥é€šè¿‡çº¢å¤–é¥æ§å™¨ç›´æ¥æ“ä½œ Android TV ç³»ç»Ÿã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä¸»è¦åœ¨ä½¿ç”¨çš„æ–¹å¼ä¸ºçº¢å¤–é¥æ§å™¨æ¨¡å¼ï¼Œæ¯•ç«Ÿä¸€ä¸ªç”µè§†ç›’å­è¿˜æ˜¯åº”è¯¥æœ‰å±äºè‡ªå·±çš„é¥æ§å™¨ã€‚Good Luckï¼</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/numa/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/numa/" class="post-title-link" itemprop="url">numa</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-02-21 18:04:26" itemprop="dateCreated datePublished" datetime="2024-02-21T18:04:26+00:00">2024-02-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>éšç€å¤„ç†å™¨æ•°é‡çš„å¢åŠ ï¼Œæ‰€æœ‰çš„å¤„ç†å™¨å‡é€šè¿‡åŒä¸€ä¸ªåŒ—æ¡¥æ¥è®¿é—®å†…å­˜ï¼Œå¯¼è‡´å†…å­˜è®¿é—®å»¶è¿Ÿå¢åŠ ï¼Œå†…å­˜å¸¦å®½æˆä¸ºç“¶é¢ˆã€‚</p>
<p>NUMAï¼ˆNon-Uniform Memory Accessï¼‰éç»Ÿä¸€å†…å­˜è®¿é—®ï¼Œæ˜¯ä¸€ç§é’ˆå¯¹å¤šå¤„ç†å™¨ç³»ç»Ÿçš„ç»„ç»‡ç»“æ„ã€‚å¤„ç†å™¨è¢«åˆ†é…åˆ°ä¸åŒçš„èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰è‡ªå·±çš„æœ¬åœ°å†…å­˜ï¼Œå¤„ç†å™¨å¯ä»¥è®¿é—®æœ¬åœ°å†…å­˜å’Œå…¶ä»–èŠ‚ç‚¹çš„å†…å­˜ï¼Œä½†è®¿é—®æœ¬åœ°å†…å­˜çš„é€Ÿåº¦è¦è¿œè¿œå¿«äºè®¿é—®å…¶ä»–èŠ‚ç‚¹çš„å†…å­˜ã€‚</p>
<p>å‡ ä¸ªæ¦‚å¿µï¼š</p>
<p><img src="https://kuring.oss-cn-beijing.aliyuncs.com/images/numa.jpg"></p>
<ol>
<li>Socketï¼šä¸€é¢—ç‰©ç† CPUã€‚</li>
<li>Numa Nodeï¼šé€»è¾‘æ¦‚å¿µï¼Œå¯¹ CPU åˆ†ç»„çš„æŠ½è±¡ï¼Œä¸€ä¸ª Node å³ä¸ºä¸€ä¸ªåˆ†ç»„ï¼Œä¸€ä¸ªåˆ†ç»„ä¸‹å¯ä»¥åŒ…å«å¤šä¸ª CPUã€‚æ¯ä¸ª Node éƒ½æœ‰è‡ªå·±çš„æœ¬åœ°èµ„æºï¼ŒåŒ…æ‹¬å†…å­˜å’Œ IOã€‚Numa Node ä¹‹é—´ä¸å…±äº« L3 cacheã€‚ä¸€ä¸ª Numa Node å†…çš„ä¸åŒ core ä¹‹é—´å…±äº« L3.</li>
<li>Coreï¼šä¸€é¢—ç‰©ç† CPU çš„ç‰©ç†æ ¸ï¼Œæ¯ä¸ª Core æœ‰ç‹¬ç«‹çš„ L1 å’Œ L2ï¼ŒCore ä¹‹é—´å…±äº« L3ã€‚</li>
<li>Thread&#x2F;Processorï¼šä¸€é¢—ç‰©ç† CPU çš„é€»è¾‘æ ¸ï¼Œç”¨è¶…çº¿ç¨‹çš„æ–¹å¼æ¨¡æ‹Ÿå‡ºä¸¤ä¸ªé€»è¾‘æ ¸ã€‚Processor ä¹‹é—´å…±äº« L1 å’Œ L2 cacheï¼Œåœ¨å¼€å¯è¶…çº¿ç¨‹åå•æ ¸çš„æ€§èƒ½ä¼šä¸‹é™ä¸€äº›ã€‚</li>
</ol>
<p>ä¸€ä¸ª NUMA Node å¯ä»¥æœ‰ä¸€ä¸ª Socketï¼Œæ¯ä¸ª Socket åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªç‰©ç† Coreã€‚</p>
<h1 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h1><p>æŸ¥çœ‹ç‰©ç†æ ¸æ•° Socketï¼š<code>lscpu | grep Socket</code><br>æ¯ä¸ª Socket åŒ…å«çš„ç‰©ç†æ ¸ Coreï¼š<code>lscpu  | grep &#39;Core(s) per socket&#39;</code><br>æ¯ä¸ª Socket åŒ…å«çš„ Thead&#x2F;Processor æ•°é‡ï¼š<code>lscpu  | grep &#39;Thread(s) per core&#39;</code><br>æŸ¥çœ‹æ‰€æœ‰çš„ Processor æ•°é‡ï¼š<code>cat /proc/cpuinfo | grep &quot;processor&quot; | wc -l</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$</span> <span class="string">numactl</span> <span class="string">--hardware</span></span><br><span class="line"><span class="attr">available:</span> <span class="number">4</span> <span class="string">nodes</span> <span class="string">(0-3)</span></span><br><span class="line"><span class="attr">node 0 cpus:</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">32</span> <span class="number">33</span> <span class="number">34</span> <span class="number">35</span> <span class="number">36</span> <span class="number">37</span> <span class="number">38</span> <span class="number">39</span></span><br><span class="line"><span class="attr">node 0 size:</span> <span class="number">128470</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node 0 free:</span> <span class="number">88204</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node 1 cpus:</span> <span class="number">8</span> <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">40</span> <span class="number">41</span> <span class="number">42</span> <span class="number">43</span> <span class="number">44</span> <span class="number">45</span> <span class="number">46</span> <span class="number">47</span></span><br><span class="line"><span class="attr">node 1 size:</span> <span class="number">129019</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node 1 free:</span> <span class="number">67982</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node 2 cpus:</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">21</span> <span class="number">22</span> <span class="number">23</span> <span class="number">48</span> <span class="number">49</span> <span class="number">50</span> <span class="number">51</span> <span class="number">52</span> <span class="number">53</span> <span class="number">54</span> <span class="number">55</span></span><br><span class="line"><span class="attr">node 2 size:</span> <span class="number">129019</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node 2 free:</span> <span class="number">38304</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node 3 cpus:</span> <span class="number">24</span> <span class="number">25</span> <span class="number">26</span> <span class="number">27</span> <span class="number">28</span> <span class="number">29</span> <span class="number">30</span> <span class="number">31</span> <span class="number">56</span> <span class="number">57</span> <span class="number">58</span> <span class="number">59</span> <span class="number">60</span> <span class="number">61</span> <span class="number">62</span> <span class="number">63</span></span><br><span class="line"><span class="attr">node 3 size:</span> <span class="number">128965</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node 3 free:</span> <span class="number">45689</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node distances:</span></span><br><span class="line"><span class="string">node</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line">  <span class="attr">0:</span>  <span class="number">10</span>  <span class="number">16</span>  <span class="number">28</span>  <span class="number">22</span></span><br><span class="line">  <span class="attr">1:</span>  <span class="number">16</span>  <span class="number">10</span>  <span class="number">22</span>  <span class="number">28</span></span><br><span class="line">  <span class="attr">2:</span>  <span class="number">28</span>  <span class="number">22</span>  <span class="number">10</span>  <span class="number">16</span></span><br><span class="line">  <span class="attr">3:</span>  <span class="number">22</span>  <span class="number">28</span>  <span class="number">16</span>  <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ²¡æœ‰å¼€å¯ numaï¼Œé»˜è®¤åªä¼šçœ‹åˆ°ä¸€ä¸ª nodeï¼Œç±»ä¼¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$</span> <span class="string">numactl</span> <span class="string">--hardware</span></span><br><span class="line"><span class="attr">available:</span> <span class="number">1</span> <span class="string">nodes</span> <span class="string">(0)</span></span><br><span class="line"><span class="attr">node 0 cpus:</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">21</span> <span class="number">22</span> <span class="number">23</span> <span class="number">24</span> <span class="number">25</span> <span class="number">26</span> <span class="number">27</span> <span class="number">28</span> <span class="number">29</span> <span class="number">30</span> <span class="number">31</span> <span class="number">32</span> <span class="number">33</span> <span class="number">34</span> <span class="number">35</span> <span class="number">36</span> <span class="number">37</span> <span class="number">38</span> <span class="number">39</span> <span class="number">40</span> <span class="number">41</span> <span class="number">42</span> <span class="number">43</span> <span class="number">44</span> <span class="number">45</span> <span class="number">46</span> <span class="number">47</span> <span class="number">48</span> <span class="number">49</span> <span class="number">50</span> <span class="number">51</span> <span class="number">52</span> <span class="number">53</span> <span class="number">54</span> <span class="number">55</span> <span class="number">56</span> <span class="number">57</span> <span class="number">58</span> <span class="number">59</span> <span class="number">60</span> <span class="number">61</span> <span class="number">62</span> <span class="number">63</span></span><br><span class="line"><span class="attr">node 0 size:</span> <span class="number">772904</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node 0 free:</span> <span class="number">510590</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">node distances:</span></span><br><span class="line"><span class="string">node</span>   <span class="number">0</span></span><br><span class="line">  <span class="attr">0:</span>  <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ numastat å‘½ä»¤å¯ä»¥çœ‹åˆ° numa çš„ miss ç­‰æƒ…å†µï¼Œå¯¹äºæ’æŸ¥æ€§èƒ½é—®é¢˜éå¸¸æœ‰å¸®åŠ©ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$</span> <span class="string">numastat</span></span><br><span class="line">                           <span class="string">node0</span>           <span class="string">node1</span>           <span class="string">node2</span>           <span class="string">node3</span></span><br><span class="line"><span class="string">numa_hit</span>              <span class="number">6010986094</span>      <span class="number">3863188690</span>      <span class="number">7861549559</span>      <span class="number">9798877648</span></span><br><span class="line"><span class="string">numa_miss</span>                      <span class="number">0</span>               <span class="number">0</span>       <span class="number">113102530</span>               <span class="number">0</span></span><br><span class="line"><span class="string">numa_foreign</span>                   <span class="number">0</span>               <span class="number">0</span>               <span class="number">0</span>       <span class="number">113102530</span></span><br><span class="line"><span class="string">interleave_hit</span>             <span class="number">17976</span>           <span class="number">17846</span>           <span class="number">17965</span>           <span class="number">17839</span></span><br><span class="line"><span class="string">local_node</span>            <span class="number">6010748681</span>      <span class="number">3862984578</span>      <span class="number">7861301902</span>      <span class="number">9798751537</span></span><br><span class="line"><span class="string">other_node</span>                <span class="number">237411</span>          <span class="number">204112</span>       <span class="number">113350178</span>          <span class="number">126111</span></span><br></pre></td></tr></table></figure>
<h1 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://ctimbai.github.io/2018/05/03/tech/linux/cpu/CPU%E6%8B%93%E6%89%91%E4%BB%8ESMP%E8%B0%88%E5%88%B0NUMA%EF%BC%88%E7%90%86%E8%AE%BA%E7%AF%87%EF%BC%89/">CPU æ‹“æ‰‘ï¼šä» SMP è°ˆåˆ° NUMA ï¼ˆç†è®ºç¯‡ï¼‰</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://kuring.me/post/pi5-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="404é¢‘é“">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 404é¢‘é“">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/pi5-1/" class="post-title-link" itemprop="url">æˆ‘è¦çœ‹ç”µè§† - å°†æ ‘è“æ´¾ 5 æ‰“é€ æˆ Android TV ç”µè§†ç›’å­æŠ˜è…¾è®°ï¼ˆ1ï¼‰</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-02-17 11:23:07" itemprop="dateCreated datePublished" datetime="2024-02-17T11:23:07+00:00">2024-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-06-26 15:59:00" itemprop="dateModified" datetime="2024-06-26T15:59:00+00:00">2024-06-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç«  ã€Š<a href="/post/watch-tv/">æˆ‘è¦çœ‹ç”µè§† - æŠ•å½±ä»ªå’Œç”µè§†ç›’å­é€‰å‹</a>ã€‹ä¸­ï¼Œæåˆ°äº†ç”¨æ ‘è“æ´¾ 5 æ¥ä½œä¸ºç”µè§†ç›’å­ï¼Œéœ€è¦åˆ· Android TV ç³»ç»Ÿï¼Œæœ¬æ–‡å°†è¯¦ç»†ä»‹ç»æŠ˜è…¾ç»å†ã€‚<br>åœ¨è¿™ä¹‹å‰æˆ‘å¹¶æ²¡æœ‰æ¥è§¦è¿‡æ ‘è“æ´¾ï¼ŒAndroid ç³»ç»Ÿå€’æ˜¯æ›¾ç»åˆ·è¿‡æœºï¼Œä½†ä¹Ÿäº†è§£ä¸æ·±ã€‚æ–‡ä¸­å¦‚æœ‰ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡æ­£ã€‚</p>
<h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><p>è¦æƒ³æŠ˜è…¾æ ‘è“æ´¾ï¼Œè¿˜æ˜¯éœ€è¦ä¸€ç‚¹ç‚¹è®¾å¤‡ï¼Œæˆ‘ä½¿ç”¨åˆ°çš„è®¾å¤‡æ¸…å•å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä¸€å° Mac ç¬”è®°æœ¬ç”µè„‘ï¼šç”¨æ¥ä¸‹è½½é•œåƒã€çƒ§å½•æ™¯è±¡ã€è¿œç¨‹è¿æ¥ç”µè§†ç›’å­ç­‰ã€‚å…¶ä»–æ“ä½œç³»ç»Ÿçš„ç”µè„‘å‡å¯ã€‚</li>
<li>ä¸€ä¸ª 32G SD å¡ï¼šç”¨æ¥ä½œä¸ºæ ‘è“æ´¾çš„å­˜å‚¨ç³»ç»Ÿ RAMã€‚</li>
<li>ä¸€ä¸ª SD è¯»å¡å™¨ï¼šç”¨æ¥è¯»å– SD å¡ï¼Œä¾›ç”µè„‘çƒ§å½•ç³»ç»Ÿä½¿ç”¨ã€‚</li>
<li>ä¸€ä¸ª U ç›˜ï¼šè¯¥ U ç›˜å¹¶éæ ‘è“æ´¾çš„ SD å¡ï¼Œè€Œæ˜¯ä½œä¸ºæ ‘è“æ´¾çš„é¢å¤–å­˜å‚¨ï¼Œç”¨æ¥å‘æ ‘è“æ´¾ä¸­å¤åˆ¶æ–‡ä»¶ã€‚</li>
<li>ä¸€å°æ˜¾ç¤ºå™¨ï¼šç”¨æ¥æ˜¾ç¤ºæ ‘è“æ´¾çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”µè§†æˆ–è€…æŠ•å½±ä»ªç­‰è®¾å¤‡ã€‚</li>
<li>ä¸€ä¸ª USB é”®ç›˜ï¼šç”¨æ¥è¿æ¥æ ‘è“æ´¾è¿›è¡Œæ“ä½œã€‚</li>
<li>ä¸€ä¸ª USB é¼ æ ‡ï¼šç”¨æ¥è¿æ¥æ ‘è“æ´¾è¿›è¡Œæ“ä½œã€‚</li>
<li>ä¸€ä¸ªè“ç‰™é¥æ§å™¨ï¼šç”¨æ¥è¿æ¥æ ‘è“æ´¾çš„ Android TV ç³»ç»Ÿã€‚æˆ‘ç›´æ¥ä½¿ç”¨äº†å®¶é‡ŒåŠå®½å¸¦é€çš„ç§»åŠ¨ç”µè§†ç›’å­çš„é¥æ§å™¨ã€‚</li>
<li>ä¸€æ ¹ HDMI æ•°æ®çº¿ï¼šå…¶ä¸­ä¸€å¤´ä¸º Micro HDMIï¼Œç”¨æ¥è¿æ¥æ ‘è“æ´¾ï¼Œå¦å¤–ä¸€å¤´ä¸ºæ ‡å‡† HDMI å£ï¼Œç”¨æ¥è¿æ¥æ˜¾ç¤ºå™¨ã€‚</li>
</ol>
<p>å¦å¤–ï¼š</p>
<ol>
<li>ç½‘ç»œéœ€è¦èƒ½å¤Ÿè®¿é—® Google ç­‰ç½‘ç«™ã€‚</li>
</ol>
<h1 id="å¯»æ‰¾-Android-TV-ç³»ç»Ÿ"><a href="#å¯»æ‰¾-Android-TV-ç³»ç»Ÿ" class="headerlink" title="å¯»æ‰¾ Android TV ç³»ç»Ÿ"></a>å¯»æ‰¾ Android TV ç³»ç»Ÿ</h1><p>æ‰¾åˆ°æ ‘è“æ´¾å¯¹åº”çš„ Android TV é•œåƒæ˜¯éå¸¸é‡è¦çš„å‰æï¼Œæ‰¾åˆ°åˆé€‚çš„ ROM æ°¸è¿œæ˜¯ Android ç³»ç»Ÿåˆ·æœºä¸­éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œä¸€èˆ¬æ¯ä¸ªè®¾å¤‡æ€»æœ‰é‚£ä¹ˆå‡ ä¸ªå¤§ç¥åœ¨æä¾›å„ç±» ROMã€‚<br>æŸ¥æ‰¾ä¸€ä¸ªè®¾å¤‡çš„èµ„æºæœ€å¿«çš„æ–¹å¼å°±æ˜¯å» github.com ä¸ŠæŸ¥æ‰¾ awesomeï¼Œæ ‘è“æ´¾çš„é¡¹ç›®åœ°å€ä¸ºï¼š<a target="_blank" rel="noopener" href="https://github.com/thibmaek/awesome-raspberry-pi">awesome-raspberry-pi</a>ã€‚åœ¨ OS Images ç« èŠ‚ä¸­åŒ…å«äº†æ”¯æŒæ ‘è“æ´¾çš„å¤šç§ OSï¼Œå•çº¯æœç´¢ Android TV å¹¶ä¸èƒ½æ‰¾åˆ°å¯¹åº”çš„ OSï¼Œä½†å®é™…ä¸Š <a target="_blank" rel="noopener" href="https://konstakang.com/devices/rpi4/">KonstaKANG</a> å¯¹åº”å°±æ˜¯ Android é•œåƒï¼Œè¿™æ˜¯æ–‡æ¡£ä¸å¥½çš„åœ°æ–¹ï¼Œå¹¶æ²¡æœ‰å°†ç®€ä»‹å†™æ¸…æ¥šã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/konstakang-1.png" alt="image.png"></p>
<p><a target="_blank" rel="noopener" href="https://konstakang.com/devices/rpi4/">KonstaKANG</a> å¹¶éä¸€ä¸ªç³»ç»Ÿï¼Œè€Œæ˜¯ä¸€ä¸ªç½‘ç«™ï¼ŒåŒ…å«äº†å¤šç§è®¾å¤‡çš„ OS é•œåƒã€‚å¯¹åº”çš„ <a target="_blank" rel="noopener" href="https://konstakang.com/devices/rpi5/">Raspberry 5</a> çš„é¡µé¢åŒ…å«äº† AOSP å’Œ LineageOS ä¸¤ç§ OS é•œåƒï¼ŒAOSP å’Œ LineageOS å‡ä¸º android çš„å‘å‹ç‰ˆã€‚ä½†åªæä¾›äº† LineageOS 20 ä¸€ä¸ª Android TV çš„ç‰ˆæœ¬ï¼Œå‰©ä¸‹çš„ä¸¤ä¸ªä¸º Android ç‰ˆæœ¬ã€‚Android TV å’Œ Android å¹¶éåŒä¸€ä¸ªç³»ç»Ÿï¼ŒAndroid TV æ˜¯é’ˆå¯¹ç”µè§†ä½¿ç”¨çš„ç³»ç»Ÿï¼Œè€Œ Android æ˜¯é’ˆå¯¹æ™ºèƒ½æ‰‹æœºå’Œå¹³æ¿ä½¿ç”¨çš„ç³»ç»Ÿï¼Œç”¨æˆ·ä½“éªŒä¸Šè¿˜æ˜¯æœ‰è¾ƒå¤§åŒºåˆ«ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/konstakang-2.png" alt="image.png"><br>å› æ­¤ï¼Œ<a target="_blank" rel="noopener" href="https://konstakang.com/devices/rpi5/LineageOS20-ATV/">LineageOS 20 Android TV (Android 13) </a>å³å˜ä¸ºäº†ç›®å‰å”¯ä¸€ä¸€ä¸ªå¯ä»¥åœ¨æ ‘è“æ´¾ 5 ä¸Šä½¿ç”¨ Android TV ç³»ç»Ÿï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œåˆ«æ— ä»–é€‰ã€‚æ— è®ºè¯¥ç³»ç»Ÿæ˜¯å¦å®Œå–„ï¼Œè¿™å°±æ˜¯ç›®å‰çš„å”¯ä¸€é€‰æ‹©äº†ã€‚åœ¨æ–‡ç« ä¸­ä»‹ç»äº†éå¸¸å¤šçš„ç³»ç»Ÿæ–¹é¢çš„æ”¯æŒï¼Œå»ºè®®ç²¾è¯»ä¸€éï¼ŒåŒ…æ‹¬æ–‡ç« åé¢çš„è¯„è®ºã€‚<br>æ–‡ä¸­çš„ä¸¤ä¸ªé•œåƒï¼Œä¸€ä¸ªæ˜¯åŸå§‹é•œåƒï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ ota è¡¥ä¸åŒ…ï¼Œä¸¤ä¸ªå‡éœ€è¦å®‰è£…ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/konstakang-3.png" alt="image.png"></p>
<h1 id="ç”¨åˆ°çš„æ–‡ä»¶"><a href="#ç”¨åˆ°çš„æ–‡ä»¶" class="headerlink" title="ç”¨åˆ°çš„æ–‡ä»¶"></a>ç”¨åˆ°çš„æ–‡ä»¶</h1><p>ç”±äºåœ¨å›½å†…ä¸‹è½½éå¸¸ä¸ç¨³å®šï¼Œé€šå¸¸éœ€è¦é­”æ³•ä¸‹è½½ï¼Œæˆ‘å°†éœ€è¦ç”¨åˆ°çš„æ–‡ä»¶ä¸Šä¼ åˆ°äº‘ç›˜ä¾›ä¸‹è½½ä½¿ç”¨ã€‚æˆ‘å¯¹éƒ¨åˆ†è½¯ä»¶çš„ç”¨é€”ä¸€çŸ¥åŠè§£ï¼Œä½†æˆ‘çŸ¥é“å®‰è£…äº†åº”è¯¥æ²¡æœ‰åå¤„ï¼Œé€‰æ‹©å…¨éƒ¨å®‰è£…ã€‚</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pgGB_h2bUhq9iUXHrosW9w?pwd=rgad">lineage-20.0-20240112-UNOFFICIAL-KonstaKANG-rpi5-atv.zip</a> æå–ç ï¼šrgad</li>
<li><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/15RAKHM2q6pOGSt0a8jfJUg?pwd=3t4m">lineage-20.0-20240112-UNOFFICIAL-KonstaKANG-rpi5-atv-ota.zip</a> æå–ç : 3t4m</li>
<li><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1HWv0P22uAH2eavIycuaf1A?pwd=33wj">MindTheGapps-13.0.0-arm64-ATV-full-20240104_210039.zip</a> æå–ç ï¼š33wj</li>
<li><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1z0NcAlssVKPwav7RZTIUNg?pwd=c6ja">lineage-20.0-rpi-resize.zip</a> æå–ç ï¼šc6ja</li>
<li><a target="_blank" rel="noopener" href="https://androidfilehost.com/?fid=14871746926876846664#google_vignette">lineage-20.0-rpi-magisk-v25.2.zip</a></li>
<li><a target="_blank" rel="noopener" href="https://androidfilehost.com/?fid=11701882489785033173">lineage-20.0-rpi-widevine.zip</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/topjohnwu/Magisk/releases/tag/v25.2">Magisk-v25.2.apk</a></li>
<li><a target="_blank" rel="noopener" href="https://androidfilehost.com/?fid=11701882489785033172">lineage-20.0-rpi-gsfaid.zip</a></li>
</ul>
<h1 id="åˆ·-LineageOS-åˆ°æ ‘è“æ´¾"><a href="#åˆ·-LineageOS-åˆ°æ ‘è“æ´¾" class="headerlink" title="åˆ· LineageOS åˆ°æ ‘è“æ´¾"></a>åˆ· LineageOS åˆ°æ ‘è“æ´¾</h1><p>æ ‘è“æ´¾å®˜æ–¹æä¾›äº†é•œåƒçƒ§å½•å·¥å…· <a target="_blank" rel="noopener" href="https://www.raspberrypi.com/software/">Imager</a>ï¼Œæ”¯æŒ Windowsã€Ubuntuã€Macï¼Œåˆ·æœºéå¸¸æ–¹ä¾¿ã€‚<img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/imager.png" alt="image.png"><br>å°†æ ‘è“æ´¾çš„ SD æ’å…¥åˆ°ç”µè„‘ï¼Œåœ¨ <code>Raspberry Pi Device</code> ä¸­é€‰æ‹© <code>RASPBERRY PI 5</code>ï¼Œåœ¨<code>è¯·é€‰æ‹©éœ€è¦å†™å…¥çš„æ“ä½œç³»ç»Ÿ</code>ä¸­ä½¿ç”¨ <code>Use custom</code> é€‰é¡¹é€‰æ‹©å·²ç»ä¸‹è½½å¥½çš„æ–‡ä»¶ lineage-20.0-20240112-UNOFFICIAL-KonstaKANG-rpi5-atv.zipï¼Œé€‰æ‹©å¯¹åº”çš„ SD å¡ï¼Œå†ç‚¹å‡» <code>Next</code> å³å¯å¼€å§‹å°†é•œåƒå†™å…¥åˆ°SD å¡ä¸­ã€‚<br>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¯¹äºæ ‘è“æ´¾å…¶ä»–çš„ç³»ç»Ÿï¼Œéƒ½ä¸éœ€è¦äº‹å…ˆä¸‹è½½ï¼Œé€‰æ‹©ç³»ç»Ÿåï¼Œè¯¥å·¥å…·å¯ä»¥è‡ªåŠ¨ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜æ˜¯éå¸¸å€¼å¾—ğŸ‘ã€‚</p>
<h1 id="LineageOS-åˆæ­¥ä½“éªŒåŠåˆæ­¥è®¾ç½®"><a href="#LineageOS-åˆæ­¥ä½“éªŒåŠåˆæ­¥è®¾ç½®" class="headerlink" title="LineageOS åˆæ­¥ä½“éªŒåŠåˆæ­¥è®¾ç½®"></a>LineageOS åˆæ­¥ä½“éªŒåŠåˆæ­¥è®¾ç½®</h1><p>åœ¨å°†ç³»ç»Ÿåˆ·å…¥ SD å¡åï¼Œå³å¯å°† SD å¡æ”¾åˆ°æ ‘è“æ´¾ 5 ä¸­ï¼Œåœ¨æ ‘è“æ´¾ä¸­è¿æ¥å¥½é”®ç›˜å’Œé¼ æ ‡ã€‚<br>ä¸‹é¢æ­¥éª¤ä¸­å¯èƒ½ä¼šç”¨åˆ°é”®ç›˜çš„ä¸€äº›å¿«æ·é”®ï¼šF1 &#x3D; Home, F2 &#x3D; Back, F3 &#x3D; Multi-tasking, F4 &#x3D; Menu, F5 &#x3D; Power, F11 &#x3D; Volume down, and F12 &#x3D; Volume up<br>å¼€æœºåå³å¯çœ‹åˆ° LineageOS çš„å¼€æœºåŠ¨ç”»ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-1.png" alt="image.png"></p>
<p>æ¥ä¸‹æ¥å°±ä¼šçœ‹åˆ°æŸ¥æ‰¾è“ç‰™è®¾å¤‡çš„ç•Œé¢ï¼Œè¿™é‡Œå¯ä»¥é€‰æ‹©ç­‰å¾…ä¸€ä¼šåè‡ªåŠ¨è·³è¿‡ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-2.png" alt="image.png"></p>
<p>æ¥ä¸‹æ¥å°±æ¥åˆ°äº† Welcome çš„ç•Œé¢ï¼Œç‚¹å‡» <code>Start</code>ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-3.png" alt="image.png"></p>
<p>æ¥ä¸‹æ¥ä¼šè¿›å…¥åˆ°é€‰æ‹©è¯­è¨€ã€è¿æ¥ WIFI ç­‰æ“ä½œï¼Œå®Œæˆåå³å¯è¿›å…¥åˆ°æ“ä½œç³»ç»Ÿç•Œé¢ã€‚æ“ä½œç³»ç»Ÿç•Œé¢å¯è°“ç®€æ´åˆ°ä¸èƒ½å†ç²¾ç®€ï¼Œåªæœ‰ä¸€ä¸ªæ–‡ä»¶çš„åº”ç”¨ã€‚å·¦ä¸Šè§’çš„è¯­éŸ³å’Œæœç´¢åŠŸèƒ½å‡ä¸èƒ½ä½¿ç”¨ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-4.png" alt="image.png"></p>
<p>ä½†è®¾ç½®åŠŸèƒ½ä½œä¸º Android ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œè¿™éƒ¨åˆ†åŠŸèƒ½ä¸€ç‚¹éƒ½ä¸ä¼šå°‘ã€‚åœ¨è®¾ç½®ä¸­è¿æ¥  Wifi åå‘ç°ä¼šæŒç»­æ–­å¼€ï¼Œä¸çŸ¥é“æ˜¯å¦ä¸ºç³»ç»Ÿçš„é—®é¢˜ã€‚</p>
<p>æ‰“å¼€ Recovery æ¨¡å¼ï¼šè®¾ç½® -&gt; ç³»ç»Ÿ -&gt; Buttonsï¼Œæ‰“å¼€å³ä¾§çš„ Advanced restartã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-5.png" alt="image.png"></p>
<p>æ‰“å¼€å¼€å‘è€…æ¨¡å¼ï¼šè®¾ç½® -&gt; ç³»ç»Ÿ -&gt; å…³äº -&gt; Android TV æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œè¿ç»­ç‚¹å‡»é”®ç›˜çš„å›è½¦é”®ï¼Œä¼šæç¤ºå¼€å‘è€…æ¨¡å¼å·²æ‰“å¼€ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-6.png" alt="image.png"></p>
<p>æ‰“å¼€ Rooted debugï¼šè®¾ç½® -&gt; ç³»ç»Ÿ -&gt; å¼€å‘è€…é€‰é¡¹ -&gt; æ‰“å¼€ <code>USB è°ƒè¯•</code>ã€<code>Rooted debugging</code>ã€<code>ADB over network</code> ä¸‰ä¸ªé€‰é¡¹ã€‚</p>
<p>æ‰“å¼€æ ‘è“æ´¾çš„ SSH æœåŠ¡ï¼šè®¾ç½® -&gt; ç³»ç»Ÿ -&gt; Raspberry Pi Settings ä¸­å°† SSH æœåŠ¡æ‰“å¼€ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-7.png" alt="image.png"></p>
<h1 id="åˆ·å…¥-ota-åŒ…"><a href="#åˆ·å…¥-ota-åŒ…" class="headerlink" title="åˆ·å…¥ ota åŒ…"></a>åˆ·å…¥ ota åŒ…</h1><p>æ¥ä¸‹æ¥é€‰æ‹©åˆ·å…¥ OTA åŒ… <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/15RAKHM2q6pOGSt0a8jfJUg?pwd=3t4m">lineage-20.0-20240112-UNOFFICIAL-KonstaKANG-rpi5-atv-ota.zip</a>ï¼Œota åŒ…ä¸ä¼šç”¨åˆ°æ ‘è“æ´¾é•œåƒçƒ§å½•å™¨ï¼Œè€Œæ˜¯è¦é€šè¿‡Android Recovery æ¨¡å¼åˆ·å…¥ã€‚éœ€è¦äº‹å…ˆå‡†å¤‡å¥½ OTA åŒ…ï¼Œå¹¶å°†å…¶å¤åˆ¶åˆ° U ç›˜ä¸­ï¼Œå¹¶å°† U ç›˜æ’å…¥åˆ°æ ‘è“æ´¾ä¸­ã€‚</p>
<p>åœ¨ Android ç³»ç»Ÿè®¾ç½® -&gt; ç³»ç»Ÿ -&gt; é‡æ–°å¯åŠ¨ä¸­é€‰æ‹© Recoveryï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šé‡å¯è¿›å…¥åˆ° Recovery æ¨¡å¼ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/ota-1.png" alt="image.png"></p>
<p>ç‚¹å‡» <code>Install</code>ï¼Œå¹¶é€‰æ‹©å³ä¸‹è§’çš„ <code>Select Storage</code> æŒ‰é’®ï¼Œé€‰æ‹© USB å­˜å‚¨ï¼Œå³åˆšæ’å…¥çš„ U ç›˜ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/ota-2.png" alt="image.png"></p>
<p>åœ¨ U ç›˜ä¸­é€‰æ‹©è¦åˆ·å…¥çš„ ota è¡¥ä¸ï¼Œå–æ¶ˆ <code>Zip signature verification</code>ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/ota-3.png" alt="image.png"></p>
<p>åœ¨ <code>Swipe to confirm Flash</code>å¤„å‘å³æ»‘åŠ¨é¼ æ ‡ï¼Œå³å¯è¿›å…¥åˆ°å®‰è£… ota è¡¥ä¸çš„ç•Œé¢ã€‚ota è¡¥ä¸å®‰è£…å®Œæˆåï¼Œå³å¯è‡ªåŠ¨é‡å¯è¿›å…¥åˆ° Android TV ç³»ç»Ÿä¸­ã€‚é‡æ–°è¿›å…¥ç³»ç»Ÿåï¼Œå‘ç°ç³»ç»Ÿçš„ç•Œé¢æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œä¸çŸ¥é“è¯¥ ota è¡¥ä¸çš„å…·ä½“å½±å“åŠŸèƒ½ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/ota-4.png" alt="image.png"></p>
<h1 id="ç³»ç»Ÿå­˜å‚¨ç©ºé—´è®¾ç½®"><a href="#ç³»ç»Ÿå­˜å‚¨ç©ºé—´è®¾ç½®" class="headerlink" title="ç³»ç»Ÿå­˜å‚¨ç©ºé—´è®¾ç½®"></a>ç³»ç»Ÿå­˜å‚¨ç©ºé—´è®¾ç½®</h1><p>åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œæ‰“å¼€è®¾ç½® -&gt; å­˜å‚¨ç©ºé—´ï¼Œå¯ä»¥çœ‹åˆ°å†…éƒ¨å…±äº«å­˜å‚¨ç©ºé—´ä»…ä¸º 4.7 GBï¼Œè¿™é‡Œçš„å­˜å‚¨ç©ºé—´ä¸º &#x2F;data ç›®å½•æŒ‚è½½çš„è®¾å¤‡ï¼Œå¹¶æ²¡æœ‰å°† U ç›˜çš„ç©ºé—´å…¨éƒ¨ä½¿ç”¨èµ·æ¥ï¼ŒU ç›˜å‰©ä½™çš„ç£ç›˜ç©ºé—´å¤„äºæœªåˆ†é…çŠ¶æ€ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-8.png" alt="image.png"></p>
<p>è¿™é‡Œä½¿ç”¨ <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1z0NcAlssVKPwav7RZTIUNg?pwd=c6ja">lineage-20.0-rpi-resize.zip</a> å·¥å…·æ¥ä¿®æ”¹å­˜å‚¨ç©ºé—´ï¼ŒæŒ‰ç…§åˆ·å…¥ ota åŒ…ç›¸åŒçš„æ–¹å¼ï¼Œè¿›å…¥ Recovery æ¨¡å¼ä¸‹åˆ·å…¥è¯¥åŒ…ï¼Œé‡æ–°è¿›å…¥ç³»ç»Ÿåå³å‘ç°å­˜å‚¨ç©ºé—´å·²ç»å˜å¤§ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-9.png" alt="image.png"></p>
<h1 id="å®‰è£…-adb-å·¥å…·"><a href="#å®‰è£…-adb-å·¥å…·" class="headerlink" title="å®‰è£… adb å·¥å…·"></a>å®‰è£… adb å·¥å…·</h1><p>å‰ç½®æ¡ä»¶ï¼šå¼€å‘è€…é€‰é¡¹ä¸­çš„ ADB over network å¿…é¡»ä¸ºå¼€å¯çŠ¶æ€ã€‚</p>
<p>adb å‘½ä»¤éœ€è¦å®‰è£…åˆ°ç”µè„‘ä¸Šï¼Œåœ¨ mac ä¸‹ä½¿ç”¨ <code>brew install android-platform-tools</code>å³å¯å®‰è£…å®Œæˆã€‚</p>
<p>åœ¨ android tv ä¸ŠæŸ¥çœ‹å½“å‰çš„ ip åœ°å€ï¼Œæˆ‘è¿™é‡Œä¸º 192.168.31.167ã€‚æ‰§è¡Œ <code>adb connect 192.168.31.167</code> åå³å¯è·å–åˆ° USB è°ƒè¯•ä¿¡æ¯ï¼Œå¹¶é€‰ä¸­<code>ä¸€å¾‹å…è®¸ä½¿ç”¨è¿™å°è®¡ç®—æœºè¿›è¡Œè°ƒè¯•å¤„</code>åç‚¹å‡»å…è®¸ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-10.png" alt="image.png"><br>æ­¤æ—¶åœ¨ç»ˆç«¯ä¸­å³å¯æ˜¾ç¤ºå‡ºè¿æ¥æˆåŠŸçš„ä¿¡æ¯ï¼š<code>already connected to 192.168.31.167:5555</code>ã€‚</p>
<p>åœ¨å®‰è£…å®Œ adb å·¥å…·åï¼Œå³å¯ä»¥é€šè¿‡ adb å‘½ä»¤æ¥è¿œç¨‹è®¿é—® Android TV ç³»ç»Ÿäº†ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><code>adb install</code> å¯ä»¥å®‰è£… apk åŒ…ã€‚</li>
<li><code>adb shell settings list global</code> å‘½ä»¤æ¥æŸ¥çœ‹ Android ç³»ç»Ÿçš„æ‰€æœ‰global é…ç½®ã€‚</li>
<li><code>adb logcat</code> æŸ¥çœ‹ android çš„æ—¥å¿—ã€‚</li>
</ul>
<h1 id="è¿œç¨‹-ssh-è¿æ¥"><a href="#è¿œç¨‹-ssh-è¿æ¥" class="headerlink" title="è¿œç¨‹ ssh è¿æ¥"></a>è¿œç¨‹ ssh è¿æ¥</h1><p>å‰ç½®æ¡ä»¶ï¼š</p>
<ol>
<li>ssh è¿æ¥éœ€è¦é¦–å…ˆåœ¨ <code>Raspberry Pi Settings</code> ä¸­çš„ <code>Remote access</code> ä¸­æ‰“å¼€ SSHã€‚</li>
<li><code>adb connect</code> å¯ä»¥è¿æ¥åˆ° Android TVã€‚</li>
</ol>
<p>åœ¨å¼€å¯ SSH æœåŠ¡åï¼Œssh è¿æ¥éœ€è¦ä½¿ç”¨å¯¹åº”çš„ç§é’¥ä¿¡æ¯ï¼Œè€Œç§é’¥ä¿¡æ¯éœ€è¦é€šè¿‡ adb å‘½ä»¤è·å–ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">adb connect 192.168.31.166</span><br><span class="line">adb root</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯æŸ¥çœ‹ /data/ssh ç›®å½•ä¸‹çš„ ssh ç§˜é’¥ä¿¡æ¯</span></span><br><span class="line">adb shell ls /data/ssh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°†ç§˜é’¥ä¿¡æ¯æ”¾åˆ°æœ¬åœ°</span></span><br><span class="line">adb pull /data/ssh/ssh_host_ed25519_key ~/.ssh/android_tv.key</span><br><span class="line">chmod 600 ~/.ssh/android_tv.key</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆåŠŸ ssh è¿æ¥</span></span><br><span class="line">ssh -i ~/.ssh/android_tv.key root@192.168.31.166</span><br></pre></td></tr></table></figure>


<h1 id="å®‰è£…-Google-Apps"><a href="#å®‰è£…-Google-Apps" class="headerlink" title="å®‰è£… Google Apps"></a>å®‰è£… Google Apps</h1><blockquote>
<p>æ³¨æ„ï¼šæ­¤å¤„è¦æ±‚ç½‘ç»œå…·å¤‡é­”æ³•ï¼Œå¯ä»¥è®¿é—® Google</p>
</blockquote>
<h2 id="åˆ·å…¥-Google-Apps-åŒ…"><a href="#åˆ·å…¥-Google-Apps-åŒ…" class="headerlink" title="åˆ·å…¥ Google Apps åŒ…"></a>åˆ·å…¥ Google Apps åŒ…</h2><p>Google Apps åŒ…ä¸ºå¿…é¡»ç”¨åˆ°çš„åŒ…ï¼Œé€šè¿‡ Recovery æ¨¡å¼åˆ·å…¥åŒ… <code>MindTheGapps-13.0.0-arm64-ATV-full-20240104_210039.zip</code>ã€‚åŒ…å®‰è£…å®Œæˆåï¼Œé‡æ–°è¿›å…¥ç³»ç»Ÿå‘ç°ç•Œé¢å‘ç”Ÿäº†å˜åŒ–ï¼Œå¤šå‡ºäº†åº”ç”¨ Google Play Storeï¼Œå·¦ä¸Šè§’çš„è¯­éŸ³å’Œæœç´¢åŠŸèƒ½è™½ç„¶ä¸å¯ä»¥ç”¨ï¼Œä½†æ˜¯ç‚¹å‡»åæç¤ºä¿¡æ¯å·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚</p>
<blockquote>
<p>åŸæ¥çš„æ–‡ä»¶åº”ç”¨åœ¨è¿™é‡Œæ¶ˆå¤±ä¸è§äº†ï¼Œå®é™…ä¸Šåœ¨æ‰€æœ‰åº”ç”¨ä¸­è¿˜å¯ä»¥æ‰¾åˆ°ã€‚</p>
</blockquote>
<p><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-11.png" alt="image.png"><br>åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨ Google è´¦å·ç™»å½• Google Play Storeï¼Œå³ä½¿åœ¨å¯ä»¥è®¿é—® Google çš„ç½‘ç»œä¸‹ï¼Œå‘ç°ä¹Ÿä¸€ç›´ä¼šå¤±è´¥ã€‚</p>
<h2 id="æŸ¥è¯¢å¹¶æ³¨å†Œ-Android-ID"><a href="#æŸ¥è¯¢å¹¶æ³¨å†Œ-Android-ID" class="headerlink" title="æŸ¥è¯¢å¹¶æ³¨å†Œ Android ID"></a>æŸ¥è¯¢å¹¶æ³¨å†Œ Android ID</h2><p>å› ä¸ºè¯¥ Android TV è®¾å¤‡å¹¶ä¸è¢«ä¿¡ä»»ï¼Œéœ€è¦å°† Android ID åœ¨ Android ç½‘ç«™æ³¨å†Œã€‚å¦‚æœä¸æ³¨å†Œï¼Œé‚£ä¹ˆ Google è´¦å·ç™»å½•ä¸æˆåŠŸã€‚<br>å°†æ ‘è“æ´¾çš„ SD å¡æ’å…¥åˆ°ç¬”è®°æœ¬ï¼ŒæŸ¥çœ‹ SD å¡ä¸­çš„æ–‡ä»¶ gsf-android_id.txtï¼Œè¯¥æ–‡ä»¶å¯¹åº”çš„å†…å®¹å³ä¸º Android IDã€‚<br>è¿˜æœ‰å¦å¤–ä¸€ç§åŠæ³•å¯ä»¥è·å–åˆ° Android IDï¼Œåœ¨ç¬”è®°æœ¬ä¸Šé€šè¿‡ adb å‘½ä»¤æŸ¥è¯¢åˆ°å½“å‰è®¾å¤‡çš„ Android IDã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">adb root</span><br><span class="line"># æ‰¾åˆ° google service çš„ sqlite3 æ•°æ®åº“æ–‡ä»¶</span><br><span class="line">adb shell &#x27;find /data -name &quot;gservices.db&quot;&#x27;</span><br><span class="line"></span><br><span class="line"># é€šè¿‡æ•°æ®åº“æŸ¥è¯¢åˆ° android id</span><br><span class="line"># å…¶ä¸­ sqlite3 å‘½ä»¤åçš„ä¸ºä¸Šé¢æ­¥éª¤æŸ¥è¯¢å‡ºçš„æ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœæŸ¥è¯¢å‡ºå¤šä¸ªï¼Œå¯ä»¥ä»»é€‰ä¸€ä¸ª</span><br><span class="line">adb shell &#x27;sqlite3 /data/data/com.google.android.gsf/databases/gservices.db &quot;select * from main where name = \&quot;android_id\&quot;;&quot;&#x27;</span><br></pre></td></tr></table></figure>

<p>å°†ä¸Šè¿° Android ID åœ¨ç½‘ç«™è¿›è¡Œæ³¨å†Œï¼Œç½‘å€ï¼š<a target="_blank" rel="noopener" href="https://www.google.com/android/uncertified/">https://www.google.com/android/uncertified/</a><br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-12.png" alt="image.png"></p>
<h2 id="ä½¿ç”¨-Google-è´¦å·ç™»å½•"><a href="#ä½¿ç”¨-Google-è´¦å·ç™»å½•" class="headerlink" title="ä½¿ç”¨ Google è´¦å·ç™»å½•"></a>ä½¿ç”¨ Google è´¦å·ç™»å½•</h2><p>é‡æ–°è¿›å…¥ Recovery æ¨¡å¼ï¼Œç‚¹å‡» Wipe -&gt; Factory resetï¼Œæ­¤æ—¶æœºå™¨ä¼šè¿›è¡Œé‡å¯ã€‚è¯¥æ“ä½œä¼šæ¸…ç©ºç³»ç»Ÿä¸­çš„ &#x2F;data&#x2F;media ä¸‹çš„å†…å®¹ã€‚(è¿˜ä¸å¤ªæ¸…æ¥šè¯¥æ­¥éª¤æ˜¯å¦ä¸ºå¿…é¡»æ“ä½œ)<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-13.png" alt="image.png"></p>
<p>æœºå™¨é‡æ–°åä¼šé‡æ–°è¿›å…¥ä¸€éç³»ç»Ÿçš„åˆå§‹åŒ–ï¼Œä½†ç°åœ¨çš„åˆå§‹åŒ–ç•Œé¢è·Ÿæœ€åˆçš„ LineageOS çš„åˆå§‹åŒ–æœ‰æ‰€ä¸åŒï¼Œè¿›å…¥åˆ°äº† GMS çš„å¼€æœºå¼•å¯¼ï¼Œè¯¥æ­¥éª¤ä¸­å¿…é¡»è¦ç™»å½•åˆ° Google è´¦å·ï¼Œè€Œä¸”æ— æ³•è·³è¿‡ã€‚å¦‚æœ Android ID æ²¡æœ‰æ³¨å†Œï¼Œæ­¤æ—¶ç™»å½• Google è´¦å·ä¸€ç›´ä¼šå¤±è´¥ï¼Œå¯¼è‡´æ— æ³•è¿›å…¥åˆ°ç³»ç»Ÿä¸­ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-14.png" alt="image.png"></p>
<p>ç™»å½•å®Œæˆååœ¨é¦–é¡µå¯ä»¥çœ‹åˆ°äº†æ›´å¤šçš„ä¸€äº›ä¿¡æ¯ï¼š<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-15.png" alt="image.png"></p>
<h1 id="é€šè¿‡-Recovery-åˆ·å…¥å…¶ä»–åŒ…"><a href="#é€šè¿‡-Recovery-åˆ·å…¥å…¶ä»–åŒ…" class="headerlink" title="é€šè¿‡ Recovery åˆ·å…¥å…¶ä»–åŒ…"></a>é€šè¿‡ Recovery åˆ·å…¥å…¶ä»–åŒ…</h1><p>widevine æ˜¯åœ¨ Android ç”Ÿæ€ä¸‹è·Ÿæ•°å­—ç‰ˆæƒç›¸å…³çš„åŒ…ï¼Œé€šè¿‡ Recovery æ¨¡å¼åˆ·å…¥åŒ… lineage-20.0-rpi-widevine.zipã€‚</p>
<p>é€šè¿‡ Recovery æ¨¡å¼åˆ·å…¥åŒ… lineage-20.0-rpi-magisk-v25.2.zipï¼Œè¿›å…¥åˆ° Android TV ç³»ç»Ÿåé€šè¿‡æ–‡ä»¶å·¥å…·å®‰è£…åŒ… Magisk-v25.2.apkã€‚</p>
<h1 id="è§£å†³ç½‘ç»œè¿æ¥å—é™"><a href="#è§£å†³ç½‘ç»œè¿æ¥å—é™" class="headerlink" title="è§£å†³ç½‘ç»œè¿æ¥å—é™"></a>è§£å†³ç½‘ç»œè¿æ¥å—é™</h1><p>å¦‚æœæœ¬åœ°çš„ç½‘ç»œæ— æ³•è®¿é—® Googleï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œç½‘ç»œä¼šæç¤º<code>ç½‘ç»œè¿æ¥å—é™</code>ï¼ŒåŸå› ä¸»è¦è¿˜æ˜¯è·Ÿè®¿é—®ä¸äº† Google çš„åŸŸåæœ‰å…³ï¼Œä»¥è‡³äº Android TV ç³»ç»Ÿä¸èƒ½è¯†åˆ«å‡ºå¯ä»¥è¿æ¥äº’è”ç½‘ã€‚<br><img src="https://kuring.oss-cn-beijing.aliyuncs.com/raspberry/lineage-16.png" alt="image.png"></p>
<p>ç½‘ç»œè¿æ¥å—é™çŠ¶æ€çš„ WIFIï¼Œç»æµ‹è¯•æœºå™¨é‡å¯åæ— æ³•è‡ªåŠ¨è¿æ¥ï¼Œéœ€è¦æ¯æ¬¡éƒ½æ‰‹å·¥è¿æ¥ WIFIã€‚</p>
<p>æ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤æ¥ç³»ç»Ÿè¿›è¡Œè®¾ç½®ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">adb connect <span class="number">192.168</span>.<span class="number">31.166</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®æ—¶é—´æœåŠ¡å™¨</span></span><br><span class="line">adb shell settings put global ntp_server ntp1.aliyun.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯¥å€¼é»˜è®¤ä¸º 0</span></span><br><span class="line">adb shell settings put global captive_portal_detection_enabled <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤æ²¡æœ‰è¿™ä¸¤ä¸ªå€¼</span></span><br><span class="line">adb shell settings put global captive_portal_https_url https://connect.rom.miui.com/generate_204</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®å®Œæˆåé‡å¯ç³»ç»Ÿï¼Œå³å¯çœ‹åˆ°ç½‘ç»œçš„è¿æ¥å—é™å·²ç»æ¶ˆé™¤ï¼Œå¹¶ä¸” WIFI å·²ç»å¯ä»¥è‡ªåŠ¨è¿æ¥äº†ã€‚</p>
<h1 id="å¸¸ç”¨-apk-è½¯ä»¶å®‰è£…"><a href="#å¸¸ç”¨-apk-è½¯ä»¶å®‰è£…" class="headerlink" title="å¸¸ç”¨ apk è½¯ä»¶å®‰è£…"></a>å¸¸ç”¨ apk è½¯ä»¶å®‰è£…</h1><p>æˆ‘è¿™é‡Œä½¿ç”¨äº† <a target="_blank" rel="noopener" href="https://kxsw.gitbook.io/tv/">https://kxsw.gitbook.io/tv/</a> ä¸­çš„æ–¹æ³•å®‰è£…äº† File Commands å’Œ Clash è½¯ä»¶ã€‚File Commands  å¯ä»¥ç”¨æ¥ç®¡ç†æœ¬åœ°çš„æ–‡ä»¶ï¼Œç”šè‡³å¯ä»¥æä¾› HTTP Serverï¼Œä¾›è¿œç¨‹æ¥ä¸‹è½½æˆ–è€…ä¸Šä¼ æ–‡ä»¶ã€‚<br>å›½å†…çš„å¸¸è§åº”ç”¨åœ¨ Google Play Store ä¸­å¹¶ä¸å­˜åœ¨ï¼Œè€Œä¸”é€šè¿‡ Google Play Store ç›´æ¥å®‰è£…åº”ç”¨å¾ˆå¯èƒ½ä¼šå¤±è´¥ï¼Œè·Ÿä½¿ç”¨çš„ç½‘ç»œæœ‰å¾ˆå¤§å…³ç³»ã€‚å›½å†…çš„åº”ç”¨æˆ‘ç›´æ¥ä½¿ç”¨äº†å½“è´å¸‚åœºæ¥å®‰è£…ç”µè§†åº”ç”¨å³å¯ã€‚</p>
<h1 id="å…¶ä»–é—®é¢˜"><a href="#å…¶ä»–é—®é¢˜" class="headerlink" title="å…¶ä»–é—®é¢˜"></a>å…¶ä»–é—®é¢˜</h1><h2 id="å¬ä¸åˆ°å£°éŸ³"><a href="#å¬ä¸åˆ°å£°éŸ³" class="headerlink" title="å¬ä¸åˆ°å£°éŸ³"></a>å¬ä¸åˆ°å£°éŸ³</h2><p>åœ¨æ’­æ”¾è§†é¢‘æ—¶å‘ç°å¬ä¸åˆ°å£°éŸ³ï¼ŒåŸå› æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨äº† hdmi0 æ¥å£æ¥è¾“å…¥å£°éŸ³ï¼Œé€šè¿‡ hdmi1 åªèƒ½è¾“å‡ºè§†é¢‘ä¿¡å·ï¼Œæ²¡æœ‰å£°éŸ³ã€‚å°† hdmi çº¿åˆ‡æ¢åˆ° hdmi0 å£åå¹¶é‡å¯ç³»ç»Ÿåï¼Œå£°éŸ³å³æ­£å¸¸ã€‚</p>
<h1 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h1><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ ‘è“æ´¾å·²ç»å…·å¤‡äº†å®Œæ•´çš„ Android TV ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œè€Œä¸”ä½¿ç”¨èµ·æ¥è¿˜æ¯”è¾ƒç¨³å®šï¼Œè¿™ä¸€ç‚¹è¶…å‡ºäº†æˆ‘çš„é¢„æœŸï¼Œæ¯•ç«Ÿæ ‘è“æ´¾ 5 æ¯”è¾ƒæ–°ï¼Œè¯¥ç³»ç»Ÿå‡ºæ¥çš„æ—¶é—´æ¯”è¾ƒçŸ­ã€‚<br>åé¢æˆ‘è®¡åˆ’ä½¿ç”¨æ–°çš„æ–‡ç« æ¥è®°å½•ä½¿ç”¨ä½“éªŒï¼Œä»¥åŠæ–°çš„æŠ˜è…¾ç»å†ï¼Œæ¯”å¦‚ï¼šå¦‚ä½•é€šè¿‡é¥æ§å™¨å®ç°æ­£å¸¸çš„å¼€å…³æœºã€‚<br>æ•¬è¯·æœŸå¾…ã€‚ã€‚ã€‚</p>
<h1 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013120422/article/details/132107317">https://blog.csdn.net/u013120422/article/details/132107317</a></li>
<li><a target="_blank" rel="noopener" href="https://konstakang.com/devices/rpi5/LineageOS20-ATV/">https://konstakang.com/devices/rpi5/LineageOS20-ATV/</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder"></span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  




<script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"kuring/kuring.github.io","repo_id":"MDEwOlJlcG9zaXRvcnkyODM4MzQ0NTk=","category":"Announcements","category_id":"DIC_kwDOEOr4W84CdeTU","mapping":"pathname","reactions_enabled":1,"emit_metadata":1,"theme":"light","lang":"zh-CN","crossorigin":"anonymous","input_position":"bottom","loading":"lazy"}</script>

<script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.page.comments) return;

  NexT.utils.loadComments('.giscus-container')
    .then(() => NexT.utils.getScript('https://giscus.app/client.js', {
      attributes: {
        async                   : true,
        crossOrigin             : 'anonymous',
        'data-repo'             : CONFIG.giscus.repo,
        'data-repo-id'          : CONFIG.giscus.repo_id,
        'data-category'         : CONFIG.giscus.category,
        'data-category-id'      : CONFIG.giscus.category_id,
        'data-mapping'          : CONFIG.giscus.mapping,
        'data-reactions-enabled': CONFIG.giscus.reactions_enabled,
        'data-emit-metadata'    : CONFIG.giscus.emit_metadata,
        'data-theme'            : CONFIG.giscus.theme,
        'data-lang'             : CONFIG.giscus.lang,
        'data-input-position'   : CONFIG.giscus.input_position,
        'data-loading'          : CONFIG.giscus.loading
      },
      parentNode: document.querySelector('.giscus-container')
    }));
});
</script>

</body>
</html>
